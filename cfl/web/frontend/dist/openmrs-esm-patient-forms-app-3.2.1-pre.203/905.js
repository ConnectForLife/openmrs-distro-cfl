"use strict";(self.webpackChunk_openmrs_esm_patient_forms_app=self.webpackChunk_openmrs_esm_patient_forms_app||[]).push([[905],{5497:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(9601),a=n.n(r),o=n(2609),l=n.n(o)()(a());l.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-forms__offline-forms-styles__productiveHeading01___HW2wY{font-size:.875rem;font-weight:600;line-height:1.29;letter-spacing:.16px;margin-bottom:.5rem}.-esm-patient-forms__offline-forms-styles__productiveHeading03___CWOKE,.-esm-patient-forms__offline-forms-styles__pageHeaderContainer___IUuvp .-esm-patient-forms__offline-forms-styles__pageHeader___R94iz{font-size:1.25rem;font-weight:400;line-height:1.4;letter-spacing:0;margin-bottom:.5rem}.-esm-patient-forms__offline-forms-styles__productiveHeading04___tgV7v{font-size:1.75rem;font-weight:400;line-height:1.29;letter-spacing:0}.-esm-patient-forms__offline-forms-styles__bodyLong01___lKbvE{font-size:.875rem;font-weight:400;line-height:1.43;letter-spacing:.16px}.-esm-patient-forms__offline-forms-styles__bodyShort01___HZE4C{font-size:.875rem;font-weight:400;line-height:1.29;letter-spacing:.16px}.-esm-patient-forms__offline-forms-styles__label01___Rd3u7{font-size:.75rem;font-weight:400;line-height:1.34;letter-spacing:.32px}.-esm-patient-forms__offline-forms-styles__pageHeaderContainer___IUuvp{display:flex;justify-content:space-between;align-items:center;margin:0 1rem 1rem 1rem}.-esm-patient-forms__offline-forms-styles__pageHeaderContainer___IUuvp .-esm-patient-forms__offline-forms-styles__pageHeader___R94iz{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.-esm-patient-forms__offline-forms-styles__contentContainer___TEKTs{margin:0 1rem}.-esm-patient-forms__offline-forms-styles__tableContainer___tFdWe{background-color:rgba(0,0,0,0)}.-esm-patient-forms__offline-forms-styles__tableHeaderContainer___raVpJ{display:grid;grid-template-columns:1fr 50%}.-esm-patient-forms__offline-forms-styles__tableHeaderContainer___raVpJ .-esm-patient-forms__offline-forms-styles__tableSearch___wk53Z{grid-column:2;align-self:end}.omrs-breakpoint-gt-tablet .-esm-patient-forms__offline-forms-styles__tableHeaderContainer___raVpJ{grid-template-columns:1fr 250px}.omrs-breakpoint-gt-tablet .-esm-patient-forms__offline-forms-styles__tableHeaderContainer___raVpJ .-esm-patient-forms__offline-forms-styles__tableSearch___wk53Z{grid-column:3}.-esm-patient-forms__offline-forms-styles__availableOfflineToggle___oD4dD .bx--toggle__switch{margin-top:0 !important}.-esm-patient-forms__offline-forms-styles__availableOfflineToggleSkeleton___jhTe2{width:2rem;height:1rem}",""]),l.locals={productiveHeading01:"-esm-patient-forms__offline-forms-styles__productiveHeading01___HW2wY",productiveHeading03:"-esm-patient-forms__offline-forms-styles__productiveHeading03___CWOKE",pageHeaderContainer:"-esm-patient-forms__offline-forms-styles__pageHeaderContainer___IUuvp",pageHeader:"-esm-patient-forms__offline-forms-styles__pageHeader___R94iz",productiveHeading04:"-esm-patient-forms__offline-forms-styles__productiveHeading04___tgV7v",bodyLong01:"-esm-patient-forms__offline-forms-styles__bodyLong01___lKbvE",bodyShort01:"-esm-patient-forms__offline-forms-styles__bodyShort01___HZE4C",label01:"-esm-patient-forms__offline-forms-styles__label01___Rd3u7",contentContainer:"-esm-patient-forms__offline-forms-styles__contentContainer___TEKTs",tableContainer:"-esm-patient-forms__offline-forms-styles__tableContainer___tFdWe",tableHeaderContainer:"-esm-patient-forms__offline-forms-styles__tableHeaderContainer___raVpJ",tableSearch:"-esm-patient-forms__offline-forms-styles__tableSearch___wk53Z",availableOfflineToggle:"-esm-patient-forms__offline-forms-styles__availableOfflineToggle___oD4dD",availableOfflineToggleSkeleton:"-esm-patient-forms__offline-forms-styles__availableOfflineToggleSkeleton___jhTe2"};const i=l},4450:(e,t,n)=>{n.d(t,{MS:()=>_,cq:()=>m});var r=n(5047),a=n.n(r),o=n(3565),l=n.n(o),i=n(9857),s=n(3066),c=n(8179);function f(e,t,n,r,a,o,l){try{var i=e[o](l),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function l(e){f(o,r,a,l,i,"next",e)}function i(e){f(o,r,a,l,i,"throw",e)}l(void 0)}))}}function m(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=(0,s.useConfig)(),r=n.showConfigurableForms,o=n.customFormsUrl,l=n.showHtmlFormEntryForms,f=r?o.concat("?patientUuid=".concat(t)):l?c.lA:c.HW;return(0,i.ZP)([f,e],u(a().mark((function t(){var n,o,l,i,c,u;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,(0,s.openmrsFetch)(f);case 3:if(l=t.sent,c=r?null==l?void 0:l.data.results:null!==(i=null===(n=l.data)||void 0===n||null===(o=n.results)||void 0===o?void 0:o.filter((function(e){return e.published&&!/component/i.test(e.name)})))&&void 0!==i?i:[],e){t.next=8;break}return t.abrupt("return",c);case 8:return t.next=10,(0,s.getDynamicOfflineDataEntries)("form");case 10:return u=t.sent,t.abrupt("return",c.filter((function(e){return u.some((function(t){return t.identifier===e.uuid}))})));case 12:case"end":return t.stop()}}),t)}))))}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l()(new Date).startOf("day").subtract(500,"day").toDate(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l()(new Date).endOf("day").toDate(),r="/ws/rest/v1/encounter?v=".concat(c._V,"&patient=").concat(e,"&fromdate=").concat(t.toISOString(),"&todate=").concat(n.toISOString());return(0,i.ZP)(r,(function(e){return(0,s.openmrsFetch)(e)}))}function _(e,t,n){var r,a,o,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=m(l,e),s=d(e,t,n),c=null!==(o=null===(r=s.data)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.results)&&void 0!==o?o:[],f=i.data?g(i.data,c):void 0;return{data:f,error:i.error,isValidating:i.isValidating||s.isValidating,allForms:i.data}}function g(e,t){return e.map((function(e){var n=t.filter((function(t){var n;return(null===(n=t.form)||void 0===n?void 0:n.uuid)===(null==e?void 0:e.uuid)})).sort((function(e,t){return new Date(t.encounterDatetime).getTime()-new Date(e.encounterDatetime).getTime()})),r=n.length>0?new Date(null==n?void 0:n[0].encounterDatetime):void 0;return{form:e,associatedEncounters:n,lastCompleted:r}}))}},5186:(e,t,n)=>{n.d(t,{LD:()=>o,nY:()=>i});var r=n(9857),a=n(3066);function o(e,t){var n=t.some((function(t){return t.formUuid===e.uuid})),r=e.resources.some(l);return!n&&r}function l(e){return"AmpathJsonSchema"===e.dataType||"JSON schema"===e.name}function i(){return(0,r.ZP)("dynamicFormEntries",(function(){return(0,a.getDynamicOfflineDataEntries)("form")}))}},6905:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ye});var r=n(5047),a=n.n(r),o=n(3066),l=n(7896),i=n(6666),s=n(2159),c=n(9902),f=n.n(c),u=n(3980),m=n.n(u),d=n(2779),_=n.n(d),g=n(330),p=["className"],b=function(e){var t,n=e.className,r=(0,s.Z)(e,p),a=(0,g.A)(),o=_()((t={},(0,i.Z)(t,"".concat(a,"--skeleton__placeholder"),!0),(0,i.Z)(t,n,n),t));return f().createElement("div",(0,l.Z)({className:o},r))};b.propTypes={className:m().string};const v=b;var h=n(2867),y=["className","defaultToggled","disabled","hideLabel","id","labelA","labelB","labelText","onClick","onToggle","size","toggled"];function O(e){var t=e.className,n=e.defaultToggled,r=void 0!==n&&n,a=e.disabled,o=void 0!==a&&a,u=e.hideLabel,m=void 0!==u&&u,d=e.id,p=e.labelA,b=void 0===p?"Off":p,v=e.labelB,O=void 0===v?"On":v,w=e.labelText,Z=e.onClick,E=e.onToggle,T=e.size,C=void 0===T?"md":T,k=e.toggled,x=(0,s.Z)(e,y),S=(0,g.A)(),N=function(e){var t=e.defaultValue,n=e.name,r=void 0===n?"custom":n,a=e.onChange,o=e.value,l=(0,c.useState)(null!=o?o:t),i=(0,h.Z)(l,2),s=i[0],f=i[1],u=(0,c.useRef)(null);function m(e){var t="function"==typeof e?e(s):e;!1===u.current&&f(t),a&&a(t)}return null===u.current&&(u.current=void 0!==o),(0,c.useEffect)((function(){u.current,u.current}),[r,o]),!0===u.current?[o,m]:[s,m]}({value:k,onChange:E,defaultValue:r}),P=(0,h.Z)(N,2),H=P[0],D=P[1],j="sm"===C,F=m?w:H?O:b,A=_()("".concat(S,"--toggle"),(0,i.Z)({},"".concat(S,"--toggle--disabled"),o),t),z=_()("".concat(S,"--toggle__label-text"),(0,i.Z)({},"".concat(S,"--visually-hidden"),m)),R=_()("".concat(S,"--toggle__appearance"),(0,i.Z)({},"".concat(S,"--toggle__appearance--sm"),j)),V=_()("".concat(S,"--toggle__switch"),(0,i.Z)({},"".concat(S,"--toggle__switch--checked"),H));return f().createElement("div",{className:A},f().createElement("button",(0,l.Z)({},x,{id:d,className:"".concat(S,"--toggle__button"),role:"switch",type:"button","aria-checked":H,disabled:o,onClick:function(e){D(!H),Z&&Z(e)}})),f().createElement("label",{htmlFor:d,className:"".concat(S,"--toggle__label")},f().createElement("span",{className:z},w),f().createElement("div",{className:R},f().createElement("div",{className:V},j&&f().createElement("svg",{className:"".concat(S,"--toggle__check"),width:"6px",height:"5px",viewBox:"0 0 6 5"},f().createElement("path",{d:"M2.2 2.7L5 0 6 1 2.2 5 0 2.7 1 1.5z"}))),f().createElement("span",{className:"".concat(S,"--toggle__text"),"aria-hidden":"true"},F))))}O.propTypes={className:m().string,defaultToggled:m().bool,disabled:m().bool,hideLabel:m().bool,id:m().string.isRequired,labelA:m().node,labelB:m().node,labelText:m().node.isRequired,onClick:m().func,onToggle:m().func,size:m().oneOf(["sm","md"]),toggled:m().bool};const w=O;var Z,E,T=n(9249),C=n(7371),k=n(8106),x=n(1987),S=n(5058),N=n(3182),P=n(4509),H=n(4817),D=["className","defaultToggled","toggled","onChange","onToggle","id","labelText","labelA","labelB","size"];var j=(0,N.Z)(),F=function(e){(0,k.Z)(a,e);var t,n,r=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,S.Z)(t);if(n){var a=(0,S.Z)(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return(0,x.Z)(this,e)});function a(){return(0,T.Z)(this,a),r.apply(this,arguments)}return(0,C.Z)(a,[{key:"render",value:function(){var e,t=this.context,n=this.props,r=n.className,a=n.defaultToggled,o=n.toggled,c=n.onChange,u=n.onToggle,m=n.id,d=void 0===m?this.inputId=this.inputId||"__carbon-toggle_".concat(j()):m,g=n.labelText,p=n.labelA,b=n.labelB,v=n.size,h=(0,s.Z)(n,D),y=_()("".concat(t,"--form-item"),(0,i.Z)({},r,r)),O=_()("".concat(t,"--toggle-input"),(0,i.Z)({},"".concat(t,"--toggle-input--small"),"sm"===v)),w={};return void 0!==o?w.checked=o:w.defaultChecked=a,f().createElement("div",{className:y},f().createElement("input",(0,l.Z)({},h,w,{"aria-label":null,type:"checkbox",id:d,className:O,onChange:function(t){c&&c(t),u(e.checked,d,t)},ref:function(t){e=t},onKeyUp:function(t){(0,P.EQ)(t,H.Ce)&&(e.checked=!e.checked,c&&c(t),u(e.checked,d,t))}})),f().createElement("label",{className:"".concat(t,"--toggle-input__label"),htmlFor:d,"aria-label":"string"==typeof g?null:this.props["aria-label"]},g,f().createElement("span",{className:"".concat(t,"--toggle__switch")},v&&f().createElement("svg",{className:"".concat(t,"--toggle__check"),width:"6px",height:"5px",viewBox:"0 0 6 5"},f().createElement("path",{d:"M2.2 2.7L5 0 6 1 2.2 5 0 2.7 1 1.5z"})),f().createElement("span",{className:"".concat(t,"--toggle__text--off"),"aria-hidden":"true"},p),f().createElement("span",{className:"".concat(t,"--toggle__text--on"),"aria-hidden":"true"},b))))}}]),a}(f().Component);(0,i.Z)(F,"propTypes",(Z={},(0,i.Z)(Z,"aria-label",m().string.isRequired),(0,i.Z)(Z,"className",m().string),(0,i.Z)(Z,"defaultToggled",m().bool),(0,i.Z)(Z,"id",m().string.isRequired),(0,i.Z)(Z,"labelA",m().node.isRequired),(0,i.Z)(Z,"labelB",m().node.isRequired),(0,i.Z)(Z,"labelText",m().node),(0,i.Z)(Z,"onChange",m().func),(0,i.Z)(Z,"onToggle",m().func),(0,i.Z)(Z,"size",m().oneOf(["sm","md"])),(0,i.Z)(Z,"toggled",m().bool),Z)),(0,i.Z)(F,"contextType",g.T),(0,i.Z)(F,"defaultProps",(E={defaultToggled:!1},(0,i.Z)(E,"aria-label","Toggle"),(0,i.Z)(E,"labelA","Off"),(0,i.Z)(E,"labelB","On"),(0,i.Z)(E,"onToggle",(function(){})),E));const A=F;var z=n(309);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const I=function(e){var t=e.name,n=e.flag,r=void 0===n?"enable-v11-release":n,a=e.next,o=e.classic;function l(e,t){return(0,z.ye)(r)?a?f().createElement(a,V(V({},e),{},{ref:t})):null:f().createElement(o,V(V({},e),{},{ref:t}))}var i=f().forwardRef(l);return i.displayName="FeatureToggle(".concat(t,")"),i}({name:"Toggle",next:w,classic:A});var B=n(9930),L=n(160),U=n(4750),q=n(364),J=n(7500),K=n(8804),W=n(1358),M=n(2427),Y=n(3783),Q=n(4924),$=n(321),G=n.n($),X=n(1195),ee=n.n(X),te=n(3275),ne=n.n(te),re=n(7162),ae=n.n(re),oe=n(2094),le=n.n(oe),ie=n(757),se=n.n(ie),ce=n(5497),fe={};fe.styleTagTransform=se(),fe.setAttributes=ae(),fe.insert=ne().bind(null,"head"),fe.domAPI=ee(),fe.insertStyleElement=le(),G()(ce.Z,fe);const ue=ce.Z&&ce.Z.locals?ce.Z.locals:void 0;var me=n(4450),de=n(5186);function _e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ge(){var e,t,n,r=(0,me.cq)(),a=(0,o.useConfig)();return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){_e(e,t,n[t])}))}return e}({},r),n=null!=(n={data:null===(e=r.data)||void 0===e?void 0:e.filter((function(e){return(0,de.LD)(e,a.htmlFormEntryForms)}))})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function be(e,t,n,r,a,o,l){try{var i=e[o](l),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}function ve(){return ve=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ve.apply(this,arguments)}function he(e){var t,n,r,l,i,s=e.form,u=e.disabled,m=(l=(0,c.useState)(!1),i=2,function(e){if(Array.isArray(e))return e}(l)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],l=!0,i=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);l=!0);}catch(e){i=!0,a=e}finally{try{l||null==n.return||n.return()}finally{if(i)throw a}}return o}}(l,i)||function(e,t){if(e){if("string"==typeof e)return pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pe(e,t):void 0}}(l,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=m[0],_=m[1],g=(0,de.nY)(),p=null===(t=g.data)||void 0===t?void 0:t.some((function(e){return e.identifier===s.uuid})),b=(n=a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_(!0),e.prev=1,!t){e.next=9;break}return e.next=5,(0,o.putDynamicOfflineData)("form",s.uuid);case 5:return e.next=7,(0,o.syncDynamicOfflineData)("form",s.uuid);case 7:e.next=11;break;case 9:return e.next=11,(0,o.removeDynamicOfflineData)("form",s.uuid);case 11:return e.prev=11,_(!1),g.mutate(),e.finish(11);case 15:case"end":return e.stop()}}),e,null,[[1,,11,15]])})),r=function(){var e=this,t=arguments;return new Promise((function(r,a){var o=n.apply(e,t);function l(e){be(o,r,a,l,i,"next",e)}function i(e){be(o,r,a,l,i,"throw",e)}l(void 0)}))},function(e){return r.apply(this,arguments)});return g.isValidating?f().createElement(v,{className:ue.availableOfflineToggleSkeleton}):f().createElement("div",null,f().createElement(I,{id:"".concat(s.uuid,"-offline-toggle"),className:ue.availableOfflineToggle,labelA:"",labelB:"",size:"sm",toggled:p,disabled:u||d||g.isValidating,onToggle:b}))}const ye=function(e){var t,n,r,a=e.canMarkFormsAsOffline,l=(0,Q.useTranslation)().t,i=ge(),s="desktop"===(0,o.useLayoutType)()?"sm":void 0,c=[{key:"formName",header:l("offlineFormsTableFormNameHeader","Form name")},{key:"availableOffline",header:l("offlineFormsTableFormAvailableOffline","Offline")}],u=null!==(n=null===(t=i.data)||void 0===t?void 0:t.map((function(e){return{id:e.uuid,formName:e.name,availableOffline:f().createElement(he,{form:e,disabled:!a})}})))&&void 0!==n?n:[];return f().createElement(f().Fragment,null,f().createElement("header",{className:ue.pageHeaderContainer},f().createElement("h1",{className:ue.pageHeader},l("offlineFormsTitle","Offline forms"))),f().createElement("main",{className:ue.contentContainer},f().createElement(B.ZP,{rows:u,headers:c},(function(e){var t=e.rows,n=e.headers,a=e.getTableProps,o=e.getHeaderProps,i=e.getRowProps,c=e.getTableContainerProps,u=e.onInputChange;return f().createElement(L.Z,ve({className:ue.tableContainer},c()),f().createElement("div",{className:ue.tableHeaderContainer},f().createElement(U.Z,{className:ue.tableSearch,labelText:l("offlinePatientsTableSearchLabel","Search this list"),placeholder:l("offlinePatientsTableSearchPlaceholder","Search this list"),size:s,onChange:u,light:!0})),f().createElement(q.Z,ve({},a(),{isSortable:!0,useZebraStyles:!0}),f().createElement(J.Z,null,f().createElement(K.Z,null,n.map((function(e){return f().createElement(W.Z,ve({},o({header:e}),{isSortable:!0}),e.header)})))),f().createElement(M.Z,null,t.map((function(e){return f().createElement(K.Z,ve({},i({row:e})),e.cells.map((function(e){var t;return f().createElement(Y.Z,{key:e.id},null!==(r=null===(t=e.value)||void 0===t?void 0:t.value)&&void 0!==r?r:e.value)})))})))))}))))}}}]);