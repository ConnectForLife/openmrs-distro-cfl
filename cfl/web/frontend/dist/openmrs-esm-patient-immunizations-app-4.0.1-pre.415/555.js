"use strict";(self.webpackChunk_openmrs_esm_patient_immunizations_app=self.webpackChunk_openmrs_esm_patient_immunizations_app||[]).push([[555],{237:(e,n,t)=>{t.d(n,{Z:()=>c});var i=t(9601),r=t.n(i),a=t(2609),o=t.n(a)()(r());o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-immunizations__immunizations-detailed-summary__widgetCard___THJK4{border:1px solid #e0e0e0}",""]),o.locals={widgetCard:"-esm-patient-immunizations__immunizations-detailed-summary__widgetCard___THJK4"};const c=o},1756:(e,n,t)=>{t.d(n,{V:()=>m,j:()=>p});var i=t(906),r=t(2449),a=t(772),o=t(468),c=t(4402),u=t(3012),s=t(3939),l=function(e){var n,t,r=null==e?void 0:e.resource,a=null==r?void 0:r.id,o=null==r||null===(n=r.manufacturer)||void 0===n?void 0:n.display,c=null==r?void 0:r.lotNumber,u=(null==r||null===(t=r.protocolApplied)||void 0===t?void 0:t.length)>0&&(null==r?void 0:r.protocolApplied[0]);return{immunizationObsUuid:a,manufacturer:o,lotNumber:c,sequenceLabel:null==u?void 0:u.series,sequenceNumber:null==u?void 0:u.doseNumberPositiveInt,occurrenceDateTime:(0,i.formatDate)(new Date(null==r?void 0:r.occurrenceDateTime)),expirationDate:(0,i.formatDate)(new Date(null==r?void 0:r.expirationDate))}},d=function(e){var n;return(0,r.Z)(null==e||null===(n=e.vaccineCode)||void 0===n?void 0:n.coding,(function(e){return(0,c.Z)(e.system)}))},m=function(e){var n=(0,o.Z)(e.entry,(function(e){var n;return null===(n=d(e.resource))||void 0===n?void 0:n.code}));return(0,u.Z)(n,(function(e){var n,t=(0,u.Z)(e,l),i=d(null===(n=e[0])||void 0===n?void 0:n.resource);return{vaccineName:null==i?void 0:i.display,vaccineUuid:null==i?void 0:i.code,existingDoses:(0,s.Z)(t,[function(e){return(0,a.Z)(e,"occurrenceDateTime")}],["desc"])}}))};function v(e,n){return{type:e,reference:"".concat(e,"/").concat(n)}}var p=function(e,n,t,r){return{resourceType:"Immunization",status:"completed",id:e.immunizationObsUuid,vaccineCode:{coding:[{code:e.vaccineUuid,display:e.vaccineName}]},patient:v("Patient",e.patientUuid),encounter:v("Encounter",n),occurrenceDateTime:(0,i.parseDate)(e.vaccinationDate),expirationDate:(0,i.parseDate)(e.expirationDate),location:v("Location",t),performer:[{actor:v("Practitioner",r)}],manufacturer:{display:e.manufacturer},lotNumber:e.lotNumber,protocolApplied:[{doseNumberPositiveInt:e.currentDose.sequenceNumber,series:e.currentDose.sequenceLabel}]}}},2458:(e,n,t)=>{t.d(n,{s:()=>i});var i=new(t(2444).BehaviorSubject)(null)},555:(e,n,t)=>{t.r(n),t.d(n,{default:()=>H});var i=t(268),r=t.n(i),a=t(772);const o=function(e){return e&&e.length?e[0]:void 0};var c=t(739),u=t(7210),s=t(4248),l=t(7885),d=t(3282),m=t(4975),v=t(5441),p=t(130),f=Object.prototype.hasOwnProperty;const g=function(e){if(null==e)return!0;if((0,d.Z)(e)&&((0,l.Z)(e)||"string"==typeof e||"function"==typeof e.splice||(0,m.Z)(e)||(0,p.Z)(e)||(0,s.Z)(e)))return!e.length;var n=(0,u.Z)(e);if("[object Map]"==n||"[object Set]"==n)return!e.size;if((0,v.Z)(e))return!(0,c.Z)(e).length;for(var t in e)if(f.call(e,t))return!1;return!0};var b=t(3939),y=t(4924),D=t(4732),h=t(6759),Z=t(6217),w=t(906),T=t(8108),_=t(3012),z=t(2449),x=function(e,n){return new Date(n.occurrenceDateTime).getTime()-new Date(e.occurrenceDateTime).getTime()},C=t(2458),S=t(6062),N=t.n(S),U=t(4036),q=t.n(U),P=t(6793),k=t.n(P),A=t(7892),E=t.n(A),O=t(1173),j=t.n(O),I=t(2464),L=t.n(I),V=t(237),F={};F.styleTagTransform=L(),F.setAttributes=E(),F.insert=k().bind(null,"head"),F.domAPI=q(),F.insertStyleElement=j(),N()(V.Z,F);const M=V.Z&&V.Z.locals?V.Z.locals:void 0;function B(){return B=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},B.apply(this,arguments)}const H=function(e){var n,t,c,u,s,l=e.patientUuid,d=(e.basePath,(0,y.useTranslation)()),m=d.t,v=d.i18n,p=(0,w.useConfig)().immunizationsConfig,f=null==p?void 0:p.sequenceDefinitions,S=m("immunizations","immunizations"),N=m("immunizations","Immunizations"),U=v.language.replace("_","-"),q=(window.spaBase,m("goToSummary","Go to Summary"),(0,T.iX)().data),P=(0,T.dv)(l),k=P.data,A=P.isError,E=P.isLoading,O=P.isValidating,j=(n=f,c=null==(t=q)?void 0:t.setMembers,u=(0,_.Z)(c,(function(e){var t={vaccineName:e.display,vaccineUuid:e.uuid,existingDoses:[]},i=(0,z.Z)(n,(function(n){return n.vaccineConceptUuid===e.uuid}));return t.sequences=null==i?void 0:i.sequences,t})),s=k||[],(0,_.Z)(u,(function(e){var n=(0,z.Z)(s,(function(n){return n.vaccineUuid===e.vaccineUuid}));return n&&(e.existingDoses=n.existingDoses),e}))),I=(0,b.Z)(j,[function(e){return(0,a.Z)(e,"existingDoses.length",0)}],["desc"]),L=r().useCallback((function(){return(0,Z.launchPatientWorkspace)("immunization-form-workspace")}),[]),V=((0,i.useMemo)((function(){return[{key:"vaccine",header:m("vaccine","Vaccine")},{key:"recentVaccination",header:m("recentVaccination","Recent Vaccination")},{key:"add",header:""}]}),[m]),(0,i.useMemo)((function(){return null==I?void 0:I.map((function(e){var n,t,i,a=g(e.sequences)&&!g(e.existingDoses)?"".concat(m("singleDoseOn","Single Dose on")," ").concat(new Date(null===(n=o(e.existingDoses.sort(x)))||void 0===n?void 0:n.occurrenceDateTime).toLocaleDateString(U,{dateStyle:"medium"})):g(e.existingDoses)?"":"".concat(null===(t=o(null==e?void 0:e.sequences))||void 0===t?void 0:t.sequenceLabel," on ").concat(new Date(null===(i=o(e.existingDoses.sort(x)))||void 0===i?void 0:i.occurrenceDateTime).toLocaleDateString(U,{dateStyle:"medium"})," ");return{id:e.vaccineUuid,vaccine:e.vaccineName,recentVaccination:a,add:r().createElement(D.zxk,{kind:"ghost",renderIcon:function(e){return r().createElement(h.mm,B({size:16},e))},iconDescription:"Add",onClick:function(){C.s.next({vaccineName:e.vaccineName,vaccineUuid:e.vaccineUuid,sequences:null==e?void 0:e.sequences,existingDoses:null==e?void 0:e.existingDoses,immunizationObsUuid:null==e?void 0:e.immunizationObsUuid,manufacturer:e.manufacturer,lotNumber:e.lotNumber,expirationDate:e.expirationDate,currentDose:{sequenceLabel:e.sequenceLabel,sequenceNumber:e.sequenceNumber},vaccinationDate:e.occurrenceDateTime,formChanged:e.formChanged}),L()}})}}))}),[I,m,U,L])),F=(0,w.usePagination)(V,10),H=F.results;return F.currentPage,F.goTo,E||!I?r().createElement(D.gqd,{role:"progressbar"}):A?r().createElement(Z.ErrorState,{error:A,headerTitle:N}):((null==I?void 0:I.length)&&(M.widgetCard,Z.CardHeader,O&&D.lSo,D.zxk,m("add","Add"),D.wQF,Z.PatientChartPagination,null==V||V.length,null==H||H.length),r().createElement(Z.EmptyState,{displayText:S,headerTitle:N,launchForm:L}))}},8108:(e,n,t)=>{t.d(n,{dv:()=>s,eu:()=>l,iX:()=>u}),t(5047);var i=t(9857),r=t(906),a=t(9867),o=t(1756);function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function u(){var e,n,t,o=(0,r.useConfig)().immunizationsConfig,u=null==o?void 0:o.vaccinesConceptSet,s=(n=u.split(":"),t=2,function(e){if(Array.isArray(e))return e}(n)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var i,r,a=[],o=!0,c=!1;try{for(t=t.call(e);!(o=(i=t.next()).done)&&(a.push(i.value),!n||a.length!==n);o=!0);}catch(e){c=!0,r=e}finally{try{o||null==t.return||t.return()}finally{if(c)throw r}}return a}}(n,t)||function(e,n){if(e){if("string"==typeof e)return c(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,n):void 0}}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=s[0],d=s[1],m="/ws/rest/v1/concept?source=".concat(l,"&code=").concat(d,"&v=full"),v="/ws/rest/v1/concept/".concat(u,"?v=full"),p=(0,i.ZP)((e=u,(0,a.Z)(e,":")?m:v),r.openmrsFetch),f=p.data,g=p.error;return{data:f?f.data.results[0]:null,isError:g,isLoading:!f&&!g}}function s(e){var n="".concat(r.fhirBaseUrl,"/Immunization?patient=").concat(e),t=(0,i.ZP)(n,r.openmrsFetch),a=t.data,c=t.error,u=t.isValidating,s=a?(0,o.V)(a.data):null;return{data:a?s:null,isError:c,isLoading:!a&&!c,isValidating:u}}function l(e,n,t,i){var a="".concat(r.fhirBaseUrl,"/Immunization");return t&&(a="".concat(a,"/").concat(t)),(0,r.openmrsFetch)(a,{headers:{"Content-Type":"application/json"},method:"POST",body:e,signal:i.signal})}}}]);