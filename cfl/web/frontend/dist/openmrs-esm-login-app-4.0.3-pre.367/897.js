"use strict";(self.webpackChunk_openmrs_esm_login_app=self.webpackChunk_openmrs_esm_login_app||[]).push([[897],{5048:(e,n,t)=>{t.d(n,{Z:()=>r});var o=t(361),i=t.n(o)()((function(e){return e[1]}));i.push([e.id,".-esm-login__loading__centerLoadingSVG___mTF5v{display:flex;width:100vw;height:100vh;justify-content:center;align-items:center}",""]),i.locals={centerLoadingSVG:"-esm-login__loading__centerLoadingSVG___mTF5v"};const r=i},6523:(e,n,t)=>{t.d(n,{Z:()=>r});var o=t(361),i=t.n(o)()((function(e){return e[1]}));i.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-login__login__productiveHeading01___rNht9{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px)}.-esm-login__login__productiveHeading03___cBnfT{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-login__login__bodyShort01___nlwDv,.-esm-login__login__need-help-txt___ZXwZW{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-login__login__bodyShort02___1MMZn{font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0)}.-esm-login__login__bodyLong01___jezJv{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}.-esm-login__login__label01___Ojuxp,.-esm-login__login__input-group___OvEYl .cds--text-input{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px)}.-esm-login__login__caption01___aOjUn,.-esm-login__login__powered-by-txt___cp7mp{font-size:var(--cds-legal-01-font-size, 0.75rem);font-weight:var(--cds-legal-01-font-weight, 400);line-height:var(--cds-legal-01-line-height, 1.33333);letter-spacing:var(--cds-legal-01-letter-spacing, 0.32px)}.-esm-login__login__container___SmdkR{display:flex;flex-direction:column;justify-content:center;align-items:center}.-esm-login__login__center___\\+yhR\\+{text-align:center}.-esm-login__login__logo___9ZHJ\\+{margin-bottom:2.5rem;height:5rem;width:16rem}.-esm-login__login__logo-img___mKboF{margin-bottom:3rem;max-width:100%}.-esm-login__login__powered-by-txt___cp7mp{text-align:center;color:#525252;color:#525252}.-esm-login__login__need-help___v3A2r{display:flex;width:23rem}.-esm-login__login__need-help-txt___ZXwZW{text-align:left;color:#525252;display:flex;flex-direction:row;align-items:center}.-esm-login__login__powered-by-logo___Bq9f2{height:2.5rem;width:6.5rem}.-esm-login__login__login-card___eVRye{border-radius:0;border:1px solid #e0e0e0;background-color:#fff;width:23rem;padding:2.5rem;position:relative}@media only screen and (min-width: 481px){.-esm-login__login__container___SmdkR{height:100vh}}@media only screen and (max-width: 480px){.-esm-login__login__login-card___eVRye{margin-top:2.5%;border:none}.-esm-login__login__container___SmdkR{height:100vh}}.-esm-login__login__input-group___OvEYl{display:flex;justify-content:center;flex-direction:column;align-items:center;width:18rem}.-esm-login__login__input-group___OvEYl .cds--text-input{height:3rem}.-esm-login__login__input-group___OvEYl .cds--text-input__field-outer-wrapper{width:18rem}.-esm-login__login__continueButton___VnN\\+0{margin-top:1.5rem;width:18rem}.-esm-login__login__back-button-div___lHJlp{width:23rem;position:absolute;bottom:100%;left:0}.-esm-login__login__back-button___AO\\+qv{height:3rem;padding-left:0rem}.-esm-login__login__back-button___AO\\+qv svg{margin-right:.5rem;order:1}.-esm-login__login__back-button___AO\\+qv span{order:2}.-esm-login__login__footer___A7jlG{margin-top:6.75rem}",""]),i.locals={productiveHeading01:"-esm-login__login__productiveHeading01___rNht9",productiveHeading03:"-esm-login__login__productiveHeading03___cBnfT",bodyShort01:"-esm-login__login__bodyShort01___nlwDv","need-help-txt":"-esm-login__login__need-help-txt___ZXwZW",bodyShort02:"-esm-login__login__bodyShort02___1MMZn",bodyLong01:"-esm-login__login__bodyLong01___jezJv",label01:"-esm-login__login__label01___Ojuxp","input-group":"-esm-login__login__input-group___OvEYl",caption01:"-esm-login__login__caption01___aOjUn","powered-by-txt":"-esm-login__login__powered-by-txt___cp7mp",container:"-esm-login__login__container___SmdkR",center:"-esm-login__login__center___+yhR+",logo:"-esm-login__login__logo___9ZHJ+","logo-img":"-esm-login__login__logo-img___mKboF","need-help":"-esm-login__login__need-help___v3A2r","powered-by-logo":"-esm-login__login__powered-by-logo___Bq9f2","login-card":"-esm-login__login__login-card___eVRye",continueButton:"-esm-login__login__continueButton___VnN+0","back-button-div":"-esm-login__login__back-button-div___lHJlp","back-button":"-esm-login__login__back-button___AO+qv",footer:"-esm-login__login__footer___A7jlG"};const r=i},8897:(e,n,t)=>{t.r(n),t.d(n,{default:()=>G});var o=t(5776),i=t.n(o),r=t(1602),l=t.n(r),a=t(109),s=t(2137),c=t(611),_=t(2680),g=t(4610);function u(e,n){var t=window.btoa("".concat(e,":").concat(n));return(0,g.openmrsFetch)("/ws/rest/v1/session",{headers:{Authorization:"Basic ".concat(t)}}).then((function(e){return(0,g.refetchCurrentUser)(),e}))}var d=t(487),m=t.n(d),p=t(631),h=t.n(p),f=t(2052),v=t.n(f),b=t(4010),y=t.n(b),w=t(1469),E=t.n(w),x=t(9329),k=t.n(x),S=t(6523),L={};L.styleTagTransform=k(),L.setAttributes=y(),L.insert=v().bind(null,"head"),L.domAPI=h(),L.insertStyleElement=E(),m()(S.Z,L);const C=S.Z&&S.Z.locals?S.Z.locals:void 0;function z(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}function A(e,n,t,o,i,r,l){try{var a=e[r](l),s=a.value}catch(e){return void t(e)}a.done?n(s):Promise.resolve(s).then(o,i)}function N(){return N=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},N.apply(this,arguments)}function R(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,i,r=[],l=!0,a=!1;try{for(t=t.call(e);!(l=(o=t.next()).done)&&(r.push(o.value),!n||r.length!==n);l=!0);}catch(e){a=!0,i=e}finally{try{l||null==t.return||t.return()}finally{if(a)throw i}}return r}}(e,n)||function(e,n){if(e){if("string"==typeof e)return z(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?z(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var B={height:0,width:0,border:0,padding:0};const O=function(e){var n=e.isLoginEnabled,t=(0,g.useConfig)(),r=(0,_.useTranslation)().t,d=(0,g.useSession)().user,m=(0,a.useLocation)(),p=(0,a.useNavigate)(),h=R((0,o.useState)(""),2),f=h[0],v=h[1],b=R((0,o.useState)(""),2),y=b[0],w=b[1],E=R((0,o.useState)(""),2),x=E[0],k=E[1],S=(0,o.useRef)(null),L=(0,o.useRef)(null),z=(0,o.useRef)(null),O="/login/confirm"===m.pathname;(0,o.useEffect)((function(){d?p("/login/location",{state:m.state}):f||"/login/confirm"!==m.pathname||p("/login",{state:m.state})}),[f,p,m,d]),(0,o.useEffect)((function(){var e=O?S.current:L.current;e&&e.focus()}),[O]),(0,o.useEffect)((function(){if(!d&&"oauth2"===t.provider.type){var e=t.provider.loginUrl;window.location.href=e}}),[t,d]);var Z,j,T=(0,o.useCallback)((function(){var e=L.current;e.value.length>0?p("/login/confirm",{state:m.state}):e.focus()}),[p]),U=(0,o.useCallback)((function(e){return v(e.target.value)}),[]),H=(0,o.useCallback)((function(e){return w(e.target.value)}),[]),P=(0,o.useCallback)((function(){v(""),w("")}),[]),q=(0,o.useCallback)((Z=l().mark((function e(n){var t,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),n.stopPropagation(),O){e.next=5;break}return T(),e.abrupt("return",!1);case 5:return e.prev=5,e.next=8,u(f,y);case 8:if(t=e.sent,(o=t.data)&&o.authenticated){e.next=13;break}throw new Error("invalidCredentials");case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(5),k(e.t0.message),P();case 19:return e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,null,[[5,15]])})),j=function(){var e=this,n=arguments;return new Promise((function(t,o){var i=Z.apply(e,n);function r(e){A(i,t,o,r,l,"next",e)}function l(e){A(i,t,o,r,l,"throw",e)}r(void 0)}))},function(e){return j.apply(this,arguments)}),[T,P,O,f,y]),V=t.logo.src?i().createElement("img",{src:(0,g.interpolateUrl)(t.logo.src),alt:t.logo.alt,className:C["logo-img"]}):i().createElement("svg",{role:"img",className:C.logo},i().createElement("title",null,"OpenMRS logo"),i().createElement("use",{xlinkHref:"#omrs-logo-full-color"}));return"basic"===t.provider.type?i().createElement("div",{className:"canvas ".concat(C.container)},x&&i().createElement(s.K0D,{kind:"error",style:{width:"23rem",marginBottom:"3rem"},subtitle:r(x),title:r("error","Error"),onClick:function(){return k("")}}),i().createElement(s.n9L,{className:C["login-card"]},O?i().createElement("div",{className:C["back-button-div"]},i().createElement(s.zxk,{className:C["back-button"],iconDescription:"Back to username",kind:"ghost",onClick:function(){return p("/login")},renderIcon:function(e){return i().createElement(c.Xd,N({size:24,style:{marginRight:"0.5rem"}},e))}},i().createElement("span",null,r("back","Back")))):null,i().createElement("div",{className:C.center},V),i().createElement("form",{onSubmit:q,ref:z},!O&&i().createElement("div",{className:C["input-group"]},i().createElement(s.oil,{id:"username",type:"text",name:"username",labelText:r("username","Username"),value:f,onChange:U,ref:L,autoFocus:!0,required:!0}),i().createElement("input",{id:"password",style:B,type:"password",name:"password",value:y,onChange:H}),i().createElement(s.zxk,{className:C.continueButton,renderIcon:function(e){return i().createElement(c.ol,N({size:24},e))},type:"submit",iconDescription:"Continue to login",onClick:T,disabled:!n},r("continue","Continue"))),O&&i().createElement("div",{className:C["input-group"]},i().createElement("input",{id:"username",type:"text",name:"username",style:B,value:f,onChange:U,required:!0}),i().createElement(s.WUg,{id:"password",invalidText:r("validValueRequired","A valid value is required"),labelText:r("password","Password"),name:"password",value:y,onChange:H,ref:S,required:!0,showPasswordLabel:"Show password"}),i().createElement(s.zxk,{type:"submit",className:C.continueButton,renderIcon:function(e){return i().createElement(c.ol,N({size:24},e))},iconDescription:"Log in",disabled:!n},r("login","Log in"))))),i().createElement("div",{className:C["need-help"]},i().createElement("p",{className:C["need-help-txt"]},r("needHelp","Need help?"),i().createElement(s.zxk,{kind:"ghost"},r("contactAdmin","Contact the site administrator")))),i().createElement("div",{className:C.footer},i().createElement("p",{className:C["powered-by-txt"]},r("poweredBy","Powered by")),i().createElement("div",null,i().createElement("svg",{role:"img",className:C["powered-by-logo"]},i().createElement("use",{xlinkHref:"#omrs-logo-partial-mono"}))))):null};var Z=t(4865),j=t(5048),T={};T.styleTagTransform=k(),T.setAttributes=y(),T.insert=v().bind(null,"head"),T.domAPI=h(),T.insertStyleElement=E(),m()(j.Z,T);const U=j.Z&&j.Z.locals?j.Z.locals:void 0,H=function(){return i().createElement("div",{className:U.centerLoadingSVG},i().createElement(s.gbz,{description:"Active loading indicator",role:"progressbar",withOverlay:!1,small:!0}))};var P=t(9607);const q=function(e){var n=e.isLoginEnabled,t=(0,a.useLocation)().state,r=new URLSearchParams(null===location||void 0===location?void 0:location.search).get("returnToUrl"),l=null==t?void 0:t.referrer,s=(0,g.useConfig)(),c=(0,g.useSession)().user,_=(0,Z.h)(s.chooseLocation.useLoginLocationTag),u=_.locationData,d=_.isLoading,m=(0,o.useCallback)((function(e){(e?(0,g.setSessionLocation)(e,new AbortController):Promise.resolve()).then((function(){!l||["/","/login","/login/location"].includes(l)?r&&"/"!==r?(0,g.navigate)({to:r}):(0,g.navigate)({to:s.links.loginSuccess}):(0,g.navigate)({to:"${openmrsSpaBase}"+l})}))}),[l,s.links.loginSuccess,r]);return(0,o.useEffect)((function(){var e;d||(s.chooseLocation.enabled&&1!==(null==u?void 0:u.length)||m(null===(e=u[0])||void 0===e?void 0:e.resource.id),d||(null==u?void 0:u.length)||m())}),[u,c,m,s.chooseLocation.enabled,d]),d||c?d&&n?i().createElement(H,null):i().createElement(P.default,{currentUser:c.display,loginLocations:null!=u?u:[],onChangeLocation:m,isLoginEnabled:n}):((0,g.navigate)({to:"${openmrsSpaBase}/login"}),null)};function V(e,n,t,o,i,r,l){try{var a=e[r](l),s=a.value}catch(e){return void t(e)}a.done?n(s):Promise.resolve(s).then(o,i)}function D(e){return function(){var n=this,t=arguments;return new Promise((function(o,i){var r=e.apply(n,t);function l(e){V(r,o,i,l,a,"next",e)}function a(e){V(r,o,i,l,a,"throw",e)}l(void 0)}))}}function I(){return(I=D(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.openmrsFetch)("/ws/rest/v1/session",{method:"DELETE"});case 2:return(0,g.clearCurrentUser)(),e.next=5,(0,g.refetchCurrentUser)();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}const F=function(e){var n=e.isLoginEnabled,t=(0,g.useConfig)(),i=(0,g.useSession)();return(0,o.useEffect)((function(){i.authenticated&&n?function(){return I.apply(this,arguments)}().then((function(){"oauth2"===t.provider.type?location.href=t.provider.logoutUrl:(0,g.navigate)({to:"${openmrsSpaBase}/login"})})):(0,g.navigate)({to:"${openmrsSpaBase}/login"})}),[n,i,t]),null},G=function(e){var n=e.isLoginEnabled;return i().createElement(a.BrowserRouter,{basename:window.spaBase},i().createElement(a.Routes,null,i().createElement(a.Route,{path:"/login",element:i().createElement(O,{isLoginEnabled:n})}),i().createElement(a.Route,{path:"/login/confirm",element:i().createElement(O,{isLoginEnabled:n})}),i().createElement(a.Route,{path:"/login/location",element:i().createElement(q,{isLoginEnabled:n})}),i().createElement(a.Route,{path:"/logout",element:i().createElement(F,{isLoginEnabled:n})})))}}}]);