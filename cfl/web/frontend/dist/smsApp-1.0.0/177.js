"use strict";(globalThis.webpackChunksmsApp=globalThis.webpackChunksmsApp||[]).push([[177],{1354:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(2001),a=n.n(r),l=n(935),i=n.n(l)()(a());i.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79;--bottom-nav-height: 4rem;--workspace-header-height: 3rem;--tablet-workspace-window-height: calc(100vh - var(--omrs-navbar-height));--desktop-workspace-window-height: calc(100vh - var(--omrs-navbar-height) - var(--workspace-header-height))}.smsApp__upload-template-modal__errorContainer___tS2i_{margin:1rem 0}.smsApp__upload-template-modal__uploadFile___h4NMK{color:#fff;width:100%;height:406px}.smsApp__upload-template-modal__uploadFile___h4NMK div>button{max-width:100%;display:flex;flex-flow:column;justify-content:center;align-items:center;height:406px;position:relative}.smsApp__upload-template-modal__uploadFile___h4NMK label{max-width:unset}.smsApp__upload-template-modal__uploadFile___h4NMK label>div{height:25rem;justify-content:center;align-items:center}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/providers/modals/upload-template-modal.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CACA,yBAAA,CACA,+BAAA,CACA,yEAAA,CACA,2GAAA,CCvDF,uDACE,aAAA,CAGF,mDACE,UDRM,CCSN,UAAA,CACA,YAAA,CAEA,8DACE,cAAA,CACA,YAAA,CACA,gBAAA,CACA,sBAAA,CACA,kBAAA,CACA,YAAA,CACA,iBAAA,CAGF,yDACE,eAAA,CAGF,6DACE,YAAA,CACA,sBAAA,CACA,kBAAA",sourceRoot:""}]),i.locals={errorContainer:"smsApp__upload-template-modal__errorContainer___tS2i_",uploadFile:"smsApp__upload-template-modal__uploadFile___h4NMK"};const o=i},2025:(e,t,n)=>{n.d(t,{Ki:()=>d,ql:()=>c,yD:()=>A,yh:()=>f});var r=n(1083);function a(e,t,n,r,a,l,i){try{var o=e[l](i),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,l){var i=e.apply(t,n);function o(e){a(i,r,l,o,s,"next",e)}function s(e){a(i,r,l,o,s,"throw",e)}o(void 0)}))}}function i(e,t){var n,r,a,l,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function o(l){return function(o){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,o])}}}function o(e){return s.apply(this,arguments)}function s(){return s=l((function(e){var t,n,a=arguments;return i(this,(function(l){switch(l.label){case 0:return t=a.length>1&&void 0!==a[1]?a[1]:{},n=a.length>2&&void 0!==a[2]?a[2]:new AbortController,[4,(0,r.openmrsFetch)(e,{signal:n.signal,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})];case 1:return[2,l.sent().data]}}))})),s.apply(this,arguments)}function c(e){return u.apply(this,arguments)}function u(){return(u=l((function(e){return i(this,(function(t){switch(t.label){case 0:return[4,o("/ws/sms/configs",{configs:e})];case 1:return[2,t.sent()]}}))}))).apply(this,arguments)}function d(e){return p.apply(this,arguments)}function p(){return(p=l((function(e){var t,n;return i(this,(function(a){switch(a.label){case 0:return t=new AbortController,(n=new FormData).append("file",e),[4,(0,r.openmrsFetch)("/ws/sms/templates/import",{signal:t.signal,method:"POST",headers:{},body:n})];case 1:return[2,a.sent()]}}))}))).apply(this,arguments)}function A(e){return m.apply(this,arguments)}function m(){return(m=l((function(e){return i(this,(function(t){switch(t.label){case 0:return[4,o("/ws/sms/send",e)];case 1:return[2,t.sent()]}}))}))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=l((function(e){return i(this,(function(t){switch(t.label){case 0:return[4,o("/ws/sms/configs",e)];case 1:return[2,t.sent()]}}))}))).apply(this,arguments)}},177:(e,t,n)=>{n.r(t),n.d(t,{default:()=>F});var r=n(380),a=n.n(r),l=n(7131),i=n(3150),o=n(2591),s=n.n(o),c=n(1740),u=n.n(c),d=n(8128),p=n.n(d),A=n(855),m=n.n(A),f=n(3051),h=n.n(f),b=n(3656),C=n.n(b),v=n(1354),y={};y.styleTagTransform=C(),y.setAttributes=m(),y.insert=p().bind(null,"head"),y.domAPI=u(),y.insertStyleElement=h(),s()(v.A,y);const _=v.A&&v.A.locals?v.A.locals:void 0;var g=n(1899),w=n(2025),E=n(1083);function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const F=function(e){var t=e.closeModal,n=e.mutateTemplates,o=(0,i.useTranslation)().t,s=(0,E.useConfig)().maxFileSize,c=k((0,r.useState)(null),2),u=c[0],d=c[1],p=k((0,r.useState)(null),2),A=p[0],m=p[1],f=k((0,r.useState)(null),2),h=f[0],b=f[1],C=(0,r.useCallback)((function(e){var t=e[0];if(t.size>1024*s*1024)return d({title:o("fileSizeLimitExceededText","File size limit exceeded"),subtitle:'The file "'.concat(t.name,'" ').concat(o("fileSizeLimitExceeded","exceeds the size limit of")," ").concat(s," MB.")});m(t)}),[s,o]),v=(0,r.useCallback)((function(){m(null),b(null),t()}),[t]);(0,r.useEffect)((function(){var e=new FileReader;e.onload=function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.result;try{var r=JSON.parse(n);b(JSON.stringify(r,null,2))}catch(e){b("Invalid JSON file")}},A&&e.readAsText(A)}),[A]);var y=(0,r.useCallback)((function(e){if(e.preventDefault(),A)return(0,w.Ki)(A).then((function(){null==n||n(),(0,E.showSnackbar)({title:o("uploadSuccess","Upload successful"),kind:"success"}),t()})).catch((function(){return(0,E.showSnackbar)({title:o("uploadNotSuccess","Upload unsuccessful"),kind:"error"})}))}),[t,A,n,o]);return a().createElement(l.lVW,{onSubmit:y},a().createElement(l.rQ0,{closeModal:v,title:o("uploadConfig","Upload configuration template")}),a().createElement(l.cwr,{className:_.modalBody},A?a().createElement(a().Fragment,null,a().createElement("div",{className:_.filePlaceholder},a().createElement(g.WZ,{size:16})),a().createElement("div",{className:_.imageDetails},a().createElement(l.BJc,{gap:5},a().createElement("div",{className:"cds--label"},o("fileName","File name")),a().createElement("h6",null,A.name),h&&a().createElement("div",{className:_.jsonPreviesw},a().createElement(l.fs1,{labelText:o("fileContent","File Content"),value:h,readOnly:!0,rows:10}))))):a().createElement("div",{className:"cds--file__container"},u&&a().createElement("div",{className:_.errorContainer},a().createElement(l.jeF,{"aria-label":"Upload error notification",kind:"error",onClose:function(){return d(null)},subtitle:u.subtitle,title:u.title})),a().createElement("p",{className:"cds--label-description"},o("fileUploadSizeConstraints","Size limit is {{fileSize}}MB",{fileSize:s}),"."),a().createElement("div",{className:_.uploadFile},a().createElement(l.F9d,{accept:[".json"],labelText:o("fileSizeInstructions","Drag and drop files here or click to upload"),tabIndex:0,onAddFiles:function(e,t){var n=t.addedFiles;C(n)}})))),a().createElement(l.jlY,null,a().createElement(l.$nd,{kind:"secondary",size:"lg",onClick:v},o("cancel","Cancel")),a().createElement(l.$nd,{type:"submit",size:"lg",disabled:!A},o("uploadConfig","Upload config"))))}}}]);