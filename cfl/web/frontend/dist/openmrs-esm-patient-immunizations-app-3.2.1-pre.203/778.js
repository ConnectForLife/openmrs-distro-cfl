"use strict";(self.webpackChunk_openmrs_esm_patient_immunizations_app=self.webpackChunk_openmrs_esm_patient_immunizations_app||[]).push([[778],{2996:(e,t,n)=>{n.d(t,{Z:()=>c});var i=n(9601),r=n.n(i),a=n(2609),o=n.n(a)()(r());o.push([e.id,"html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{padding:0;border:0;margin:0;font:inherit;font-size:100%;vertical-align:baseline}button,select,input,textarea{border-radius:0;font-family:inherit}input[type=text]::-ms-clear{display:none}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section{display:block}body{line-height:1}sup{vertical-align:super}sub{vertical-align:sub}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote::before,blockquote::after,q::before,q::after{content:\"\"}table{border-collapse:collapse;border-spacing:0}*{box-sizing:border-box}button{margin:0}html{font-size:100%}body{font-weight:400;font-family:'IBM Plex Sans', 'Helvetica Neue', Arial, sans-serif;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility}code{font-family:'IBM Plex Mono', 'Menlo', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Courier, monospace}strong{font-weight:600}@media screen and (-ms-high-contrast: active){svg{fill:ButtonText}}h1{font-size:2.625rem;font-weight:300;line-height:1.199;letter-spacing:0}h2{font-size:2rem;font-weight:400;line-height:1.25;letter-spacing:0}h3{font-size:1.75rem;font-weight:400;line-height:1.29;letter-spacing:0}h4{font-size:1.25rem;font-weight:400;line-height:1.4;letter-spacing:0}h5{font-size:1rem;font-weight:600;line-height:1.375;letter-spacing:0}h6{font-size:.875rem;font-weight:600;line-height:1.29;letter-spacing:.16px}p{font-size:1rem;font-weight:400;line-height:1.5;letter-spacing:0}a{color:#0f62fe}em{font-style:italic}@keyframes -esm-patient-immunizations__immunizations-form__skeleton___R1bGi{0%{opacity:.3;transform:scaleX(0);transform-origin:left}20%{opacity:1;transform:scaleX(1);transform-origin:left}28%{transform:scaleX(1);transform-origin:right}51%{transform:scaleX(0);transform-origin:right}58%{transform:scaleX(0);transform-origin:right}82%{transform:scaleX(1);transform-origin:right}83%{transform:scaleX(1);transform-origin:left}96%{transform:scaleX(0);transform-origin:left}100%{opacity:.3;transform:scaleX(0);transform-origin:left}}:root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-immunizations__immunizations-form__immunizationSequenceSelect___MlJNX{margin:1rem 2rem 1rem}.-esm-patient-immunizations__immunizations-form__form___K6IzX{display:flex;flex-direction:column;justify-content:space-between;height:calc(100vh - 6rem)}.-esm-patient-immunizations__immunizations-form__button___L8zJi{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-patient-immunizations__immunizations-form__tablet___zycFW{padding:1.5rem 1rem;background-color:#fff}.-esm-patient-immunizations__immunizations-form__desktop___c6k1T{padding:0rem}",""]),o.locals={immunizationSequenceSelect:"-esm-patient-immunizations__immunizations-form__immunizationSequenceSelect___MlJNX",form:"-esm-patient-immunizations__immunizations-form__form___K6IzX",button:"-esm-patient-immunizations__immunizations-form__button___L8zJi",tablet:"-esm-patient-immunizations__immunizations-form__tablet___zycFW",desktop:"-esm-patient-immunizations__immunizations-form__desktop___c6k1T",skeleton:"-esm-patient-immunizations__immunizations-form__skeleton___R1bGi"};const c=o},1756:(e,t,n)=>{n.d(t,{V:()=>d,j:()=>p});var i=n(3066),r=n(2449),a=n(772),o=n(468),c=n(4402),l=n(3012),u=n(3939),s=function(e){var t,n,r=null==e?void 0:e.resource,a=null==r?void 0:r.id,o=null==r||null===(t=r.manufacturer)||void 0===t?void 0:t.display,c=null==r?void 0:r.lotNumber,l=(null==r||null===(n=r.protocolApplied)||void 0===n?void 0:n.length)>0&&(null==r?void 0:r.protocolApplied[0]);return{immunizationObsUuid:a,manufacturer:o,lotNumber:c,sequenceLabel:null==l?void 0:l.series,sequenceNumber:null==l?void 0:l.doseNumberPositiveInt,occurrenceDateTime:(0,i.formatDate)(new Date(null==r?void 0:r.occurrenceDateTime)),expirationDate:(0,i.formatDate)(new Date(null==r?void 0:r.expirationDate))}},m=function(e){var t;return(0,r.Z)(null==e||null===(t=e.vaccineCode)||void 0===t?void 0:t.coding,(function(e){return(0,c.Z)(e.system)}))},d=function(e){var t=(0,o.Z)(e.entry,(function(e){var t;return null===(t=m(e.resource))||void 0===t?void 0:t.code}));return(0,l.Z)(t,(function(e){var t,n=(0,l.Z)(e,s),i=m(null===(t=e[0])||void 0===t?void 0:t.resource);return{vaccineName:null==i?void 0:i.display,vaccineUuid:null==i?void 0:i.code,existingDoses:(0,u.Z)(n,[function(e){return(0,a.Z)(e,"occurrenceDateTime")}],["desc"])}}))};function f(e,t){return{type:e,reference:"".concat(e,"/").concat(t)}}var p=function(e,t,n,r){return{resourceType:"Immunization",status:"completed",id:e.immunizationObsUuid,vaccineCode:{coding:[{code:e.vaccineUuid,display:e.vaccineName}]},patient:f("Patient",e.patientUuid),encounter:f("Encounter",t),occurrenceDateTime:(0,i.parseDate)(e.vaccinationDate),expirationDate:(0,i.parseDate)(e.expirationDate),location:f("Location",n),performer:[{actor:f("Practitioner",r)}],manufacturer:{display:e.manufacturer},lotNumber:e.lotNumber,protocolApplied:[{doseNumberPositiveInt:e.currentDose.sequenceNumber,series:e.currentDose.sequenceLabel}]}}},2458:(e,t,n)=>{n.d(t,{s:()=>i});var i=new(n(2444).BehaviorSubject)(null)},4778:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var i=n(9902),r=n.n(i),a=n(321),o=n.n(a),c=n(1195),l=n.n(c),u=n(3275),s=n.n(u),m=n(7162),d=n.n(m),f=n(2094),p=n.n(f),v=n(757),b=n.n(v),g=n(2996),h={};h.styleTagTransform=b(),h.setAttributes=d(),h.insert=s().bind(null,"head"),h.domAPI=l(),h.insertStyleElement=p(),o()(g.Z,h);const y=g.Z&&g.Z.locals?g.Z.locals:void 0;var _=n(3066),z=n(4924),S=n(8108),D=n(1756),w=n(7898),N=n(2810),x=n(5067),k=n(6642),q=n(182),O=n(7367),E=n(6549),Z=n(7030),j=n(2458);function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){T(e,t,n[t])}))}return e}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a=[],o=!0,c=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(a.push(i.value),!t||a.length!==t);o=!0);}catch(e){c=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(c)throw r}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const A=function(e){var t,n,a=e.patientUuid,o=e.closeWorkspace,c=I((0,i.useState)({vaccineName:"",vaccineUuid:"",immunizationObsUuid:"",vaccinationDate:null,sequences:[],currentDose:{},expirationDate:null,lotNumber:"",manufacturer:"",formChanged:!1}),2),l=c[0],u=c[1],s=function(e,t){return u((function(n){return i=C({},n),r=null!=(r=T({},e,t))?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n.push.apply(n,i)}return n}(Object(r)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(r,e))})),i;var i,r}))},m=(0,z.useTranslation)().t,d=(0,_.useSession)(),f=(0,_.useVisit)(a).currentVisit,p="tablet"===(0,_.useLayoutType)(),v=!!l.immunizationObsUuid,b=!v&&!!l.vaccinationDate,g=v&&l.formChanged;(0,i.useEffect)((function(){var e=j.s.subscribe((function(e){return e&&u(e)}));return function(){return e.unsubscribe()}}),[]);var h,P=r().useCallback((function(e){var t,n;e.preventDefault();var i=null==f?void 0:f.uuid,r=null==d||null===(t=d.sessionLocation)||void 0===t?void 0:t.uuid,c=null==d||null===(n=d.currentProvider)||void 0===n?void 0:n.uuid,u=C({patientUuid:a},l),s=new AbortController;return(0,S.eu)((0,D.j)(u,i,r,c),a,l.immunizationObsUuid,s).then((function(e){201===e.status&&o(),(0,_.showToast)({kind:"success",description:m("vaccinationSaved","Vaccination saved successfully")})}),(function(e){(0,_.showNotification)({title:m("errorSaving","Error saving vaccination"),kind:"error",critical:!0,description:null==e?void 0:e.message})})),function(){return s.abort()}}),[null==d||null===(t=d.sessionLocation)||void 0===t?void 0:t.uuid,o,l,a,null==d||null===(n=d.currentProvider)||void 0===n?void 0:n.uuid,null==f?void 0:f.uuid,m]);return r().createElement(w.Z,{className:y.form,onSubmit:P,"data-testid":"immunization-form"},r().createElement("div",null,r().createElement("h4",{className:y.immunizationSequenceSelect},"".concat(m("vaccine","Vaccine")," : ").concat(null==l?void 0:l.vaccineName)," "),(h=l.sequences)&&(null==h?void 0:h.length)>0&&r().createElement("div",{className:y.immunizationSequenceSelect},r().createElement(N.Z,{id:"sequence",name:"sequence",value:l.currentDose.sequenceNumber,onChange:function(e){var t=l.sequences.find((function(t){return n=e.target.value,!isNaN(n)&&t.sequenceNumber===parseInt(e.target.value);var n}))||{};s("currentDose",t)},className:"immunizationSequenceSelect",labelText:m("sequence","Sequence")},r().createElement(x.Z,{text:m("pleaseSelect","Please select"),value:"DEFAULT"},m("pleaseSelect","Please select")),l.sequences.map((function(e){return r().createElement(x.Z,{key:e.sequenceNumber,text:e.sequenceLabel,value:e.sequenceNumber},m(e.sequenceLabel,e.sequenceLabel))})))),r().createElement("div",{className:y.immunizationSequenceSelect},r().createElement(k.Z,{id:"vaccinationDate",className:"vaccinationDate",maxDate:(new Date).toISOString(),dateFormat:"d/m/Y",datePickerType:"single",value:l.vaccinationDate,onChange:function(e){var t=I(e,1)[0];return s("vaccinationDate",t.toISOString())}},r().createElement(q.Z,{id:"date-picker-calendar-id",placeholder:"dd/mm/yyyy",labelText:m("vaccinationDate","Vaccination Date"),type:"text"}))),r().createElement("div",{className:y.immunizationSequenceSelect},r().createElement(k.Z,{id:"vaccinationExpiration",className:"vaccinationExpiration",minDate:(new Date).toISOString(),dateFormat:"d/m/Y",datePickerType:"single",value:l.expirationDate,onChange:function(e){var t=I(e,1)[0];return s("expirationDate",t.toISOString())}},r().createElement(q.Z,{id:"date-picker-calendar-id",placeholder:"dd/mm/yyyy",labelText:m("expirationDate","Expiration Date"),type:"text"}))),r().createElement("div",{className:y.immunizationSequenceSelect},r().createElement(O.Z,{type:"text",id:"lotNumber",labelText:m("lotNumber","Lot Number"),value:l.lotNumber,onChange:function(e){return s("lotNumber",e.target.value)}})),r().createElement("div",{className:y.immunizationSequenceSelect},r().createElement(O.Z,{type:"text",id:"manufacturer",labelText:m("manufacturer","Manufacturer"),value:l.manufacturer,onChange:function(e){return s("manufacturer",e.target.value)}}))),r().createElement(E.Z,{className:p?y.tablet:y.desktop},r().createElement(Z.Z,{className:y.button,kind:"secondary",onClick:function(){return o()}},m("cancel","Cancel")),r().createElement(Z.Z,{className:y.button,kind:"primary",disabled:v?!g:!b},m("save","Save"))))}},8108:(e,t,n)=>{n.d(t,{dv:()=>u,eu:()=>s,iX:()=>l}),n(5047);var i=n(9857),r=n(3066),a=n(9867),o=n(1756);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function l(){var e,t,n,o=(0,r.useConfig)().immunizationsConfig,l=null==o?void 0:o.vaccinesConceptSet,u=(t=l.split(":"),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a=[],o=!0,c=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(a.push(i.value),!t||a.length!==t);o=!0);}catch(e){c=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(c)throw r}}return a}}(t,n)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=u[0],m=u[1],d="/ws/rest/v1/concept?source=".concat(s,"&code=").concat(m,"&v=full"),f="/ws/rest/v1/concept/".concat(l,"?v=full"),p=(0,i.ZP)((e=l,(0,a.Z)(e,":")?d:f),r.openmrsFetch),v=p.data,b=p.error;return{data:v?v.data.results[0]:null,isError:b,isLoading:!v&&!b}}function u(e){var t="".concat(r.fhirBaseUrl,"/Immunization?patient=").concat(e),n=(0,i.ZP)(t,r.openmrsFetch),a=n.data,c=n.error,l=n.isValidating,u=a?(0,o.V)(a.data):null;return{data:a?u:null,isError:c,isLoading:!a&&!c,isValidating:l}}function s(e,t,n,i){var a="".concat(r.fhirBaseUrl,"/Immunization");return n&&(a="".concat(a,"/").concat(n)),(0,r.openmrsFetch)(a,{headers:{"Content-Type":"application/json"},method:"POST",body:e,signal:i.signal})}}}]);