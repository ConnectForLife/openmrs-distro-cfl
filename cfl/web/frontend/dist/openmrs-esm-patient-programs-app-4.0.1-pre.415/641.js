"use strict";(self.webpackChunk_openmrs_esm_patient_programs_app=self.webpackChunk_openmrs_esm_patient_programs_app||[]).push([[641],{6983:(e,r,t)=>{t.d(r,{Z:()=>i});var n=t(9601),o=t.n(n),a=t(2609),l=t.n(a)()(o());l.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-programs__programs-overview__widgetCard___W1HJv{border:1px solid #e0e0e0}",""]),l.locals={widgetCard:"-esm-patient-programs__programs-overview__widgetCard___W1HJv"};const i=l},7641:(e,r,t)=>{t.r(r),t.d(r,{default:()=>Z});var n=t(268),o=t.n(n),a=t(4924),l=t(5573),i=t(5922),s=t(6759),d=t(6217),c=t(906),u=t(4076),m=t(6039);function p(){return p=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},p.apply(this,arguments)}const g=function(e){var r=e.enrollment,t=(0,a.useTranslation)().t,n="eligible"===r.enrollmentStatus?r.enrollmentFormUuid:r.discontinuationFormUuid,l=function(e){d.formEntrySub.next({formUuid:n,encounterUuid:""}),(0,d.launchPatientWorkspace)("patient-form-entry-workspace",{workspaceTitle:"".concat(null==r?void 0:r.display," ").concat(e," Form")})};return"eligible"===r.enrollmentStatus?o().createElement(i.zxk,{iconDescription:"Enroll to program",onClick:function(){return l(t("enrollment","Enrollment"))},renderIcon:function(e){return o().createElement(m.sQ,p({size:20},e))},kind:"tertiary",size:"sm"},t("enroll","Enroll")):o().createElement(i.zxk,{iconDescription:"Discontinue enrollment",onClick:function(){return l(t("discontinue","Discontinue"))},renderIcon:function(e){return o().createElement(m.sQ,p({size:20},e))},kind:"danger--ghost",size:"sm"},t("discontinue","Discontinue"))};var v=t(6062),f=t.n(v),b=t(4036),h=t.n(b),E=t(6793),y=t.n(E),P=t(7892),w=t.n(P),O=t(1173),k=t.n(O),C=t(2464),_=t.n(C),S=t(6983),j={};j.styleTagTransform=_(),j.setAttributes=w(),j.insert=y().bind(null,"head"),j.domAPI=h(),j.insertStyleElement=k(),f()(S.Z,j);const D=S.Z&&S.Z.locals?S.Z.locals:void 0;function T(){return T=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},T.apply(this,arguments)}const Z=function(e){e.basePath;var r,t,n=e.patientUuid,m=(0,a.useTranslation)().t,p=(0,c.useConfig)(),v=m("programs","Program enrollments"),f=m("carePrograms","Care Programs"),b=m("seeAll","See all"),h="${openmrsSpaBase}/patient/".concat(n,"/chart/Programs"),E=!!p.customUrl,y=(0,u.b$)(n),P=y.activeEnrollments,w=y.availablePrograms,O=y.configurablePrograms,k=y.eligiblePrograms,C=y.enrollments,_=y.isError,S=y.isLoading,j=y.isValidating,Z=(0,c.usePagination)(E?O:null!=C?C:[],5),L=Z.results,F=Z.goTo,z=Z.currentPage,A=o().useCallback((function(){return(0,d.launchPatientWorkspace)("programs-form-workspace")}),[]),x=[{key:"display",header:m("activePrograms","Active programs")},{key:"location",header:m("location","Location")},{key:"dateEnrolled",header:m("dateEnrolled","Date enrolled")},{key:"status",header:m("status","Status")},{key:"actions",header:m("actions","Actions")}],U=o().useMemo((function(){return null==L?void 0:L.map((function(e){var r;return{id:e.uuid,display:e.display,location:null===(r=e.location)||void 0===r?void 0:r.display,dateEnrolled:e.dateEnrolled?(0,c.formatDatetime)(new Date(e.dateEnrolled)):"--",status:E?(0,l.Z)(e.enrollmentStatus):e.dateCompleted?"".concat(m("completedOn","Completed On")," ").concat((0,c.formatDate)(new Date(e.dateCompleted))):m("active","Active"),actions:o().createElement(g,{enrollment:e})}}))}),[E,L,m]);return S?o().createElement(i.gqd,{role:"progressbar"}):_?o().createElement(d.ErrorState,{error:_,headerTitle:f}):(E?O.length:null==P?void 0:P.length)?o().createElement("div",{className:D.widgetCard},o().createElement(d.CardHeader,{title:f},p.hideAddProgramButton?null:o().createElement(i.zxk,{kind:"ghost",renderIcon:function(e){return o().createElement(s.mm,T({size:16},e))},iconDescription:"Add programs",onClick:A,disabled:(null==w?void 0:w.length)&&0===(null==k?void 0:k.length)},m("add","Add")),o().createElement("span",null,j?o().createElement(i.lSo,null):null)),(null==w?void 0:w.length)&&0===(null==k?void 0:k.length)&&o().createElement(i.K0D,{style:{minWidth:"100%",margin:"0rem",padding:"0rem"},kind:"info",lowContrast:!0,subtitle:m("noEligibleEnrollments","There are no more programs left to enroll this patient in"),title:m("fullyEnrolled","Enrolled in all programs")}),o().createElement(i.wQF,{rows:U,headers:x,isSortable:!0,size:"sm",useZebraStyles:!0},(function(e){var n=e.rows,a=e.headers,l=e.getHeaderProps,s=e.getTableProps;return o().createElement(i.xJi,null,o().createElement(i.iA_,T({},s()),o().createElement(i.ssF,null,o().createElement(i.SCH,null,a.map((function(e){var t;return o().createElement(i.xDH,T({className:"".concat(D.productiveHeading01," ").concat(D.text02)},l({header:e,isSortable:e.isSortable})),null!==(r=null===(t=e.header)||void 0===t?void 0:t.content)&&void 0!==r?r:e.header)})))),o().createElement(i.RMI,null,n.map((function(e){return o().createElement(i.SCH,{key:e.id},e.cells.map((function(e){var r;return o().createElement(i.pj1,{key:e.id},null!==(t=null===(r=e.value)||void 0===r?void 0:r.content)&&void 0!==t?t:e.value)})))})))))})),o().createElement(d.PatientChartPagination,{currentItems:L.length,onPageNumberChange:function(e){var r=e.page;return F(r)},pageNumber:z,pageSize:5,totalItems:E?O.length:null==C?void 0:C.length,dashboardLinkUrl:h,dashboardLinkLabel:b})):o().createElement(d.EmptyState,{displayText:v,headerTitle:f,launchForm:A})}},4076:(e,r,t)=>{t.d(r,{Bw:()=>u,YX:()=>g,b$:()=>v,df:()=>p,o9:()=>c,oI:()=>m});var n=t(9857),o=t(906),a=t(4200),l=t(3863),i=t(8827),s=t(819);function d(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var c="custom:(uuid,display,program,dateEnrolled,dateCompleted,location:(uuid,display))";function u(e){var r,t=(0,n.ZP)("/ws/rest/v1/programenrollment?patient=".concat(e,"&v=").concat(c),o.openmrsFetch),l=t.data,i=t.error,s=t.isValidating,d=(null==l||null===(r=l.data)||void 0===r?void 0:r.results.length)>0?null==l?void 0:l.data.results.sort((function(e,r){return r.dateEnrolled>e.dateEnrolled?1:-1})):null,u=null==d?void 0:d.filter((function(e){return!e.dateCompleted}));return{data:l?(0,a.Z)(d,(function(e){var r;return null==e||null===(r=e.program)||void 0===r?void 0:r.uuid})):null,isError:i,isLoading:!l&&!i,isValidating:s,activeEnrollments:u}}function m(e){var r,t,a=(0,n.ZP)("/ws/rest/v1/program?v=custom:(uuid,display,allWorkflows,concept:(uuid,display))",o.openmrsFetch),d=a.data,c=a.error,u=null!==(t=null==d||null===(r=d.data)||void 0===r?void 0:r.results)&&void 0!==t?t:null;return{data:u,isError:c,isLoading:!d&&!c,eligiblePrograms:(0,l.Z)(u,(function(r){return!(0,i.Z)((0,s.Z)(e,"program.uuid"),r.uuid)}))}}function p(e,r){if(!e)return null;var t=e.program,n=e.patient,a=e.dateEnrolled,l=e.dateCompleted,i=e.location;return(0,o.openmrsObservableFetch)("/ws/rest/v1/programenrollment",{method:"POST",headers:{"Content-Type":"application/json"},body:{program:t,patient:n,dateEnrolled:a,dateCompleted:l,location:i},signal:r.signal})}function g(e,r,t){if(!r&&!r.program)return null;r.program;var n=r.dateEnrolled,a=r.dateCompleted,l=r.location;return(0,o.openmrsObservableFetch)("/ws/rest/v1/programenrollment/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:{dateEnrolled:n,dateCompleted:a,location:l},signal:t.signal})}var v=function(e){var r,t,a=(0,o.useConfig)().customUrl,l=u(e),i=l.data,s=l.isError,c=l.isLoading,p=l.isValidating,g=l.activeEnrollments,v=m(i),f=v.data,b=v.eligiblePrograms,h=function(e){var r,t=(0,o.useConfig)().customUrl,a=(0,n.ZP)(t?"".concat(t).concat(e):null,o.openmrsFetch),l=a.data,i=a.error;return{configurablePrograms:null!==(r=null==l?void 0:l.data)&&void 0!==r?r:[],isLoading:!l&&!i,error:i}}(e),E=h.configurablePrograms,y=h.isLoading,P=h.error;return r=function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){d(e,r,t[r])}))}return e}({enrollments:i},a?{isLoading:y,isError:P}:{isLoading:c,isError:s}),t=null!=(t={isValidating:p,activeEnrollments:g,availablePrograms:f,eligiblePrograms:b,configurablePrograms:E})?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):function(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})),r}}}]);