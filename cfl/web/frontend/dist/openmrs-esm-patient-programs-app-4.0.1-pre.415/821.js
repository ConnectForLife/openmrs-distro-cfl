"use strict";(self.webpackChunk_openmrs_esm_patient_programs_app=self.webpackChunk_openmrs_esm_patient_programs_app||[]).push([[821],{5351:(e,r,t)=>{t.d(r,{Z:()=>i});var n=t(9601),a=t.n(n),o=t(2609),l=t.n(o)()(a());l.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-programs__programs-detailed-summary__widgetCard___q9_pO{border:1px solid #e0e0e0}",""]),l.locals={widgetCard:"-esm-patient-programs__programs-detailed-summary__widgetCard___q9_pO"};const i=l},9821:(e,r,t)=>{t.r(r),t.d(r,{default:()=>S});var n=t(268),a=t.n(n),o=t(4924),l=t(5922),i=t(6759),s=t(7631),u=t(906),c=t(6217),d=t(4076),m=t(6062),p=t.n(m),g=t(4036),f=t.n(g),v=t(6793),b=t.n(v),h=t(7892),y=t.n(h),E=t(1173),P=t.n(E),O=t(2464),Z=t.n(O),w=t(5351),C={};C.styleTagTransform=Z(),C.setAttributes=y(),C.insert=b().bind(null,"head"),C.domAPI=f(),C.insertStyleElement=P(),p()(w.Z,C);const k=w.Z&&w.Z.locals?w.Z.locals:void 0;function _(){return _=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},_.apply(this,arguments)}function j(e){var r=e.programEnrollmentId,t=a().useCallback((function(){return(0,c.launchPatientWorkspace)("programs-form-workspace",{programEnrollmentId:r})}),[r]);return a().createElement(l.zxk,{kind:"ghost",renderIcon:function(e){return a().createElement(s.I8,_({size:16},e))},iconDescription:"Edit Program",onClick:t,hasIconOnly:!0})}const S=function(e){var r,t,n=e.patientUuid,s=(0,o.useTranslation)().t,m=s("programEnrollments","Program enrollments"),p=s("carePrograms","Care Programs"),g=(0,u.useConfig)(),f=!!g.customUrl,v=(0,d.b$)(n),b=v.enrollments,h=v.isLoading,y=v.isError,E=v.isValidating,P=v.availablePrograms,O=v.eligiblePrograms,Z=v.configurablePrograms,w=(0,u.usePagination)(f?Z:null!=b?b:[],5),C=(w.results,w.goTo,w.currentPage,a().useMemo((function(){return[{key:"display",header:s("activePrograms","Active programs")},{key:"location",header:s("location","Location")},{key:"dateEnrolled",header:s("dateEnrolled","Date enrolled")},{key:"status",header:s("status","Status")},{key:"actions",header:s("actions","Actions")}]}),[s])),S=a().useMemo((function(){return null==b?void 0:b.map((function(e){var r;return{id:e.uuid,display:e.display,location:null===(r=e.location)||void 0===r?void 0:r.display,dateEnrolled:(0,u.formatDatetime)(new Date(e.dateEnrolled)),status:e.dateCompleted?"".concat(s("completedOn","Completed On")," ").concat((0,u.formatDate)(new Date(e.dateCompleted))):s("active","Active"),actions:a().createElement(j,{programEnrollmentId:e.uuid})}}))}),[b,s]),D=a().useCallback((function(){return(0,c.launchPatientWorkspace)("programs-form-workspace")}),[]);return h?a().createElement(l.gqd,{role:"progressbar"}):y?a().createElement(c.ErrorState,{error:y,headerTitle:p}):(null==b?void 0:b.length)?a().createElement("div",{className:k.widgetCard},a().createElement(c.CardHeader,{title:p},a().createElement("span",null,E?a().createElement(l.lSo,null):null),g.hideAddProgramButton?null:a().createElement(l.zxk,{kind:"ghost",renderIcon:function(e){return a().createElement(i.mm,_({size:16},e))},iconDescription:"Add programs",onClick:D,disabled:(null==P?void 0:P.length)&&0===(null==O?void 0:O.length)},s("add","Add"))),(null==P?void 0:P.length)&&0===(null==O?void 0:O.length)?a().createElement(l.K0D,{style:{minWidth:"100%",margin:"0rem",padding:"0rem"},kind:"info",lowContrast:!0,subtitle:s("noEligibleEnrollments","There are no more programs left to enroll this patient in"),title:s("fullyEnrolled","Enrolled in all programs")}):null,a().createElement(l.wQF,{rows:S,headers:C,isSortable:!0,size:"xs",useZebraStyles:!0},(function(e){var n=e.rows,o=e.headers,i=e.getHeaderProps,s=e.getTableProps;return a().createElement(l.xJi,null,a().createElement(l.iA_,_({},s()),a().createElement(l.ssF,null,a().createElement(l.SCH,null,o.map((function(e){var t;return a().createElement(l.xDH,_({className:"".concat(k.productiveHeading01," ").concat(k.text02)},i({header:e,isSortable:e.isSortable})),null!==(r=null===(t=e.header)||void 0===t?void 0:t.content)&&void 0!==r?r:e.header)})))),a().createElement(l.RMI,null,n.map((function(e){return a().createElement(l.SCH,{key:e.id},e.cells.map((function(e){var r;return a().createElement(l.pj1,{key:e.id},null!==(t=null===(r=e.value)||void 0===r?void 0:r.content)&&void 0!==t?t:e.value)})))})))))}))):a().createElement(c.EmptyState,{displayText:m,headerTitle:p,launchForm:D})}},4076:(e,r,t)=>{t.d(r,{Bw:()=>d,YX:()=>g,b$:()=>f,df:()=>p,o9:()=>c,oI:()=>m});var n=t(9857),a=t(906),o=t(4200),l=t(3863),i=t(8827),s=t(819);function u(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var c="custom:(uuid,display,program,dateEnrolled,dateCompleted,location:(uuid,display))";function d(e){var r,t=(0,n.ZP)("/ws/rest/v1/programenrollment?patient=".concat(e,"&v=").concat(c),a.openmrsFetch),l=t.data,i=t.error,s=t.isValidating,u=(null==l||null===(r=l.data)||void 0===r?void 0:r.results.length)>0?null==l?void 0:l.data.results.sort((function(e,r){return r.dateEnrolled>e.dateEnrolled?1:-1})):null,d=null==u?void 0:u.filter((function(e){return!e.dateCompleted}));return{data:l?(0,o.Z)(u,(function(e){var r;return null==e||null===(r=e.program)||void 0===r?void 0:r.uuid})):null,isError:i,isLoading:!l&&!i,isValidating:s,activeEnrollments:d}}function m(e){var r,t,o=(0,n.ZP)("/ws/rest/v1/program?v=custom:(uuid,display,allWorkflows,concept:(uuid,display))",a.openmrsFetch),u=o.data,c=o.error,d=null!==(t=null==u||null===(r=u.data)||void 0===r?void 0:r.results)&&void 0!==t?t:null;return{data:d,isError:c,isLoading:!u&&!c,eligiblePrograms:(0,l.Z)(d,(function(r){return!(0,i.Z)((0,s.Z)(e,"program.uuid"),r.uuid)}))}}function p(e,r){if(!e)return null;var t=e.program,n=e.patient,o=e.dateEnrolled,l=e.dateCompleted,i=e.location;return(0,a.openmrsObservableFetch)("/ws/rest/v1/programenrollment",{method:"POST",headers:{"Content-Type":"application/json"},body:{program:t,patient:n,dateEnrolled:o,dateCompleted:l,location:i},signal:r.signal})}function g(e,r,t){if(!r&&!r.program)return null;r.program;var n=r.dateEnrolled,o=r.dateCompleted,l=r.location;return(0,a.openmrsObservableFetch)("/ws/rest/v1/programenrollment/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:{dateEnrolled:n,dateCompleted:o,location:l},signal:t.signal})}var f=function(e){var r,t,o=(0,a.useConfig)().customUrl,l=d(e),i=l.data,s=l.isError,c=l.isLoading,p=l.isValidating,g=l.activeEnrollments,f=m(i),v=f.data,b=f.eligiblePrograms,h=function(e){var r,t=(0,a.useConfig)().customUrl,o=(0,n.ZP)(t?"".concat(t).concat(e):null,a.openmrsFetch),l=o.data,i=o.error;return{configurablePrograms:null!==(r=null==l?void 0:l.data)&&void 0!==r?r:[],isLoading:!l&&!i,error:i}}(e),y=h.configurablePrograms,E=h.isLoading,P=h.error;return r=function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){u(e,r,t[r])}))}return e}({enrollments:i},o?{isLoading:E,isError:P}:{isLoading:c,isError:s}),t=null!=(t={isValidating:p,activeEnrollments:g,availablePrograms:v,eligiblePrograms:b,configurablePrograms:y})?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):function(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})),r}},1154:(e,r,t)=>{t.d(r,{Z:()=>l});const n=function(e,r,t){for(var n=-1,a=Object(e),o=t(e),l=o.length;l--;){var i=o[++n];if(!1===r(a[i],i,a))break}return e};var a=t(6892);var o=t(3282);const l=(i=function(e,r){return e&&n(e,r,a.Z)},function(e,r){if(null==e)return e;if(!(0,o.Z)(e))return i(e,r);for(var t=e.length,n=-1,a=Object(e);++n<t&&!1!==r(a[n],n,a););return e});var i},3863:(e,r,t)=>{t.d(r,{Z:()=>s});var n=t(2300),a=t(1154);const o=function(e,r){var t=[];return(0,a.Z)(e,(function(e,n,a){r(e,n,a)&&t.push(e)})),t};var l=t(7954),i=t(7885);const s=function(e,r){return((0,i.Z)(e)?n.Z:o)(e,(0,l.Z)(r,3))}},8827:(e,r,t)=>{t.d(r,{Z:()=>O});var n=t(1266),a=t(3282),o=t(9001),l=t(7885),i=t(3391);var s=/\s/;var u=/^\s+/;const c=function(e){return e?e.slice(0,function(e){for(var r=e.length;r--&&s.test(e.charAt(r)););return r}(e)+1).replace(u,""):e};var d=t(3122),m=t(2758),p=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,f=/^0o[0-7]+$/i,v=parseInt;const b=function(e){return e?Infinity===(e=function(e){if("number"==typeof e)return e;if((0,m.Z)(e))return NaN;if((0,d.Z)(e)){var r="function"==typeof e.valueOf?e.valueOf():e;e=(0,d.Z)(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=c(e);var t=g.test(e);return t||f.test(e)?v(e.slice(2),t?2:8):p.test(e)?NaN:+e}(e))||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};var h=t(5598);var y=t(6892);const E=function(e){return null==e?[]:function(e,r){return(0,h.Z)(r,(function(r){return e[r]}))}(e,(0,y.Z)(e))};var P=Math.max;const O=function(e,r,t,s){e=(0,a.Z)(e)?e:E(e),t=t&&!s?function(e){var r=b(e),t=r%1;return r==r?t?r-t:r:0}(t):0;var u=e.length;return t<0&&(t=P(u+t,0)),function(e){return"string"==typeof e||!(0,l.Z)(e)&&(0,i.Z)(e)&&"[object String]"==(0,o.Z)(e)}(e)?t<=u&&e.indexOf(r,t)>-1:!!u&&(0,n.Z)(e,r,t)>-1}},819:(e,r,t)=>{t.d(r,{Z:()=>u});var n=t(5598),a=t(7954),o=t(1154),l=t(3282);const i=function(e,r){var t=-1,n=(0,l.Z)(e)?Array(e.length):[];return(0,o.Z)(e,(function(e,a,o){n[++t]=r(e,a,o)})),n};var s=t(7885);const u=function(e,r){return((0,s.Z)(e)?n.Z:i)(e,(0,a.Z)(r,3))}}}]);