"use strict";(self.webpackChunk_openmrs_esm_fast_data_entry_app=self.webpackChunk_openmrs_esm_fast_data_entry_app||[]).push([[168],{5168:(e,t,r)=>{r.r(t),r.d(t,{default:()=>ut});var n=r(1132),a=r(1672),o=r.n(a),i=r(4422),s=r(2327),l=r(3133),c=r(3379),u=r.n(c),d=r(7795),m=r.n(d),_=r(569),p=r.n(_),f=r(3565),y=r.n(f),h=r(9216),g=r.n(h),v=r(4589),b=r.n(v),E=r(8914),w={};w.styleTagTransform=b(),w.setAttributes=y(),w.insert=p().bind(null,"head"),w.domAPI=m(),w.insertStyleElement=g(),u()(E.Z,w);const S=E.Z&&E.Z.locals?E.Z.locals:void 0;var O=r(3397),N=r(2504),x=r(1338),T=r(7612);function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){A(e,t,r[t])}))}return e}var k={setGroup:function(e){},unsetGroup:function(){},setSessionMeta:function(e){},openPatientSearch:function(){},saveEncounter:function(e){},editEncounter:function(e){},validateForNext:function(){},validateForComplete:function(){},updateVisitUuid:function(e){},submitForNext:function(){},submitForReview:function(){},submitForComplete:function(){},addPatientUuid:function(e){},removePatientUuid:function(e){},goToReview:function(){},destroySession:function(){},closeSession:function(){}},I={activeFormUuid:null,forms:{},workflowState:null,activePatientUuid:null,activeEncounterUuid:null,activeVisitUuid:null,patientUuids:[],encounters:{},visits:{},activeGroupUuid:null,activeGroupName:null,activeGroupMembers:[],activeSessionMeta:{sessionName:null,practitionerName:null,sessionDate:null,sessionNotes:null},groupVisitTypeUuid:null,userUuid:null},j=o().createContext(C({},I,k)),U=function(e){var t,r,i,s,l,c,u,d,m,_,p,f,y,h,g,v,b,E,w,S,O,A,U,R,G,M,D,F,z,Z,B,L,V,W,q,K,Q,X,H=e.children,$=(0,n.useSession)().user,J=(0,x.useParams)().formUuid.split("&")[0],Y=(0,T.Z)("@openmrs/esm-fast-data-entry-app.groupSessionVisitTypeUuid"),ee=null==Y||null===(t=Y.result)||void 0===t||null===(r=t.data)||void 0===r||null===(i=r.results)||void 0===i||null===(s=i[0])||void 0===s?void 0:s.value,te=(q=(0,a.useReducer)(N.ZP,C({},I,k)),K=2,function(e){if(Array.isArray(e))return e}(q)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(q,K)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?P(e,t):void 0}}(q,K)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),re=te[0],ne=te[1],ae=(0,a.useMemo)((function(){return{initializeWorkflowState:function(e){var t=e.activeFormUuid;return ne({type:"INITIALIZE_WORKFLOW_STATE",activeFormUuid:t,userUuid:$.uuid})},setGroup:function(e){return ne({type:"SET_GROUP",group:e})},unsetGroup:function(){return ne({type:"UNSET_GROUP"})},setSessionMeta:function(e){return ne({type:"SET_SESSION_META",meta:e})},addPatientUuid:function(e){return ne({type:"ADD_PATIENT_UUID",patientUuid:e})},removePatientUuid:function(e){return ne({type:"REMOVE_PATIENT_UUID",patientUuid:e})},openPatientSearch:function(){return ne({type:"OPEN_PATIENT_SEARCH"})},saveEncounter:function(e){return ne({type:"SAVE_ENCOUNTER",encounterUuid:e})},validateForNext:function(){return ne({type:"VALIDATE_FOR_NEXT"})},validateForComplete:function(){return ne({type:"VALIDATE_FOR_COMPLETE"})},updateVisitUuid:function(e){return ne({type:"UPDATE_VISIT_UUID",visitUuid:e})},submitForNext:function(e){return ne({type:"SUBMIT_FOR_NEXT",nextPatientUuid:e})},submitForComplete:function(){return ne({type:"SUBMIT_FOR_COMPLETE"})},editEncounter:function(e){return ne({type:"EDIT_ENCOUNTER",patientUuid:e})},goToReview:function(){return ne({type:"GO_TO_REVIEW"})},destroySession:function(){return ne({type:"DESTROY_SESSION"})},closeSession:function(){return ne({type:"CLOSE_SESSION"})}}}),[$]);return(0,a.useEffect)((function(){null===(null==re?void 0:re.workflowState)&&J&&ae.initializeWorkflowState({activeFormUuid:J})}),[J,null==re?void 0:re.workflowState,ae]),o().createElement(j.Provider,{value:(Q=C({groupVisitTypeUuid:ee},re,ae),X={workflowState:null!==(G=null===(l=re.forms)||void 0===l||null===(c=l[re.activeFormUuid])||void 0===c?void 0:c.workflowState)&&void 0!==G?G:I.workflowState,activePatientUuid:null!==(M=null===(u=re.forms)||void 0===u||null===(d=u[re.activeFormUuid])||void 0===d?void 0:d.activePatientUuid)&&void 0!==M?M:I.activePatientUuid,activeEncounterUuid:null!==(D=null===(m=re.forms)||void 0===m||null===(_=m[re.activeFormUuid])||void 0===_?void 0:_.activeEncounterUuid)&&void 0!==D?D:I.activeEncounterUuid,activeVisitUuid:null!==(F=null===(p=re.forms)||void 0===p||null===(f=p[re.activeFormUuid])||void 0===f?void 0:f.activeVisitUuid)&&void 0!==F?F:I.activeVisitUuid,patientUuids:null!==(z=null===(y=re.forms)||void 0===y||null===(h=y[re.activeFormUuid])||void 0===h?void 0:h.patientUuids)&&void 0!==z?z:I.patientUuids,encounters:null!==(Z=null===(g=re.forms)||void 0===g||null===(v=g[re.activeFormUuid])||void 0===v?void 0:v.encounters)&&void 0!==Z?Z:I.encounters,activeGroupUuid:null!==(B=null===(b=re.forms)||void 0===b||null===(E=b[re.activeFormUuid])||void 0===E?void 0:E.groupUuid)&&void 0!==B?B:I.activeGroupUuid,activeGroupName:null!==(L=null===(w=re.forms)||void 0===w||null===(S=w[re.activeFormUuid])||void 0===S?void 0:S.groupName)&&void 0!==L?L:I.activeGroupName,activeGroupMembers:null!==(V=null===(O=re.forms)||void 0===O||null===(A=O[re.activeFormUuid])||void 0===A?void 0:A.groupMembers)&&void 0!==V?V:I.activeGroupMembers,activeSessionMeta:null!==(W=null===(U=re.forms)||void 0===U||null===(R=U[re.activeFormUuid])||void 0===R?void 0:R.sessionMeta)&&void 0!==W?W:I.activeSessionMeta},X=null!=X?X:{},Object.getOwnPropertyDescriptors?Object.defineProperties(Q,Object.getOwnPropertyDescriptors(X)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(X)).forEach((function(e){Object.defineProperty(Q,e,Object.getOwnPropertyDescriptor(X,e))})),Q)},H)};const R=j,G=function(){var e=(0,a.useContext)(R),t=e.activeGroupName,r=e.activeGroupUuid,n=e.patientUuids,c=e.activeSessionMeta,u=e.unsetGroup,d=e.destroySession,m=(0,O.useTranslation)().t;return r?o().createElement("div",{className:S.container},o().createElement("div",{className:S.groupAvatar,role:"img"},o().createElement(s.zW,{size:48})),o().createElement("div",{className:S.groupInfoContent},o().createElement("div",{className:S.groupInfoRow},o().createElement("span",{className:S.groupName},t)),o().createElement("div",{className:S.groupInfoRow},o().createElement("span",null,n.length," ",m("members","members")))),(null==c?void 0:c.sessionNotes)&&o().createElement("div",{className:S.groupMeataContent},o().createElement("div",{className:"".concat(S.groupInfoRow," ").concat(S.sessionNotesLabel)},m("sessionNotes","Session Notes")),o().createElement("div",{className:S.groupInfoRow},c.sessionNotes)),o().createElement("span",{style:{flexGrow:1}}),o().createElement("span",null,o().createElement(i.Button,{kind:"ghost",onClick:function(){return u()}},m("changeGroup","Choose a different group")," ",o().createElement(l.x8,{size:20}))),o().createElement("span",null,o().createElement(i.Button,{kind:"ghost",onClick:function(){return d()}},m("cancel","Cancel")," ",o().createElement(l.x8,{size:20})))):null};var M=r(7159),D={};D.styleTagTransform=b(),D.setAttributes=y(),D.insert=p().bind(null,"head"),D.domAPI=m(),D.insertStyleElement=g(),u()(M.Z,D);const F=M.Z&&M.Z.locals?M.Z.locals:void 0;var z=r(5443),Z={};Z.styleTagTransform=b(),Z.setAttributes=y(),Z.insert=p().bind(null,"head"),Z.domAPI=m(),Z.insertStyleElement=g(),u()(z.Z,Z);const B=z.Z&&z.Z.locals?z.Z.locals:void 0;var L=r(68),V={};V.styleTagTransform=b(),V.setAttributes=y(),V.insert=p().bind(null,"head"),V.domAPI=m(),V.insertStyleElement=g(),u()(L.Z,V);const W=L.Z&&L.Z.locals?L.Z.locals:void 0;var q=r(9370),K={};K.styleTagTransform=b(),K.setAttributes=y(),K.insert=p().bind(null,"head"),K.domAPI=m(),K.insertStyleElement=g(),u()(q.Z,K);const Q=q.Z&&q.Z.locals?q.Z.locals:void 0;var X=r(2619),H=r(9423),$={};$.styleTagTransform=b(),$.setAttributes=y(),$.insert=p().bind(null,"head"),$.domAPI=m(),$.insertStyleElement=g(),u()(H.Z,$);const J=H.Z&&H.Z.locals?H.Z.locals:void 0;function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}const ee=function(e){var t,r,n=(t=(0,a.useState)(!1),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(t,r)||function(e,t){if(e){if("string"==typeof e)return Y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Y(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],i=n[1];return(0,a.useEffect)((function(){var t=function(t){t.key===e&&i(!0)},r=function(t){t.key===e&&i(!1)};return window.addEventListener("keydown",t),window.addEventListener("keyup",r),function(){window.removeEventListener("keydown",t),window.removeEventListener("keyup",r)}}),[e]),o};function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function re(){return re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},re.apply(this,arguments)}var ne=function(e,t){switch(t.type){case"arrowUp":return{selectedIndex:Math.max(e.selectedIndex-1,0)};case"arrowDown":return{selectedIndex:Math.min(e.selectedIndex+1,t.listLength-1)};case"select":return{selectedIndex:t.payload};default:return e}},ae={behavior:"smooth",block:"nearest"},oe=function(e){var t,r,n=e.index,i=e.selectGroupAction,l=e.group,c=e.dispatch,u=e.state,d=e.totalGroups,m=e.lastRef,_=(0,a.useRef)(null),p=(0,O.useTranslation)().t;return(0,a.useEffect)((function(){u.selectedIndex===d-1?m.current.scrollIntoView(ae):u.selectedIndex===n&&_.current.scrollIntoView(ae)}),[u,n,d,m]),o().createElement("div",{onClick:function(){c({type:"select",payload:n}),i(l)},className:"".concat(J.patientSearchResult," ").concat(n===u.selectedIndex&&J.patientSearchResultSelected),role:"button","aria-pressed":n===u.selectedIndex,tabIndex:0,ref:_},o().createElement("div",{className:J.patientAvatar,role:"img"},o().createElement(s.zW,{size:24})),o().createElement("div",null,o().createElement("h2",{className:J.patientName},l.name),o().createElement("p",{className:J.demographics},null!==(r=null===(t=l.cohortMembers)||void 0===t?void 0:t.length)&&void 0!==r?r:0," ",p("members","members"),o().createElement("span",{className:J.middot},"·")," ",l.description)))},ie=function(){return o().createElement("div",{className:J.patientSearchResult},o().createElement("div",{className:J.patientAvatar,role:"img"},o().createElement(i.SkeletonIcon,{style:{height:"3rem",width:"3rem"}})),o().createElement("div",null,o().createElement("h2",{className:J.patientName},o().createElement(i.SkeletonText,null)),o().createElement("span",{className:J.demographics},o().createElement(i.SkeletonIcon,null)," ",o().createElement("span",{className:J.middot},"·")," ",o().createElement(i.SkeletonIcon,null)," ",o().createElement("span",{className:J.middot},"·")," ",o().createElement(i.SkeletonIcon,null))))};const se=function(e){var t,r,n=e.groups,i=e.selectGroupAction,s=e.lastRef,l=ee("ArrowUp"),c=ee("ArrowDown"),u=ee("Enter"),d=(t=(0,a.useReducer)(ne,{selectedIndex:0}),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(t,r)||function(e,t){if(e){if("string"==typeof e)return te(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?te(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),m=d[0],_=d[1];return(0,a.useEffect)((function(){l&&_({type:"arrowUp"})}),[l]),(0,a.useEffect)((function(){c&&_({type:"arrowDown",listLength:n.length})}),[c,n.length]),(0,a.useEffect)((function(){u&&n.length&&i(n[m.selectedIndex])}),[u,i,n,m.selectedIndex]),o().createElement(o().Fragment,null,n.map((function(e,t){return o().createElement(oe,re({key:t,totalGroups:n.length},{lastRef:s,index:t,selectGroupAction:i,group:e,dispatch:_,state:m}))})))};var le=r(4593);function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ue(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function de(){return de=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},de.apply(this,arguments)}function me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ue(e,t,r[t])}))}return e}function _e(e,t){if(e){if("string"==typeof e)return ce(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ce(e,t):void 0}}var pe=function(e){var t,r,o,i,s,l,c,u,d,m,_,p,f,y,h,g,v;return t=me({baseUrl:"/ws/rest/v1/cohortm/cohort",resultsToFetch:10},de({},e)),o=t.baseUrl,i=t.searchTerm,s=t.parameters,c=void 0===(l=t.searching)||l,u=t.resultsToFetch,d=void 0===u?10:u,m=(0,a.useCallback)((function(e,t){var r;if(t&&!(null==t||null===(r=t.data)||void 0===r?void 0:r.links.some((function(e){return"next"===e.rel}))))return null;var n="".concat(o,"?q=").concat(i),a=me({totalCount:!0,limit:d},s);return Object.entries(a).forEach((function(e){var t,r,a=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(t,r)||_e(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=a[0],i=a[1];null!=i&&(n+="&".concat(o,"=").concat(i))})),e&&(n+="&startIndex=".concat(e*d)),n}),[o,i,s,d]),_=(0,le.ZP)(c?m:null,n.openmrsFetch),p=_.data,f=_.isValidating,y=_.setSize,h=_.error,g=_.size,v=(0,a.useMemo)((function(){var e,t,n,a,o,i;return{data:p?(e=[]).concat.apply(e,(i=null!==(r=null==p?void 0:p.map((function(e){var t;return null==e||null===(t=e.data)||void 0===t?void 0:t.results})))&&void 0!==r?r:[],function(e){if(Array.isArray(e))return ce(e)}(i)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(i)||_e(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())):null,isLoading:!p&&!h,error:h,hasMore:!!(null==p?void 0:p.length)&&!!(null===(t=p[p.length-1].data)||void 0===t||null===(n=t.links)||void 0===n?void 0:n.some((function(e){return"next"===e.rel}))),loadingNewData:f,setPage:y,currentPage:g,totalResults:null==p||null===(a=p[0])||void 0===a||null===(o=a.data)||void 0===o?void 0:o.totalCount}}),[p,f,h,y,g]),v};const fe=function(e){var t=e.query,r=void 0===t?"":t,n=e.selectGroupAction,s=(0,O.useTranslation)().t,l=pe({searchTerm:r,searching:!!r,parameters:{v:"full"}}),c=l.isLoading,u=l.data,d=l.error,m=l.loadingNewData,_=l.setPage,p=l.hasMore,f=l.totalResults,y=(0,a.useRef)(null),h=(0,a.useRef)(null),g=(0,a.useCallback)((function(e){m||(h.current&&h.current.disconnect(),h.current=new IntersectionObserver((function(e){e[0].isIntersecting&&p&&_((function(e){return e+1}))}),{threshold:.75}),e&&h.current.observe(e))}),[m,p,_]);return d?o().createElement("div",{className:Q.searchResults},o().createElement(i.Layer,null,o().createElement(i.Tile,{className:Q.emptySearchResultsTile},o().createElement(X.N,null),o().createElement("div",null,o().createElement("p",{className:Q.errorMessage},s("error","Error")),o().createElement("p",{className:Q.errorCopy},s("errorCopy","Sorry, there was an error. You can try to reload this page, or contact the site administrator and quote the error code above.")))))):c?o().createElement("div",{className:Q.searchResultsContainer},o().createElement(ie,null),o().createElement(ie,null),o().createElement(ie,null),o().createElement(ie,null),o().createElement(ie,null)):0===(null==u?void 0:u.length)?o().createElement("div",{className:Q.searchResults},o().createElement(i.Layer,null,o().createElement(i.Tile,{className:Q.emptySearchResultsTile},o().createElement(X.N,null),o().createElement("p",{className:Q.emptyResultText},s("noGroupsFoundMessage","Sorry, no groups have been found")),o().createElement("p",{className:Q.actionText},o().createElement("span",null,s("trySearchWithPatientUniqueID","Try searching with the cohort's description")),o().createElement("br",null),o().createElement("span",null,s("orLabelName","OR label name")))))):o().createElement("div",{className:Q.searchResultsContainer},o().createElement("div",{className:Q.searchResults,style:{maxHeight:"22rem"}},o().createElement("p",{className:Q.resultsText},f," ",s("searchResultsText","search result(s)")),o().createElement(se,{groups:u,selectGroupAction:n,lastRef:y}),o().createElement("div",{ref:y},o().createElement("div",{className:Q.lastItem,ref:g},p&&o().createElement(i.Loading,{withOverlay:!1,small:!0}),!p&&o().createElement("p",null,s("noMoreResults","End of search results"))))))};var ye=r(7518);function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return he(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?he(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const ve=function(e){var t=e.selectGroupAction,r=(0,O.useTranslation)().t,n=ge((0,a.useState)(""),2),s=n[0],l=n[1],c=ge((0,a.useState)(!1),2),u=c[0],d=c[1];return o().createElement("div",{className:W.patientSearchBar},o().createElement("div",{className:W.searchArea},o().createElement(i.Search,{autoFocus:!0,className:W.patientSearchInput,closeButtonLabelText:r("clearSearch","Clear"),labelText:"",onChange:function(e){var t;t=e.target.value,(0,ye.Z)((function(e){d(!!t.length),l(e)}),300),l(t),t.length?d(!0):d(!1)},onClear:function(){},placeholder:r("searchForGroup","Search for a group by name"),size:"sm",value:s}),o().createElement(i.Button,{kind:"secondary",size:"sm"},r("search","Search"))),u&&o().createElement("div",{className:W.floatingSearchResultsContainer},o().createElement(fe,{query:s,selectGroupAction:function(e){t(e),d(!1),l("")}})))};var be=r(8808),Ee=r(8115),we=r(8034),Se={};Se.styleTagTransform=b(),Se.setAttributes=y(),Se.insert=p().bind(null,"head"),Se.domAPI=m(),Se.insertStyleElement=g(),u()(we.Z,Se);const Oe=we.Z&&we.Z.locals?we.Z.locals:void 0;var Ne=r(282);function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Te(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pe(){return Pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pe.apply(this,arguments)}function Ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Te(e,t,r[t])}))}return e}function Ce(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function ke(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(e,t)||Ie(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ie(e,t){if(e){if("string"==typeof e)return xe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xe(e,t):void 0}}var je=o().memo(n.ExtensionSlot),Ue=function(e){var t=e.patient,r=e.removePatient,n=(0,O.useTranslation)().t;return o().createElement("li",{key:t.uuid,className:Oe.patientRow},o().createElement("span",null,o().createElement(i.Button,{kind:"tertiary",size:"sm",hasIconOnly:!0,onClick:function(){return r(t.uuid)},renderIcon:be.ZN,tooltipAlignment:"start",tooltipPosition:"top",iconDescription:n("remove","Remove")})),o().createElement("span",{className:Oe.patientName},null==t?void 0:t.display))},Re=function(e){var t=e.name,r=e.setName,n=e.patientList,a=e.updatePatientList,s=e.errors,l=e.validate,c=e.removePatient,u=(0,O.useTranslation)().t;return o().createElement("div",{style:{display:"flex",flexDirection:"column",rowGap:"1rem"}},o().createElement(i.TextInput,{labelText:u("newGroupName","New Group Name"),value:t,onChange:function(e){return r(e.target.value)},onBlur:function(){return l("name")}}),(null==s?void 0:s.name)&&o().createElement("p",{className:Oe.formError},"required"===s.name?u("groupNameError","Please enter a group name."):s.name),o().createElement(i.FormLabel,null,n.length," ",u("patientsInGroup","Patients in group")),(null==s?void 0:s.patientList)&&o().createElement("p",{className:Oe.formError},u("noPatientError","Please enter at least one patient.")),!(null==s?void 0:s.patientList)&&o().createElement("ul",{className:Oe.patientList},null==n?void 0:n.map((function(e,t){return o().createElement(Ue,{patient:e,removePatient:c,key:t})}))),o().createElement(i.FormLabel,null,"Search for patients to add to group"),o().createElement("div",{className:Oe.searchBar},o().createElement(je,{extensionSlotName:"patient-search-bar-slot",state:{selectPatientAction:a,buttonProps:{kind:"secondary"}}})))};const Ge=function(){var e=(0,a.useContext)(R).setGroup,t=(0,O.useTranslation)().t,r=ke((0,a.useState)(!1),2),s=r[0],l=r[1],c=ke((0,a.useState)({}),2),u=c[0],d=c[1],m=ke((0,a.useState)(""),2),_=m[0],p=m[1],f=ke((0,a.useState)([]),2),y=f[0],h=f[1],g=(0,Ne.zg)(),v=g.post,b=g.result,E=g.isPosting,w=g.error,S=(0,a.useCallback)((function(e){return h((function(t){return t.filter((function(t){return t.uuid!==e}))}))}),[h]),N=(0,a.useCallback)((function(e){var t=!0;return e?(t="name"===e?!!_:!!y.length,d((function(r){return Ce(Ae({},r),Te({},e,t?null:"required"))}))):(_?d((function(e){return Ce(Ae({},e),{name:null})})):(d((function(e){return Ce(Ae({},e),{name:"required"})})),t=!1),y.length?d((function(e){return Ce(Ae({},e),{patientList:null})})):(d((function(e){return Ce(Ae({},e),{patientList:"required"})})),t=!1)),t}),[_,y.length]),x=(0,a.useCallback)((function(e){h((function(t){return t.find((function(t){return t.uuid===e.uuid}))?t:(r=t,function(e){if(Array.isArray(e))return xe(e)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||Ie(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([e]);var r})),d((function(e){return Ce(Ae({},e),{patientList:null})}))}),[h]);return(0,a.useEffect)((function(){b&&e(Ce(Ae({},b),{cohortMembers:y.map((function(e){return{patient:{uuid:e.uuid}}}))}))}),[b,e,y]),(0,a.useEffect)((function(){var e;w&&((0,n.showToast)({kind:"error",title:t("postError","POST Error"),description:null!==(e=w.message)&&void 0!==e?e:t("unknownPostError","An unknown error occured while saving data")}),w.fieldErrors&&d(Object.fromEntries(Object.entries(w.fieldErrors).map((function(e){var t,r=ke(e,2),n=r[0],a=r[1];return[n,null==a||null===(t=a[0])||void 0===t?void 0:t.message]})))))}),[w,t]),o().createElement("div",{className:Oe.modal},o().createElement(i.Button,{onClick:function(){return l(!0)},renderIcon:Ee.mm,iconDescription:"Add"},t("createNewGroup","Create New Group")),o().createElement(i.ComposedModal,{open:s,onClose:function(){return l(!1)}},o().createElement(i.ModalHeader,null,t("createNewGroup","Create New Group")),o().createElement(i.ModalBody,null,b?o().createElement("p",null,"Group saved succesfully"):E?o().createElement("div",{className:Oe.loading},o().createElement(i.Loading,{withOverlay:!1}),o().createElement("span",null,"Saving new group...")):o().createElement(Re,Pe({},{name:_,setName:p,patientList:y,updatePatientList:x,errors:u,validate:N,removePatient:S}))),o().createElement(i.ModalFooter,null,o().createElement(i.Button,{kind:"secondary",onClick:function(){l(!1)},disabled:E},t("cancel","Cancel")),o().createElement(i.Button,{kind:"primary",onClick:function(){N()&&v({name:_,cohortMembers:y.map((function(e){return{patient:e.uuid}}))})},disabled:E},t("createGroup","Create Group")))))},Me=function(){var e=(0,O.useTranslation)().t,t=(0,a.useContext)(R),r=t.activeGroupUuid,n=t.setGroup,s=t.destroySession;return r?null:o().createElement("div",{className:B.searchHeaderContainer},o().createElement("span",{className:B.padded},e("findGroup","Find group"),":"),o().createElement("span",{className:B.searchBarWrapper},o().createElement(ve,{selectGroupAction:function(e){n(e)}})),o().createElement("span",{className:B.padded},e("or","or")),o().createElement("span",null,o().createElement(Ge,null)),o().createElement("span",{style:{flexGrow:1}}),o().createElement("span",null,o().createElement(i.Button,{kind:"ghost",onClick:function(){s()}},e("cancel","Cancel")," ",o().createElement(l.x8,{size:20}))))};var De=r(7536),Fe=r(4211);function ze(){return ze=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ze.apply(this,arguments)}var Ze=function(e){var t,r,n,s,l,c,u,d=e.patientUuid,m=(0,Ne.Eu)(d),_=(0,a.useContext)(R),p=_.patientUuids,f=_.addPatientUuid,y=_.removePatientUuid,h=null==m||null===(t=m.name)||void 0===t||null===(r=t[0])||void 0===r||null===(n=r.given)||void 0===n?void 0:n[0],g=null==m||null===(s=m.name)||void 0===s||null===(l=s[0])||void 0===l?void 0:l.family,v=null==m||null===(c=m.identifier)||void 0===c||null===(u=c[0])||void 0===u?void 0:u.value;return m?o().createElement(i.TableRow,null,o().createElement(i.TableCell,null,m.display||m.displayName||[h,g].join(" ")),o().createElement(i.TableCell,null,v),o().createElement(i.TableCell,null,o().createElement(i.Checkbox,{checked:p.includes(d),labelText:d,hideLabel:!0,id:"".concat(v,"-attendance-checkbox"),onChange:function(e,t){t.checked?f(d):y(d)}}))):o().createElement(i.TableRow,null,o().createElement(i.TableCell,null,o().createElement(i.SkeletonText,null)),o().createElement(i.TableCell,null,o().createElement(i.SkeletonText,null)),o().createElement(i.TableCell,null,o().createElement(i.Checkbox,{diabled:!0})))};const Be=function(){var e=(0,O.useTranslation)().t,t=(0,a.useContext)(R),r=t.activeGroupUuid,n=t.activeGroupMembers,s=[e("name","Name"),e("identifier","Patient ID"),e("patientIsPresent","Patient is present")];return r?o().createElement(i.Table,null,o().createElement(i.TableHead,null,o().createElement(i.TableRow,null,s.map((function(e,t){return o().createElement(i.TableHeader,{key:t},e)})))),o().createElement(i.TableBody,null,n.map((function(e,t){return o().createElement(Ze,ze({},{patientUuid:e},{key:t}))})))):o().createElement("div",null,e("selectGroupFirst","Please select a group first"))};function Le(){return Le=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Le.apply(this,arguments)}const Ve=function(){var e=(0,O.useTranslation)().t,t=(0,De.Gc)(),r=t.register,n=t.formState.errors,a=t.control;return o().createElement("div",{className:F.formSection},o().createElement("h4",null,e("sessionDetails","1. Session details")),o().createElement("div",null,o().createElement("p",null,e("allFieldsRequired","All fields are required unless marked optional"))),o().createElement(i.Layer,null,o().createElement(i.Tile,{className:F.formSectionTile},o().createElement(i.Layer,null,o().createElement("div",{style:{display:"flex",flexDirection:"column",rowGap:"1.5rem"}},o().createElement(i.TextInput,Le({id:"text",type:"text",labelText:e("sessionName","Session Name")},r("sessionName",{required:!0}),{invalid:n.sessionName,invalidText:"This field is required"})),o().createElement(i.TextInput,Le({id:"text",type:"text",labelText:e("practitionerName","Practitioner Name")},r("practitionerName",{required:!0}),{invalid:n.practitionerName,invalidText:"This field is required"})),o().createElement(De.Qr,{name:"sessionDate",control:a,rules:{required:!0},render:function(t){var r=t.field;return o().createElement(i.DatePicker,Le({datePickerType:"single",size:"md",maxDate:new Date},r),o().createElement(i.DatePickerInput,{id:"session-date",labelText:e("sessionDate","Session Date"),placeholder:"mm/dd/yyyy",size:"md",invalid:n.sessionDate,invalidText:"This field is required"}))}}),o().createElement(i.TextArea,Le({id:"text",type:"text",labelText:e("sessionNotes","Session Notes")},r("sessionNotes",{required:!0}),{invalid:n.sessionNotes,invalidText:"This field is required"})))))),o().createElement("h4",null,e("sessionParticipants","2. Session participants")),o().createElement("div",null,o().createElement("p",null,e("markAbsentPatients","The patients in this group. Patients that are not present in the session should be marked as absent."))),o().createElement(i.Layer,null,o().createElement(i.Tile,{className:F.formSectionTile},o().createElement(i.Layer,null,o().createElement("div",{style:{display:"flex",flexDirection:"column",rowGap:"1.5rem"}},o().createElement(Be,null))))))};function We(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ke(){return Ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ke.apply(this,arguments)}var Qe=function(){var e,t,r=(0,O.useTranslation)().t,n=(0,a.useContext)(R),s=n.workflowState,l=n.patientUuids,c=(e=(0,a.useState)(!1),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return We(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?We(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=c[0],d=c[1];return"NEW_GROUP_SESSION"!==s?null:o().createElement(o().Fragment,null,o().createElement("div",{className:F.rightPanelActionButtons},o().createElement(i.Button,{kind:"secondary",type:"submit",disabled:!l.length},r("createNewSession","Create New Session")),o().createElement(i.Button,{kind:"tertiary",onClick:function(){d(!0)}},r("cancel","Cancel"))),o().createElement(Fe.Z,{open:u,setOpen:d,context:n}))},Xe=function(){var e=(0,O.useTranslation)().t,t=(0,De.Gc)(),r=t.register,n=t.formState.errors,i=t.setValue,s=(0,a.useContext)(R).activeGroupUuid;return(0,a.useEffect)((function(){s&&i("groupUuid",s)}),[s,i]),o().createElement(o().Fragment,null,o().createElement("input",Ke({hidden:!0},r("groupUuid",{value:s,required:e("chooseGroupError","Please choose a group.")}))),n.groupUuid&&!s&&o().createElement("div",{className:F.formError},n.groupUuid.message))};const He=function(){var e=(0,O.useTranslation)().t,t=(0,a.useContext)(R),r=t.setSessionMeta,n=t.workflowState,i=(0,De.cI)();return"NEW_GROUP_SESSION"!==n?null:o().createElement(De.RV,Ke({},i),o().createElement("form",{onSubmit:i.handleSubmit((function(e){var t,n,a=e.sessionDate,o=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,["sessionDate"]);r((t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){qe(e,t,r[t])}))}return e}({},o),n=null!=(n={sessionDate:a[0]})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t))}))},o().createElement("div",{className:F.workspace},o().createElement("div",{className:F.formMainContent},o().createElement("div",{className:F.formContainer},o().createElement(Ve,null)),o().createElement("div",{className:F.rightPanel},o().createElement("h4",null,e("newGroupSession","New Group Session")),o().createElement(Xe,null),o().createElement("hr",{style:{width:"100%"}}),o().createElement(Qe,null))))))};var $e=r(1671),Je=r(611),Ye=r(9688),et=r(2223);function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nt(){return nt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nt.apply(this,arguments)}function at(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){rt(e,t,r[t])}))}return e}function ot(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function it(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return tt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var st=(0,n.getGlobalStore)("ampath-form-state"),lt=function(){var e=(0,a.useContext)(R),t=e.activeFormUuid,r=e.submitForNext,s=e.patientUuids,l=e.activePatientUuid,c=e.workflowState,u=(0,n.useStore)(st)[t],d=("ready"!==u||"EDIT_FORM"!==c)&&"readyWithValidationErrors"!==u,m=it((0,a.useState)(!1),2),_=m[0],p=m[1],f=it((0,a.useState)(!1),2),y=f[0],h=f[1],g=(0,O.useTranslation)().t,v=l===s[s.length-1];return o().createElement(o().Fragment,null,o().createElement("div",{className:F.rightPanelActionButtons},o().createElement(i.Button,{kind:"primary",onClick:function(){"EDIT_FORM"!==c&&"readyWithValidationErrors"!==u||r()},disabled:d},v?g("saveForm","Save Form"):g("nextPatient","Next Patient")),o().createElement(i.Button,{kind:"secondary",onClick:function(){return h(!0)}},g("saveAndComplete","Save & Complete")),o().createElement(i.Button,{kind:"tertiary",onClick:function(){return p(!0)}},g("cancel","Cancel"))),o().createElement(Fe.Z,{open:_,setOpen:p,context:e}),o().createElement(et.Z,{open:y,setOpen:h,context:e,validateFirst:!1}))};const ct=function(){var e=(0,n.useConfig)().groupSessionConcepts,t=(0,O.useTranslation)().t,r=(0,a.useContext)(R),i=r.patientUuids,s=r.activePatientUuid,l=r.encounters,c=r.activeEncounterUuid,u=r.activeVisitUuid,d=r.activeFormUuid,m=r.saveEncounter,_=r.activeSessionMeta,p=r.groupVisitTypeUuid,f=r.updateVisitUuid,y=r.submitForNext,h=r.workflowState,g=(0,n.useSession)().sessionLocation,v=it((0,a.useState)(null),2),b=v[0],E=v[1],w=it((0,a.useState)(null),2),S=w[0],N=w[1],x=(0,Ye.Z)({showSuccessNotification:!1,showErrorNotification:!0}),T=x.saveVisit,P=x.updateEncounter,A=x.success;(0,a.useEffect)((function(){A&&A.data.patient.uuid===s&&(N(A.data),f(A.data.uuid))}),[A,f,u,s,S,N]);var C=(0,a.useCallback)((function(t){u||T({patientUuid:s,startDatetime:_.sessionDate,stopDatetime:_.sessionDate,visitType:p,location:null==g?void 0:g.uuid});var r=new Date(_.sessionDate);t.obs.forEach((function(e,n){var a;t.obs[n]=ot(at({},e),{groupMembers:null===(a=e.groupMembers)||void 0===a?void 0:a.map((function(e){return ot(at({},e),{obsDatetime:r.toISOString()})})),obsDatetime:r.toISOString()})})),u||Object.entries(e).forEach((function(e){var r=it(e,2),n=r[0],a=r[1];t.obs.push({concept:a,value:null==_?void 0:_[n]})})),t.location=null==g?void 0:g.uuid,t.encounterDatetime=r.toISOString()}),[s,u,_,e,p,T,g]);(0,a.useEffect)((function(){var e,t;b&&S&&(null===(e=b.patient)||void 0===e?void 0:e.uuid)===(null===(t=S.patient)||void 0===t?void 0:t.uuid)&&P({uuid:b.uuid,visit:S.uuid})}),[b,P,S]);var k=(0,a.useCallback)((function(e){e&&e.uuid&&(m(e.uuid),E(e))}),[m]),I=(0,a.useCallback)((function(e){y(e)}),[y]);return"NEW_GROUP_SESSION"===h?null:o().createElement("div",{className:F.workspace},o().createElement("div",{className:F.formMainContent},o().createElement("div",{className:F.formContainer},o().createElement(Je.Z,nt({patientUuid:s,encounterUuid:c},{formUuid:d,handlePostResponse:k,handleEncounterCreate:C}))),o().createElement("div",{className:F.rightPanel},o().createElement("h4",null,t("formsFilled","Forms filled")),o().createElement("div",{className:F.patientCardsSection},null==i?void 0:i.map((function(e){return o().createElement($e.Z,nt({key:e},{patientUuid:e,activePatientUuid:s,editEncounter:I,encounters:l}))}))),o().createElement(lt,null))))},ut=function(){return o().createElement(U,null,o().createElement("div",{className:F.breadcrumbsContainer},o().createElement(n.ExtensionSlot,{extensionSlotName:"breadcrumbs-slot"})),o().createElement(Me,null),o().createElement(G,null),o().createElement("div",{className:F.workspaceWrapper},o().createElement(He,null),o().createElement(ct,null)))}},8034:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(3645),a=r.n(n)()((function(e){return e[1]}));a.push([e.id,'.-esm-fast-data-entry__styles__modal___xdlE9 .cds--modal{z-index:90}.-esm-fast-data-entry__styles__modal___xdlE9 .cds--modal-container{height:600px}.-esm-fast-data-entry__styles__modal___xdlE9 .cds--modal-content{height:100%}.-esm-fast-data-entry__styles__searchBar___eK\\+Us>div>div>div{width:100%}.-esm-fast-data-entry__styles__formError___0VO-V{color:red}.-esm-fast-data-entry__styles__patientRow___tNveQ{display:flex;align-items:center;width:"100%"}.-esm-fast-data-entry__styles__patientRow___tNveQ:nth-child(odd){background-color:#e0e0e0}.-esm-fast-data-entry__styles__patientName___1dVPc{flex-grow:1;padding-left:1rem}.-esm-fast-data-entry__styles__loading___Iz1NP{display:flex;height:100%;flex-direction:column;justify-content:center;align-items:center;row-gap:1rem}',""]),a.locals={modal:"-esm-fast-data-entry__styles__modal___xdlE9",searchBar:"-esm-fast-data-entry__styles__searchBar___eK+Us",formError:"-esm-fast-data-entry__styles__formError___0VO-V",patientRow:"-esm-fast-data-entry__styles__patientRow___tNveQ",patientName:"-esm-fast-data-entry__styles__patientName___1dVPc",loading:"-esm-fast-data-entry__styles__loading___Iz1NP"};const o=a},8914:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(3645),a=r.n(n)()((function(e){return e[1]}));a.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-fast-data-entry__styles__container___9Vn3g{height:5rem;display:flex;align-items:center;background-color:#fff;border-top:.0125rem solid #e0e0e0;border-bottom:.0125rem solid #e0e0e0;padding:0 1rem}.-esm-fast-data-entry__styles__photoPlaceholder___mRAQO{height:3rem;width:3rem}.-esm-fast-data-entry__styles__groupAvatar___qCLlZ{width:3rem;height:3rem;margin:.5rem 1rem .5rem 0;border-radius:1px}.-esm-fast-data-entry__styles__groupName___XRVMQ{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0);font-weight:600}.-esm-fast-data-entry__styles__groupInfoContent___GMqli{margin-left:1rem;margin-right:4rem}.-esm-fast-data-entry__styles__groupInfoRow___WXABV{display:flex;align-items:center;font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0);color:#525252;column-gap:.8rem}.-esm-fast-data-entry__styles__groupInfoRow___WXABV>button{min-height:2rem}.-esm-fast-data-entry__styles__sessionNotesLabel___eE69Z{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px);margin-bottom:.125rem}.-esm-fast-data-entry__styles__groupEditBtn___dagwZ{color:#161616;margin:.5rem}.-esm-fast-data-entry__styles__groupMetaContent___OMT76{flex-grow:1}",""]),a.locals={container:"-esm-fast-data-entry__styles__container___9Vn3g",photoPlaceholder:"-esm-fast-data-entry__styles__photoPlaceholder___mRAQO",groupAvatar:"-esm-fast-data-entry__styles__groupAvatar___qCLlZ",groupName:"-esm-fast-data-entry__styles__groupName___XRVMQ",groupInfoContent:"-esm-fast-data-entry__styles__groupInfoContent___GMqli",groupInfoRow:"-esm-fast-data-entry__styles__groupInfoRow___WXABV",sessionNotesLabel:"-esm-fast-data-entry__styles__sessionNotesLabel___eE69Z",groupEditBtn:"-esm-fast-data-entry__styles__groupEditBtn___dagwZ",groupMetaContent:"-esm-fast-data-entry__styles__groupMetaContent___OMT76"};const o=a},5443:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(3645),a=r.n(n)()((function(e){return e[1]}));a.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-fast-data-entry__styles__searchHeaderContainer___3ZMXh{height:5rem;display:flex;align-items:center;background-color:#fff;border-top:.0125rem solid #e0e0e0;border-bottom:.0125rem solid #e0e0e0;padding:0 1rem}.-esm-fast-data-entry__styles__searchBarWrapper___dRAl4{min-width:35rem}.-esm-fast-data-entry__styles__padded___8E3A9{padding:1rem}",""]),a.locals={searchHeaderContainer:"-esm-fast-data-entry__styles__searchHeaderContainer___3ZMXh",searchBarWrapper:"-esm-fast-data-entry__styles__searchBarWrapper___dRAl4",padded:"-esm-fast-data-entry__styles__padded___8E3A9"};const o=a},9423:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(3645),a=r.n(n)()((function(e){return e[1]}));a.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-fast-data-entry__compact-group-result__patientSearchResult___i7AGA{text-decoration:none;display:flex;align-items:center;border-bottom:1px solid #e0e0e0;padding:0 .75rem}.-esm-fast-data-entry__compact-group-result__patientSearchResult___i7AGA:hover,.-esm-fast-data-entry__compact-group-result__patientSearchResult___i7AGA:focus{background-color:#f4f4f4}.-esm-fast-data-entry__compact-group-result__patientSearchResultSelected___NKBck{background-color:#e0e0e0}.-esm-fast-data-entry__compact-group-result__patientBanner___hohFI{display:flex}.-esm-fast-data-entry__compact-group-result__patientName___Bm1nd{font-size:var(--cds-heading-02-font-size, 1rem);font-weight:var(--cds-heading-02-font-weight, 600);line-height:var(--cds-heading-02-line-height, 1.5);letter-spacing:var(--cds-heading-02-letter-spacing, 0)}.-esm-fast-data-entry__compact-group-result__patientAvatar___ekNKL{width:3rem;height:3rem;margin:.5rem 1rem .5rem 0;border-radius:1px}.-esm-fast-data-entry__compact-group-result__patientInfo___aPztL{width:100%;display:flex;flex-flow:column wrap;margin:1rem;cursor:pointer}.-esm-fast-data-entry__compact-group-result__demographics___ZX2gk{margin-top:.5rem;font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0);color:#525252}.-esm-fast-data-entry__compact-group-result__identifiers___nO-LM{font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0);color:#8d8d8d}.-esm-fast-data-entry__compact-group-result__actionsContainer___GtQQe{padding-top:.5rem;margin-top:1rem}.-esm-fast-data-entry__compact-group-result__middot___K0huB{margin:0 .5rem}",""]),a.locals={patientSearchResult:"-esm-fast-data-entry__compact-group-result__patientSearchResult___i7AGA",patientSearchResultSelected:"-esm-fast-data-entry__compact-group-result__patientSearchResultSelected___NKBck",patientBanner:"-esm-fast-data-entry__compact-group-result__patientBanner___hohFI",patientName:"-esm-fast-data-entry__compact-group-result__patientName___Bm1nd",patientAvatar:"-esm-fast-data-entry__compact-group-result__patientAvatar___ekNKL",patientInfo:"-esm-fast-data-entry__compact-group-result__patientInfo___aPztL",demographics:"-esm-fast-data-entry__compact-group-result__demographics___ZX2gk",identifiers:"-esm-fast-data-entry__compact-group-result__identifiers___nO-LM",actionsContainer:"-esm-fast-data-entry__compact-group-result__actionsContainer___GtQQe",middot:"-esm-fast-data-entry__compact-group-result__middot___K0huB"};const o=a},68:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(3645),a=r.n(n)()((function(e){return e[1]}));a.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-fast-data-entry__compact-group-search__patientSearchBar___DDD\\+\\+{width:50vw;position:relative}.-esm-fast-data-entry__compact-group-search__floatingSearchResultsContainer___Qw-70{position:absolute;overflow-y:auto;box-shadow:0 .5rem 1rem #e0e0e0;z-index:99;border:0 1px 1px 1px solid #e0e0e0;width:100%;background-color:#fff}.-esm-fast-data-entry__compact-group-search__searchArea___\\+uJny{width:inherit;display:flex;justify-content:center;align-items:center;border:1px solid #8d8d8d}.-esm-fast-data-entry__compact-group-search__patientSearchInput___FLVTr{border:none}.-esm-fast-data-entry__compact-group-search__patientSearchInput___FLVTr input:focus{outline:1px solid 1px solid #ff832b}",""]),a.locals={patientSearchBar:"-esm-fast-data-entry__compact-group-search__patientSearchBar___DDD++",floatingSearchResultsContainer:"-esm-fast-data-entry__compact-group-search__floatingSearchResultsContainer___Qw-70",searchArea:"-esm-fast-data-entry__compact-group-search__searchArea___+uJny",patientSearchInput:"-esm-fast-data-entry__compact-group-search__patientSearchInput___FLVTr"};const o=a},9370:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(3645),a=r.n(n)()((function(e){return e[1]}));a.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-fast-data-entry__group-search__searchResultsContainer___o8N-5{width:100%;background-color:#fff}.-esm-fast-data-entry__group-search__searchResultsContainer___o8N-5 a{text-decoration:none;font-size:var(--cds-heading-02-font-size, 1rem);font-weight:var(--cds-heading-02-font-weight, 600);line-height:var(--cds-heading-02-line-height, 1.5);letter-spacing:var(--cds-heading-02-letter-spacing, 0);color:#525252;margin:0rem}.omrs-breakpoint-lt-desktop .-esm-fast-data-entry__group-search__searchResultsContainer___o8N-5{top:6.25rem}.omrs-breakpoint-gt-tablet .-esm-fast-data-entry__group-search__searchResultsContainer___o8N-5{padding:0;top:3rem}.-esm-fast-data-entry__group-search__searchResults___waz\\+y{width:100%}.-esm-fast-data-entry__group-search__searchTerm___nyCGc{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0);margin-top:.375rem}.-esm-fast-data-entry__group-search__resultsText___tut0N{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px);color:#525252;line-height:1rem;margin:.5rem 1rem}.-esm-fast-data-entry__group-search__helperText___DxXca{color:var(--omrs-color-ink-medium-contrast);margin-left:2.375rem}.-esm-fast-data-entry__group-search__emptyResultText___mWUlV{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px);color:#525252;margin-top:1rem;margin-bottom:.313rem}.-esm-fast-data-entry__group-search__actionText___pfkSN{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px);color:#525252}.-esm-fast-data-entry__group-search__pagination___RfffN{display:flex;justify-content:space-evenly;padding:4.688rem 0 1.5rem}.-esm-fast-data-entry__group-search__emptySearchResultsTile___JGNyK{text-align:center;margin-top:1rem;padding:3rem 0rem}.omrs-breakpoint-gt-tablet .-esm-fast-data-entry__group-search__emptySearchResultsTile___JGNyK{margin:1rem}.-esm-fast-data-entry__group-search__errorMessage___c4zp4{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);margin-top:2.25rem;margin-bottom:.5rem}.-esm-fast-data-entry__group-search__errorCopy___EjmNT{margin-bottom:.5rem;font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px);color:#525252}.-esm-fast-data-entry__group-search__lastItem___48nGL{padding:1rem;display:flex;justify-content:center;align-items:center}",""]),a.locals={searchResultsContainer:"-esm-fast-data-entry__group-search__searchResultsContainer___o8N-5",searchResults:"-esm-fast-data-entry__group-search__searchResults___waz+y",searchTerm:"-esm-fast-data-entry__group-search__searchTerm___nyCGc",resultsText:"-esm-fast-data-entry__group-search__resultsText___tut0N",helperText:"-esm-fast-data-entry__group-search__helperText___DxXca",emptyResultText:"-esm-fast-data-entry__group-search__emptyResultText___mWUlV",actionText:"-esm-fast-data-entry__group-search__actionText___pfkSN",pagination:"-esm-fast-data-entry__group-search__pagination___RfffN",emptySearchResultsTile:"-esm-fast-data-entry__group-search__emptySearchResultsTile___JGNyK",errorMessage:"-esm-fast-data-entry__group-search__errorMessage___c4zp4",errorCopy:"-esm-fast-data-entry__group-search__errorCopy___EjmNT",lastItem:"-esm-fast-data-entry__group-search__lastItem___48nGL"};const o=a},7159:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(3645),a=r.n(n)()((function(e){return e[1]}));a.push([e.id,':root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-fast-data-entry__styles__breadcrumbsContainer___sgb6T>div>div>nav{background-color:#fff;padding:.75rem 1rem;height:2.5rem}.-esm-fast-data-entry__styles__workspaceWrapper___KeE2D{display:flex;justify-content:center}.-esm-fast-data-entry__styles__workspace___e3uV4{width:1100px}.omrs-breakpoint-lt-large-desktop .-esm-fast-data-entry__styles__workspace___e3uV4{width:1000px}.omrs-breakpoint-lt-small-desktop .-esm-fast-data-entry__styles__workspace___e3uV4{width:100vw;padding:0 .75rem}.-esm-fast-data-entry__styles__selectPatientMessage___kmuRr{font-size:var(--cds-productive-heading-03-font-size, 1.25rem);font-weight:var(--cds-productive-heading-03-font-weight, 400);line-height:var(--cds-productive-heading-03-line-height, 1.4);letter-spacing:var(--cds-productive-heading-03-letter-spacing, 0);margin:2rem;text-align:center}.-esm-fast-data-entry__styles__formMainContent___l0zj8{display:flex;text-align:center;margin-top:1rem;column-gap:1rem}.-esm-fast-data-entry__styles__formContainer___cM3g8{flex-grow:1;max-height:calc(100vh - 14rem);overflow-y:scroll;text-align:left}.-esm-fast-data-entry__styles__formContainer___cM3g8 .cds--form-item .question-area{max-width:100%}.-esm-fast-data-entry__styles__rightPanel___iBUBP{min-width:13rem;text-align:left;overflow-y:scroll;display:flex;flex-direction:column;row-gap:1rem}.-esm-fast-data-entry__styles__patientCardsSection___2IKZo{margin:1rem 0;border-bottom:1px solid #f4f4f4}.-esm-fast-data-entry__styles__rightPanelActionButtons___P38yA{display:flex;flex-direction:column;row-gap:.5rem}.-esm-fast-data-entry__styles__rightPanelActionButtons___P38yA button{width:100%;text-decoration:"none"}.-esm-fast-data-entry__styles__formSection___XvWDb{display:flex;flex-direction:column;row-gap:1rem;justify-content:flex-start;align-items:flex-start;text-align:left}.-esm-fast-data-entry__styles__formSectionTile___Kv\\+-Q{width:500px}.-esm-fast-data-entry__styles__formError___ljPPl{font-size:var(--cds-helper-text-02-font-size, carbon--type-scale(2));font-weight:var(--cds-helper-text-02-font-weight, carbon--font-weight("regular"));line-height:var(--cds-helper-text-02-line-height, 1.28572);letter-spacing:var(--cds-helper-text-02-letter-spacing, 0.16px);color:#da1e28}',""]),a.locals={breadcrumbsContainer:"-esm-fast-data-entry__styles__breadcrumbsContainer___sgb6T",workspaceWrapper:"-esm-fast-data-entry__styles__workspaceWrapper___KeE2D",workspace:"-esm-fast-data-entry__styles__workspace___e3uV4",selectPatientMessage:"-esm-fast-data-entry__styles__selectPatientMessage___kmuRr",formMainContent:"-esm-fast-data-entry__styles__formMainContent___l0zj8",formContainer:"-esm-fast-data-entry__styles__formContainer___cM3g8",rightPanel:"-esm-fast-data-entry__styles__rightPanel___iBUBP",patientCardsSection:"-esm-fast-data-entry__styles__patientCardsSection___2IKZo",rightPanelActionButtons:"-esm-fast-data-entry__styles__rightPanelActionButtons___P38yA",formSection:"-esm-fast-data-entry__styles__formSection___XvWDb",formSectionTile:"-esm-fast-data-entry__styles__formSectionTile___Kv+-Q",formError:"-esm-fast-data-entry__styles__formError___ljPPl"};const o=a}}]);