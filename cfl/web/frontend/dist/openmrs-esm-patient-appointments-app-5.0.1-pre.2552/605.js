"use strict";(globalThis.webpackChunk_openmrs_esm_patient_appointments_app=globalThis.webpackChunk_openmrs_esm_patient_appointments_app||[]).push([[605],{8632:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(272),r=n.n(a),i=n(2609),o=n.n(i)()(r());o.push([e.id,".-esm-patient-appointments__appointments-form__formWrapper___iz2gN{display:flex;flex-direction:column;justify-content:space-between;height:calc(100vh - 6rem)}.omrs-breakpoint-lt-desktop .-esm-patient-appointments__appointments-form__formWrapper___iz2gN{background-color:#ededed}.omrs-breakpoint-gt-tablet .-esm-patient-appointments__appointments-form__formWrapper___iz2gN{background-color:#fff}.-esm-patient-appointments__appointments-form__formGroup___b4Yy3{display:flex;margin-bottom:.25rem;padding:1rem}.-esm-patient-appointments__appointments-form__formGroup___b4Yy3 checkbox{color:#525252;font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);margin-bottom:.5rem}.omrs-breakpoint-gt-tablet .-esm-patient-appointments__appointments-form__formGroup___b4Yy3{flex-direction:column}.omrs-breakpoint-lt-desktop .-esm-patient-appointments__appointments-form__formGroup___b4Yy3{flex-direction:row}.omrs-breakpoint-lt-desktop .-esm-patient-appointments__appointments-form__formGroup___b4Yy3 .-esm-patient-appointments__appointments-form__heading___Ed2wF{flex:1}.omrs-breakpoint-lt-desktop .-esm-patient-appointments__appointments-form__formGroup___b4Yy3 div{flex:3}.-esm-patient-appointments__appointments-form__heading___Ed2wF{color:#525252;font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);margin-bottom:.5rem}.-esm-patient-appointments__appointments-form__inputContainer____qljg{display:flex;flex-flow:row wrap;gap:1rem;align-items:center}.-esm-patient-appointments__appointments-form__button___O3yAG{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-patient-appointments__appointments-form__loader___ttBxR{display:flex;background-color:#ededed;justify-content:center;min-height:3rem;height:100vh}.-esm-patient-appointments__appointments-form__tablet___Wc5eL{padding:1.5rem 1rem;background-color:#fff}.-esm-patient-appointments__appointments-form__desktop___sbbCs{padding:0}.-esm-patient-appointments__appointments-form__weekSelect___hWfTY{max-inline-size:fit-content;padding-top:.5rem}.cds--select-input:focus{outline:2.5px solid #da1e28}.-esm-patient-appointments__appointments-form__errorMessage___as9Kl{font-size:var(--cds-label-02-font-size, 0.875rem);font-weight:var(--cds-label-02-font-weight, 400);line-height:var(--cds-label-02-line-height, 1.28572);letter-spacing:var(--cds-label-02-letter-spacing, 0.16px);color:#da1e28;margin-top:.5rem}.cds--number input[type=number]:focus{outline:2.5px solid #da1e28}","",{version:3,sources:["webpack://./src/appointments/appointments-form/appointments-form.scss","webpack://./../../node_modules/@carbon/colors/index.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAMA,mEACE,YAAA,CACA,qBAAA,CACA,6BAAA,CACA,yBAAA,CAGF,+FACE,wBAVwB,CAa1B,8FACE,qBCTM,CDYR,iEACE,YAAA,CACA,oBEPW,CFQX,YEOW,CFLX,0EACE,aCqBM,CE0xBN,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CH7yBA,mBERS,CFYb,4FACE,qBAAA,CAGF,6FACE,kBAAA,CAEA,4JACE,MAAA,CAGF,iGACE,MAAA,CAIJ,+DACE,aCFQ,CE0xBN,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CHtxBF,mBE/BW,CFkCb,sEACE,YAAA,CACA,kBAAA,CACA,QE3BW,CF4BX,kBAAA,CAGF,8DACE,WAAA,CACA,YAAA,CACA,wBAAA,CACA,oBAAA,CACA,aAAA,CAGF,8DACE,YAAA,CACA,wBApEwB,CAqExB,sBAAA,CACA,eEvBW,CFwBX,YAAA,CAGF,8DACE,mBAAA,CACA,qBCvEM,CD0ER,+DACE,SAAA,CAGF,kEACE,2BAAA,CACA,iBEpEW,CFuEb,yBACE,2BAAA,CAGF,oEG0uBI,iDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CHxuBJ,aCDS,CDET,gBAAA,CAGA,sCACE,2BAAA",sourceRoot:""}]),o.locals={formWrapper:"-esm-patient-appointments__appointments-form__formWrapper___iz2gN",formGroup:"-esm-patient-appointments__appointments-form__formGroup___b4Yy3",heading:"-esm-patient-appointments__appointments-form__heading___Ed2wF",inputContainer:"-esm-patient-appointments__appointments-form__inputContainer____qljg",button:"-esm-patient-appointments__appointments-form__button___O3yAG",loader:"-esm-patient-appointments__appointments-form__loader___ttBxR",tablet:"-esm-patient-appointments__appointments-form__tablet___Wc5eL",desktop:"-esm-patient-appointments__appointments-form__desktop___sbbCs",weekSelect:"-esm-patient-appointments__appointments-form__weekSelect___hWfTY",errorMessage:"-esm-patient-appointments__appointments-form__errorMessage___as9Kl"};const l=o},7605:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});var a=n(7900),r=n.n(a),i=n(4924),o=n(3565),l=n.n(o),s=n(2892),m=n(3955),u=n(8883),c=n(195),p=n(2870),d=n(4556),f=n(9318),A="dd/mm/yyyy",v="DD/MM/YYYY",_="d/m/Y",g=[{id:"MONDAY",label:"Monday",labelCode:"monday",order:0},{id:"TUESDAY",label:"Tuesday",labelCode:"tuesday",order:1},{id:"WEDNESDAY",label:"Wednesday",labelCode:"wednesday",order:2},{id:"THURSDAY",label:"Thursday",labelCode:"thursday",order:3},{id:"FRIDAY",label:"Friday",labelCode:"friday",order:4},{id:"SATURDAY",label:"Saturday",labelCode:"saturday",order:5},{id:"SUNDAY",label:"Sunday",labelCode:"sunday",order:6}],h=n(1354),b=n.n(h),E=n(1583),C=n.n(E),y=n(7378),D=n.n(y),T=n(5993),w=n.n(T),k=n(4154),x=n.n(k),S=n(8141),B=n.n(S),P=n(8632),F={};F.styleTagTransform=B(),F.setAttributes=w(),F.insert=D().bind(null,"head"),F.domAPI=C(),F.insertStyleElement=x(),b()(P.Z,F);const N=P.Z&&P.Z.locals?P.Z.locals:void 0;function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return W(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var z=[{name:"Scheduled"},{name:"WalkIn"}],M=c.z.object({duration:c.z.number(),location:c.z.string().refine((function(e){return""!==e})),appointmentNote:c.z.string(),appointmentType:c.z.string().refine((function(e){return""!==e})),selectedService:c.z.string().refine((function(e){return""!==e})),recurringPatternType:c.z.enum(["DAY","WEEK"]),recurringPatternPeriod:c.z.number(),recurringPatternDaysOfWeek:c.z.array(c.z.string()),selectedDaysOfWeekText:c.z.string().optional(),startTime:c.z.string(),timeFormat:c.z.enum(["AM","PM"]),appointmentDateTime:c.z.object({startDate:c.z.date(),startDateText:c.z.string(),recurringPatternEndDate:c.z.date().nullable(),recurringPatternEndDateText:c.z.string().nullable()})});function O(e){var t=e.children;return e.isTablet?r().createElement(s.mh4,null,t):r().createElement("div",null,t)}function G(e){var t,n=e.isTablet,a=e.t,i=(e.setValue,e.getValues,e.watch),o=e.control,l=e.services,u=(null==l||null===(t=l.find((function(e){return e.name===i("selectedService")})))||void 0===t?void 0:t.durationMins)||null;return r().createElement(r().Fragment,null,r().createElement(O,{isTablet:n},r().createElement(m.Qr,{name:"startTime",control:o,render:function(e){var t=e.field,n=t.onChange,i=t.value;return r().createElement(s.jII,{id:"time-picker",pattern:"([\\d]+:[\\d]{2})",onChange:function(e){return n(e.target.value)},value:i,style:{marginLeft:"0.125rem",flex:"none"},labelText:a("time","Time")},r().createElement(m.Qr,{name:"timeFormat",control:o,render:function(e){var t=e.field,n=t.value,i=t.onChange;return r().createElement(s.M6n,{id:"time-picker-select-1",onChange:function(e){return i(e.target.value)},value:n,"aria-label":a("time","Time")},r().createElement(s.QlF,{value:"AM",text:"AM"}),r().createElement(s.QlF,{value:"PM",text:"PM"}))}}))}})),r().createElement(O,{isTablet:n},r().createElement(m.Qr,{name:"duration",control:o,defaultValue:u,render:function(e){var t=e.field,n=t.onChange,i=t.onBlur,o=t.value,l=t.ref;return r().createElement(s.Y2U,{hideSteppers:!0,id:"duration",min:0,max:1440,label:a("durationInMinutes","Duration (minutes)"),invalidText:a("invalidNumber","Number is not valid"),size:"md",onBlur:i,onChange:function(e,t){return t.value,n(Number(e.target.value))},value:o,ref:l})}})))}const I=function(e){var t,n,o,c,h,b,E=e.appointment,C=e.recurringPattern,y=e.patientUuid,D=e.context,T=e.closeWorkspace,w=new Date(null==E?void 0:E.startDateTime).getHours()>=12?"PM":"AM",k=(null==E?void 0:E.startDateTime)?w:(new Date).getHours()>=12?"PM":"AM",x=(0,i.useTranslation)().t,S="tablet"===(0,p.useLayoutType)(),B=(0,p.useLocations)(),P=(0,p.useSession)(),F=(0,f.l9)(),W=F.data,I=F.isLoading,Q=Y((0,a.useState)(!1),2),j=Q[0],L=Q[1],U=(null==C?void 0:C.type)||"DAY",R=(null==C?void 0:C.period)||1,V=(null==C?void 0:C.daysOfWeek)||[],q=Y((0,a.useState)(!1),2),Z=q[0],H=q[1],K=(0,f.zt)(y,(new Date).toUTCString(),new AbortController).mutate,X=(null==E?void 0:E.startDateTime)?new Date(null==E?void 0:E.startDateTime):new Date,J=(null==C?void 0:C.endDate)?new Date(null==C?void 0:C.endDate):null,$=(null==C?void 0:C.endDate)?l()(new Date(C.endDate)).format(v):"",ee=(null==E?void 0:E.startDateTime)?l()(new Date(E.startDateTime)).format(v):l()(new Date).format(v),te=(null==E?void 0:E.startDateTime)?l()(new Date(null==E?void 0:E.startDateTime)).format("hh:mm"):l()(new Date).format("hh:mm"),ne=(0,m.cI)({mode:"all",resolver:(0,u.F)(M),defaultValues:{location:null!==(h=null!==(c=null==E||null===(t=E.location)||void 0===t?void 0:t.uuid)&&void 0!==c?c:null==P||null===(n=P.sessionLocation)||void 0===n?void 0:n.uuid)&&void 0!==h?h:"",appointmentNote:(null==E?void 0:E.comments)||"",appointmentType:(null==E?void 0:E.appointmentKind)||"",selectedService:(null==E||null===(o=E.service)||void 0===o?void 0:o.name)||"",recurringPatternType:U,recurringPatternPeriod:R,recurringPatternDaysOfWeek:V,startTime:te,timeFormat:k,appointmentDateTime:{startDate:X,startDateText:ee,recurringPatternEndDate:J,recurringPatternEndDateText:$}}}),ae=ne.control,re=ne.getValues,ie=ne.setValue,oe=ne.watch,le=ne.handleSubmit,se=(null===(b=re("recurringPatternDaysOfWeek"))||void 0===b?void 0:b.length)<1?x("daysOfWeek","Days of the week"):g.filter((function(e){return re("recurringPatternDaysOfWeek").includes(e.id)})).map((function(e){return e.label})).join(", "),me=function(e){var t=e.appointmentDateTime.recurringPatternEndDate,n=e.recurringPatternType,a=e.recurringPatternPeriod,r=e.recurringPatternDaysOfWeek,i=null==t?void 0:t.setHours(23,59);return{type:n,period:a,endDate:i?l()(i).format():null,daysOfWeek:r}};return I?r().createElement(s.lSo,{className:N.loader,description:"".concat(x("loading","Loading")," ..."),role:"progressbar"}):r().createElement(s.l09,{className:N.formWrapper},r().createElement(s.Kqy,{gap:4},r().createElement("section",{className:N.formGroup},r().createElement("span",{className:N.heading},x("location","Location")),r().createElement("div",null,r().createElement(O,{isTablet:S},r().createElement(m.Qr,{name:"location",control:ae,render:function(e){var t=e.field,n=t.onChange,a=t.value,i=t.onBlur,o=t.ref;return r().createElement(s.PhF,{id:"location",invalidText:"Required",labelText:x("selectLocation","Select a location"),onChange:n,onBlur:i,value:a,ref:o},r().createElement(s.QlF,{text:x("chooseLocation","Choose a location"),value:""}),(null==B?void 0:B.length)>0&&B.map((function(e){return r().createElement(s.QlF,{key:e.uuid,text:e.display,value:e.uuid},e.display)})))}})))),r().createElement("section",{className:N.formGroup},r().createElement("span",{className:N.heading},x("service","Service")),r().createElement(O,{isTablet:S},r().createElement(m.Qr,{name:"selectedService",control:ae,render:function(e){var t=e.field,n=t.onBlur,a=t.onChange,i=t.value,o=t.ref;return r().createElement(s.PhF,{id:"service",invalidText:"Required",labelText:x("selectService","Select a service"),onChange:function(e){var t;a(e),ie("duration",null==W||null===(t=W.find((function(t){return t.name===e.target.value})))||void 0===t?void 0:t.durationMins)},onBlur:n,value:i,ref:o},r().createElement(s.QlF,{text:x("chooseService","Select service"),value:""}),(null==W?void 0:W.length)>0&&W.map((function(e){return r().createElement(s.QlF,{key:e.uuid,text:e.name,value:e.name},e.name)})))}}))),r().createElement("section",{className:N.formGroup},r().createElement("span",{className:N.heading},x("appointmentType_title","Appointment Type")),r().createElement(O,{isTablet:S},r().createElement(m.Qr,{name:"appointmentType",control:ae,render:function(e){var t=e.field,n=t.onBlur,a=t.onChange,i=t.value,o=t.ref;return r().createElement(s.PhF,{disabled:!(null==z?void 0:z.length),id:"appointmentType",invalidText:"Required",labelText:x("selectAppointmentType","Select the type of appointment"),onChange:a,value:i,ref:o,onBlur:n},r().createElement(s.QlF,{text:x("chooseAppointmentType","Choose appointment type"),value:""}),(null==z?void 0:z.length)>0&&z.map((function(e,t){return r().createElement(s.QlF,{key:t,text:e.name,value:e.name},e.name)})))}}))),r().createElement("section",{className:N.formGroup},r().createElement("span",{className:N.heading},x("recurringAppointment","Recurring Appointment")),r().createElement(s.ZDl,{id:"recurringToggle",labelB:x("yes","Yes"),labelA:x("no","No"),labelText:x("isRecurringAppointment","Is this a recurring appoinment?"),onClick:function(){return L(!j)}})),r().createElement("section",{className:N.formGroup},r().createElement("span",{className:N.heading},x("dateTime","Date & Time")),r().createElement("div",null,j&&r().createElement("div",{className:N.inputContainer},r().createElement(O,{isTablet:S},r().createElement(m.Qr,{name:"appointmentDateTime",control:ae,render:function(e){var t=e.field,n=t.onChange,a=t.value,i=t.ref;return r().createElement(O,{isTablet:S},r().createElement(s.Mtg,{datePickerType:"range",dateFormat:_,value:[a.startDate,a.recurringPatternEndDate],ref:i,onChange:function(e){var t=Y(e,2),a=t[0],r=t[1];n({startDate:new Date(a),recurringPatternEndDate:new Date(r),recurringPatternEndDateText:l()(new Date(r)).format(v),startDateText:l()(new Date(a)).format(v)})}},r().createElement(s.aj6,{id:"startDatePickerInput",labelText:x("startDate","Start date"),style:{width:"100%"},value:oe("appointmentDateTime").startDateText}),r().createElement(s.aj6,{id:"endDatePickerInput",labelText:x("endDate","End date"),style:{width:"100%"},placeholder:A,value:oe("appointmentDateTime").recurringPatternEndDateText})))}})),r().createElement(G,{control:ae,isTablet:S,setValue:ie,getValues:re,services:W,watch:oe,t:x}),r().createElement(O,{isTablet:S},r().createElement(m.Qr,{name:"recurringPatternPeriod",control:ae,render:function(e){var t=e.field,n=t.onBlur,a=t.onChange,i=t.value;return r().createElement(s.Y2U,{hideSteppers:!0,id:"repeatNumber",min:1,max:356,label:x("repeatEvery","Repeat every"),invalidText:x("invalidNumber","Number is not valid"),size:"md",value:i,onBlur:n,onChange:function(e,t){t.value,a(Number(e.target.value))}})}})),r().createElement(O,{isTablet:S},r().createElement(m.Qr,{name:"recurringPatternType",control:ae,render:function(e){var t=e.field,n=t.onChange,a=t.value;return r().createElement(s.SYO,{legendText:x("period","Period"),name:"radio-button-group",onChange:function(e){return n(e)},valueSelected:a},r().createElement(s.EUY,{labelText:x("day","Day"),value:"DAY",id:"radioDay"}),r().createElement(s.EUY,{labelText:x("week","Week"),value:"WEEK",id:"radioWeek"}))}})),"WEEK"===oe("recurringPatternType")&&r().createElement("div",null,r().createElement(m.Qr,{name:"selectedDaysOfWeekText",control:ae,defaultValue:se,render:function(e){var t=e.field,n=t.onChange;return t.value,r().createElement(s.NUq,{className:N.weekSelect,label:re("selectedDaysOfWeekText"),id:"daysOfWeek",items:g,itemToString:function(e){return e?x(e.labelCode,e.label):""},selectionFeedback:"top-after-reopen",sortItems:function(e){return e.sort((function(e,t){return e.order>t.order}))},initialSelectedItems:g.filter((function(e){return re("recurringPatternDaysOfWeek").includes(e.id)})),onChange:function(e){n(e),function(e){var t;ie("selectedDaysOfWeekText",(null==e||null===(t=e.selectedItems)||void 0===t?void 0:t.length)<1?x("daysOfWeek","Days of the week"):e.selectedItems.map((function(e){return e.label})).join(", ")),ie("recurringPatternDaysOfWeek",e.selectedItems.map((function(e){return e.id})))}(e)}})}}))),!j&&r().createElement("div",{className:N.inputContainer},r().createElement(O,{isTablet:S},r().createElement(m.Qr,{name:"appointmentDateTime",control:ae,render:function(e){var t=e.field,n=t.onChange,a=t.value,i=t.ref;return r().createElement(s.Mtg,{datePickerType:"single",dateFormat:_,value:a.startDate,onChange:function(e){var t=Y(e,1)[0];return n({startDate:t})}},r().createElement(s.aj6,{id:"datePickerInput",labelText:x("date","Date"),style:{width:"100%"},placeholder:A,ref:i}))}})),r().createElement(G,{isTablet:S,control:ae,setValue:ie,getValues:re,services:W,watch:oe,t:x})))),r().createElement("section",{className:N.formGroup},r().createElement("span",{className:N.heading},x("note","Note")),r().createElement(m.Qr,{name:"appointmentNote",control:ae,render:function(e){var t=e.field,n=t.onChange,a=t.onBlur,i=t.value,o=t.ref;return r().createElement(O,{isTablet:S},r().createElement(s.Kx8,{id:"appointmentNote",value:i,labelText:x("appointmentNoteLabel","Write an additional note"),placeholder:x("appointmentNotePlaceholder","Write any additional points here"),onChange:n,onBlur:a,ref:o}))}}))),r().createElement(s.uVA,{className:S?N.tablet:N.desktop},r().createElement(s.zxk,{className:N.button,onClick:T,kind:"secondary"},x("discard","Discard")),r().createElement(s.zxk,{className:N.button,disabled:Z,onClick:le((function(e){H(!0);var t=function(e){var t,n,a=e.selectedService,r=e.startTime,i=e.timeFormat,o=e.appointmentDateTime.startDate,s=e.duration,m=e.appointmentType,u=e.location,c=e.appointmentNote,p=null==W||null===(t=W.find((function(e){return e.name===a})))||void 0===t?void 0:t.uuid,f=Y((0,d.convertTime12to24)(r,i),2),A=f[0],v=f[1],_=o.setHours(A,v),g=l()(_).add(s,"minutes").toDate();return{appointmentKind:m,serviceUuid:p,startDateTime:l()(_).format(),endDateTime:l()(g).format(),providerUuid:null==P||null===(n=P.currentProvider)||void 0===n?void 0:n.uuid,providers:[{uuid:P.currentProvider.uuid}],locationUuid:u,patientUuid:y,comments:c,uuid:"editing"===D?E.uuid:void 0}}(e),n={appointmentRequest:t,recurringPattern:me(e)},a=new AbortController;(j?(0,f.Ae)(n,a):(0,f.GB)(t,a)).then((function(e){var t=e.status;200===t&&(H(!1),T(),K(),(0,p.showToast)({critical:!0,kind:"success",description:x("appointmentNowVisible","It is now visible on the Appointments page"),title:"editing"===D?x("appointmentEdited","Appointment edited"):x("appointmentScheduled","Appointment scheduled")})),204===t&&(H(!1),(0,p.showNotification)({title:"editing"===D?x("appointmentEditError","Error editing appointment"):x("appointmentFormError","Error scheduling appointment"),kind:"error",critical:!0,description:x("noContent","No Content")}))}),(function(e){H(!1),(0,p.showNotification)({title:"editing"===D?x("appointmentEditError","Error editing appointment"):x("appointmentFormError","Error scheduling appointment"),kind:"error",critical:!0,description:null==e?void 0:e.message})}))}))},x("saveAndClose","Save and close"))))}},9318:(e,t,n)=>{n.d(t,{Ae:()=>f,GB:()=>d,l9:()=>p,v1:()=>_,zt:()=>c});var a=n(3565),r=n.n(a),i=n(3255),o=n(2870),l=n(6824),s=n.n(l);function m(e,t,n,a,r,i,o){try{var l=e[i](o),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(a,r)}r().extend(s());var u="/ws/rest/v1/appointments/search";function c(e,t,n){var a,l,s,m,c,p,d,f=(0,i.ZP)(u,(function(){return(0,o.openmrsFetch)(u,{method:"POST",signal:n.signal,headers:{"Content-Type":"application/json"},body:{patientUuid:e,startDate:t}})})),A=f.data,v=f.error,_=f.isLoading,g=f.isValidating,h=f.mutate,b=(null==A||null===(a=A.data)||void 0===a?void 0:a.length)?A.data:null,E=null==b||null===(s=b.sort((function(e,t){return t.startDateTime>e.startDateTime?1:-1})))||void 0===s||null===(l=s.filter((function(e){return"Cancelled"!==e.status})))||void 0===l?void 0:l.filter((function(e){var t=e.startDateTime;return r()(new Date(t).toISOString()).isBefore((new Date).setHours(0,0,0,0))})),C=null==b||null===(c=b.sort((function(e,t){return e.startDateTime>t.startDateTime?1:-1})))||void 0===c||null===(m=c.filter((function(e){return"Cancelled"!==e.status})))||void 0===m?void 0:m.filter((function(e){var t=e.startDateTime;return r()(new Date(t).toISOString()).isAfter(new Date)})),y=null==b||null===(d=b.sort((function(e,t){return e.startDateTime>t.startDateTime?1:-1})))||void 0===d||null===(p=d.filter((function(e){return"Cancelled"!==e.status})))||void 0===p?void 0:p.filter((function(e){var t=e.startDateTime;return r()(new Date(t).toISOString()).isToday()}));return{data:A?{pastAppointments:E,upcomingAppointments:C,todaysAppointments:y}:null,isError:v,isLoading:_,isValidating:g,mutate:h}}function p(){var e=(0,i.ZP)("/ws/rest/v1/appointmentService/all/full",o.openmrsFetch),t=e.data,n=e.error,a=e.isLoading;return{data:t?t.data:null,isError:n,isLoading:a}}function d(e,t){return(0,o.openmrsFetch)("/ws/rest/v1/appointment",{method:"POST",signal:t.signal,headers:{"Content-Type":"application/json"},body:e})}function f(e,t){return(0,o.openmrsFetch)("/ws/rest/v1/recurring-appointments",{method:"POST",signal:t.signal,headers:{"Content-Type":"application/json"},body:e})}var A,v,_=(A=function(e,t,n){var a,i,l;return function(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}(this,(function(n){switch(n.label){case 0:return a=Intl.DateTimeFormat().resolvedOptions().timeZone,i=r()(new Date).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),l="/ws/rest/v1/appointments/".concat(t,"/status-change"),[4,(0,o.openmrsFetch)(l,{body:{toStatus:e,onDate:i,timeZone:a},method:"POST",headers:{"Content-Type":"application/json"}})];case 1:return[2,n.sent()]}}))},v=function(){var e=this,t=arguments;return new Promise((function(n,a){var r=A.apply(e,t);function i(e){m(r,n,a,i,o,"next",e)}function o(e){m(r,n,a,i,o,"throw",e)}i(void 0)}))},function(e,t,n){return v.apply(this,arguments)})}}]);