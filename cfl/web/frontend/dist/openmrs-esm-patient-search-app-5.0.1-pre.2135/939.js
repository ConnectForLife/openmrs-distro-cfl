"use strict";(globalThis.webpackChunk_openmrs_esm_patient_search_app=globalThis.webpackChunk_openmrs_esm_patient_search_app||[]).push([[939],{1241:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(272),r=a.n(n),c=a(2609),o=a.n(c)()(r());o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-search__compact-patient-search__productiveHeading01___LwmIh{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px)}.-esm-patient-search__compact-patient-search__productiveHeading02___mh5WP{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0)}.-esm-patient-search__compact-patient-search__productiveHeading03___VglUL{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0)}.-esm-patient-search__compact-patient-search__bodyLong01___Plwdo{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}.-esm-patient-search__compact-patient-search__label01___I6BN0{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px)}.-esm-patient-search__compact-patient-search__bodyShort01___TUyjj{font-size:var(--cds-body-short-01-font-size, 0.875rem);font-weight:var(--cds-body-short-01-font-weight, 400);line-height:var(--cds-body-short-01-line-height, 1.28572);letter-spacing:var(--cds-body-short-01-letter-spacing, 0.16px)}.-esm-patient-search__compact-patient-search__patientSearchBar___wjh8_{width:50vw;position:relative}.-esm-patient-search__compact-patient-search__floatingSearchResultsContainer___u8w1c{position:absolute;overflow-y:auto;box-shadow:0 .5rem 1rem #e0e0e0;z-index:99;border:0 1px 1px 1px solid #e0e0e0;width:100%;background-color:#fff}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/root.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss","webpack://./src/compact-patient-search/compact-patient-search.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCpDF,0ECu0BI,2DAAA,CAAA,0DAAA,CAAA,8DAAA,CAAA,mEAAA,CDn0BJ,0ECm0BI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CD/zBJ,0EC+zBI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CD3zBJ,iEC2zBI,gDAAA,CAAA,+CAAA,CAAA,mDAAA,CAAA,wDAAA,CDvzBJ,8DCuzBI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CDnzBJ,kECmzBI,sDAAA,CAAA,qDAAA,CAAA,yDAAA,CAAA,8DAAA,CCv0BJ,uEACE,UAAA,CACA,iBAAA,CAGF,qFACE,iBAAA,CACA,eAAA,CACA,+BAAA,CACA,UAAA,CACA,kCAAA,CACA,UAAA,CACA,qBHdM",sourceRoot:""}]),o.locals={productiveHeading01:"-esm-patient-search__compact-patient-search__productiveHeading01___LwmIh",productiveHeading02:"-esm-patient-search__compact-patient-search__productiveHeading02___mh5WP",productiveHeading03:"-esm-patient-search__compact-patient-search__productiveHeading03___VglUL",bodyLong01:"-esm-patient-search__compact-patient-search__bodyLong01___Plwdo",label01:"-esm-patient-search__compact-patient-search__label01___I6BN0",bodyShort01:"-esm-patient-search__compact-patient-search__bodyShort01___TUyjj",patientSearchBar:"-esm-patient-search__compact-patient-search__patientSearchBar___wjh8_",floatingSearchResultsContainer:"-esm-patient-search__compact-patient-search__floatingSearchResultsContainer___u8w1c"};const s=o},654:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(272),r=a.n(n),c=a(2609),o=a.n(c)()(r());o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-search__patient-search-icon__patientSearchIconWrapper___Cu9qt{display:flex;justify-content:flex-end;align-items:center}.-esm-patient-search__patient-search-icon__searchIconButton___Q8tq4{background-color:#005d5d;background-color:var(--brand-01)}.-esm-patient-search__patient-search-icon__activeSearchIconButton___I88wY{background-color:#004144;background-color:var(--brand-02)}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/patient-search-icon/patient-search-icon.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCrDF,4EACE,YAAA,CACA,wBAAA,CACA,kBAAA,CAGF,oED8BE,wBAAA,CACA,gCAAA,CC3BF,0ED+BE,wBAAA,CACA,gCAAA",sourceRoot:""}]),o.locals={patientSearchIconWrapper:"-esm-patient-search__patient-search-icon__patientSearchIconWrapper___Cu9qt",searchIconButton:"-esm-patient-search__patient-search-icon__searchIconButton___Q8tq4",activeSearchIconButton:"-esm-patient-search__patient-search-icon__activeSearchIconButton___I88wY"};const s=o},1939:(e,t,a)=>{a.r(t),a.d(t,{default:()=>J});var n=a(5206),r=a.n(n),c=a(8744),o=a(4924),s=a(895),i=a(2074),l=a(37),u=a(2870),A=a(6110),h=a(7951),m=a(553),p=a(4171),d=a(9653),_=a(549),g=a(7108);function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}const v=r().forwardRef((function(e,t){var a,c=e.selectPatientAction,i=e.isLoading,l=e.data,u=e.fetchError,A=e.loadingNewData,h=e.setPage,m=e.hasMore,p=(0,o.useTranslation)().t,v=(0,n.useRef)(null),C=(0,n.useCallback)((function(e){A||(v.current&&v.current.disconnect(),v.current=new IntersectionObserver((function(e){e[0].isIntersecting&&m&&h((function(e){return e+1}))}),{threshold:.75}),e&&v.current.observe(e))}),[A,m,h]);return i?r().createElement("div",{className:g.Z.searchResultsContainer},(a=Array(5),function(e){if(Array.isArray(e))return f(e)}(a)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?f(e,t):void 0}}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(e,t){return r().createElement(_.x,{key:t})}))):u?r().createElement("div",{className:g.Z.searchResults},r().createElement(s.mh4,null,r().createElement(s.n9L,{className:g.Z.emptySearchResultsTile},r().createElement(d.Z,null),r().createElement("div",null,r().createElement("p",{className:g.Z.errorMessage},p("error","Error")),r().createElement("p",{className:g.Z.errorCopy},p("errorCopy","Sorry, there was an error. You can try to reload this page, or contact the site administrator and quote the error code above.")))))):(null==l?void 0:l.length)?r().createElement("div",{className:g.Z.searchResultsContainer},r().createElement("div",{className:g.Z.searchResults},r().createElement("p",{className:g.Z.resultsText},p("recentSearchResultsCount","{count} recent search result{plural}",{count:l.length,plural:0===l.length||l.length>1?"s":""})),r().createElement(_.Z,{patients:l,selectPatientAction:c,ref:t}),m&&r().createElement("div",{className:g.Z.loadingIcon,ref:C},r().createElement(s.gbz,{withOverlay:!1,small:!0})))):r().createElement("div",{className:g.Z.searchResultsContainer},r().createElement("div",{className:g.Z.searchResults},r().createElement(s.mh4,null,r().createElement(s.n9L,{className:g.Z.emptySearchResultsTile},r().createElement(d.Z,null),r().createElement("p",{className:g.Z.emptyResultText},p("noPatientChartsFoundMessage","Sorry, no patient charts were found")),r().createElement("p",{className:g.Z.actionText},r().createElement("span",null,p("trySearchWithPatientUniqueID","Try to search again using the patient's unique ID number")))))))}));var C=a(2224),b=a(634),y=a(1354),S=a.n(y),w=a(1583),E=a.n(w),B=a(7378),I=a.n(B),D=a(5993),k=a.n(D),R=a(4154),P=a.n(R),Z=a(8141),N=a.n(Z),T=a(1241),z={};z.styleTagTransform=N(),z.setAttributes=k(),z.insert=I().bind(null,"head"),z.domAPI=E(),z.insertStyleElement=P(),S()(T.Z,z);const j=T.Z&&T.Z.locals?T.Z.locals:void 0;function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function x(){return x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},x.apply(this,arguments)}const q=function(e){var t,a,c,o,s=e.selectPatientAction,i=e.initialSearchTerm,l=e.isSearchPage,A=e.onPatientSelect,d=e.shouldNavigateToPatientSearchPage,_=(c=(0,n.useState)(i),o=2,function(e){if(Array.isArray(e))return e}(c)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,c=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(c.push(n.value),!t||c.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw r}}return c}}(c,o)||function(e,t){if(e){if("string"==typeof e)return U(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?U(e,t):void 0}}(c,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),g=_[0],f=_[1],y=(0,n.useMemo)((function(){return!!g.trim()}),[g]),S=(0,n.useRef)(null),w=(0,n.useRef)(null),E=(0,u.useConfig)(),B=(0,b.hk)(g,E.includeDead,y),I=B.data,D=(0,b.cg)(),k=D.recentlyViewedPatients,R=D.mutateUserProperties,P=(0,b.jW)(k,!y),Z=P.data,N=(0,u.useSession)(),T=N.user,z=N.sessionLocation.uuid,q=(0,n.useCallback)((function(){var e,t,a=null!==(t=null===(e=w.current.value)||void 0===e?void 0:e.length)&&void 0!==t?t:0;w.current.setSelectionRange(a,a),w.current.focus()}),[w]),O=(0,n.useCallback)((function(){f(""),null==A||A()}),[A,f]),L=(0,n.useCallback)((function(e,t,a){e.preventDefault(),a&&(s?s(a[t]):((0,u.navigate)({to:"".concat((0,u.interpolateString)(E.search.patientResultUrl,{patientUuid:a[t].uuid}))}),(0,b.Ey)(a[t].uuid,T).then((function(){(0,u.setSessionLocation)(z,new AbortController),R()}))),O())}),[s,O,E.search.patientResultUrl,T,z,R]),M=(0,C.Z)(Z?null!==(a=null==Z?void 0:Z.length)&&void 0!==a?a:0:null!==(t=null==I?void 0:I.length)&&void 0!==t?t:0,L,q,-1);(0,n.useEffect)((function(){var e,t,a,n;S.current&&M>-1?(null===(e=S.current.children)||void 0===e||null===(t=e[M])||void 0===t||t.focus(),null===(a=S.current.children)||void 0===a||null===(n=a[M])||void 0===n||n.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})):S.current&&w.current&&-1===M&&q()}),[M,S,q]);var H=(0,n.useCallback)((function(e){d&&e.trim()&&(l||window.sessionStorage.setItem("searchReturnUrl",window.location.pathname),(0,u.navigate)({to:"${openmrsSpaBase}/search?query=".concat(encodeURIComponent(e))}))}),[l,d]),F=(0,n.useCallback)((function(){f("")}),[f]),W=(0,h.Z)((function(e){return f(e)}),300);return r().createElement("div",{className:j.patientSearchBar},r().createElement(p.Z,{small:!0,initialSearchTerm:null!=i?i:"",onChange:W,onSubmit:H,onClear:F,ref:w}),!l&&(y?r().createElement("div",{className:j.floatingSearchResultsContainer,"data-testid":"floatingSearchResultsContainer"},r().createElement(m.Z,x({query:g,selectPatientAction:L,ref:S},B))):r().createElement(r().Fragment,null,r().createElement("div",{className:j.floatingSearchResultsContainer,"data-testid":"floatingSearchResultsContainer"},r().createElement(v,x({selectPatientAction:L,ref:S},P))))))};var O=a(654),L={};L.styleTagTransform=N(),L.setAttributes=k(),L.insert=I().bind(null,"head"),L.domAPI=E(),L.insertStyleElement=P(),S()(O.Z,L);const M=O.Z&&O.Z.locals?O.Z.locals:void 0;function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,c=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(c.push(n.value),!t||c.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw r}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return H(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?H(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const W=function(){var e=(0,o.useTranslation)().t,t=(0,u.useLayoutType)(),a=(0,c.useParams)().page,h=(0,n.useMemo)((function(){return"search"===a}),[a]),m=F((0,c.useSearchParams)(),1)[0],p=h?m.get("query"):"",d=F((0,n.useState)(!1),2),_=d[0],g=d[1],f=F((0,n.useState)(!1),2),v=f[0],C=f[1],b=(0,n.useCallback)((function(){(0,u.isDesktop)(t)&&!h&&g(!1)}),[g,h,t]),y=(0,u.useOnClickOutside)(b,v),S=(0,n.useCallback)((function(){var e;_?(h&&((0,u.navigate)({to:null!==(e=window.sessionStorage.getItem("searchReturnUrl"))&&void 0!==e?e:"${openmrsSpaBase}/"}),window.sessionStorage.removeItem("searchReturnUrl")),g(!1)):g(!0)}),[h,g,_]),w=(0,n.useCallback)((function(){g(!1),C(!1)}),[g,C]);return(0,n.useEffect)((function(){g(h),h&&C(!1)}),[h]),(0,n.useEffect)((function(){C(!!_)}),[_]),r().createElement("div",{className:M.patientSearchIconWrapper,ref:y},_&&((0,u.isDesktop)(t)?r().createElement(q,{isSearchPage:h,initialSearchTerm:p,shouldNavigateToPatientSearchPage:!0,onPatientSelect:w}):r().createElement(A.Z,{onClose:S,query:p})),r().createElement("div",{className:"".concat(_&&M.closeButton)},r().createElement(s.JMr,{"aria-label":e("searchPatient","Search Patient"),"aria-labelledby":"Search Patient",className:"".concat(_?M.activeSearchIconButton:M.searchIconButton),enterDelayMs:500,name:"SearchPatientIcon","data-testid":"searchPatientIcon",onClick:S},_?r().createElement(i.x8,{size:20}):r().createElement(l.ol,{size:20}))))},J=function(){return r().createElement(c.BrowserRouter,{basename:window.getOpenmrsSpaBase()},r().createElement(c.Routes,null,r().createElement(c.Route,{path:":page/*",element:r().createElement(W,null)})))}}}]);