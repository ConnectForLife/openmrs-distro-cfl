"use strict";(globalThis.webpackChunk_openmrs_esm_patient_chart_app=globalThis.webpackChunk_openmrs_esm_patient_chart_app||[]).push([[6721],{1912:(t,e,n)=>{n.d(e,{Z:()=>s});var r=n(272),i=n.n(r),o=n(2609),a=n.n(o)()(i());a.push([t.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-chart__cancel-visit-dialog__bodyShort02___e5GxJ{font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0);color:#161616}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/visit/visit-prompt/cancel-visit-dialog.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCpDF,8DCu0BI,oDAAA,CAAA,uDAAA,CAAA,yDAAA,CAAA,2DAAA,CDr0BF,aDDM",sourceRoot:""}]),a.locals={bodyShort02:"-esm-patient-chart__cancel-visit-dialog__bodyShort02___e5GxJ"};const s=a},2609:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,i,o){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var u=this[s][0];null!=u&&(a[u]=!0)}for(var c=0;c<t.length;c++){var l=[].concat(t[c]);r&&a[l[0]]||(void 0!==o&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=o),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),i&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=i):l[4]="".concat(i)),e.push(l))}},e}},272:t=>{t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),o="/*# ".concat(i," */"),a=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[e].concat(a).concat([o]).join("\n")}return[e].join("\n")}},1354:t=>{var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var o={},a=[],s=0;s<t.length;s++){var u=t[s],c=r.base?u[0]+r.base:u[0],l=o[c]||0,d="".concat(c," ").concat(l);o[c]=l+1;var p=n(d),v={css:u[1],media:u[2],sourceMap:u[3],supports:u[4],layer:u[5]};if(-1!==p)e[p].references++,e[p].updater(v);else{var f=i(v,r);r.byIndex=s,e.splice(s,0,{identifier:d,updater:f,references:1})}a.push(d)}return a}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var o=r(t=t||[],i=i||{});return function(t){t=t||[];for(var a=0;a<o.length;a++){var s=n(o[a]);e[s].references--}for(var u=r(t,i),c=0;c<o.length;c++){var l=n(o[c]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}o=u}}},7378:t=>{var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},4154:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},5993:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},1583:t=>{t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},8141:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},4100:(t,e,n)=>{n.d(e,{Aq:()=>s,Ls:()=>d});var r=n(2870);function i(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function s(t){i(a,r,o,s,u,"next",t)}function u(t){i(a,r,o,s,u,"throw",t)}s(void 0)}))}}function a(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function s(t,e,n,r,i,o,a,s,c){return u.apply(this,arguments)}function u(){return(u=o((function(t,e,n,i,o,s,u,l,d){return a(this,(function(a){switch(a.label){case 0:return[4,Promise.all([c(l,t,e,u,d)])];case 1:return a.sent(),[2,(0,r.openmrsFetch)("/ws/rest/v1/visit-queue-entry",{method:"POST",headers:{"Content-Type":"application/json"},signal:u.signal,body:{visit:{uuid:t},queueEntry:{status:{uuid:o},priority:{uuid:i},queue:{uuid:e},patient:{uuid:n},startedAt:(0,r.toDateObjectStrict)((0,r.toOmrsIsoString)(new Date)),sortWeight:s}}})]}}))}))).apply(this,arguments)}function c(t,e,n,r,i){return l.apply(this,arguments)}function l(){return(l=o((function(t,e,n,i,o){return a(this,(function(a){switch(a.label){case 0:return[4,(0,r.openmrsFetch)("/ws/rest/v1/queue-entry-number?location=".concat(t,"&queue=").concat(n,"&visit=").concat(e,"&visitAttributeType=").concat(o),{method:"GET",headers:{"Content-Type":"application/json"},signal:i.signal})];case 1:return a.sent(),[2]}}))}))).apply(this,arguments)}function d(t,e,n){return(0,r.openmrsFetch)("/ws/rest/v1/queue/".concat(t,"/entry/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:{endedAt:(0,r.toDateObjectStrict)((0,r.toOmrsIsoString)(new Date))},signal:n.signal})}},4994:(t,e,n)=>{n.d(e,{t:()=>o});var r=n(3255),i=n(2870);function o(t,e){var n,o,a,s="/ws/rest/v1/visit-queue-entry?patient=".concat(t),u=(0,r.ZP)(s,i.openmrsFetch),c=u.data,l=u.error,d=u.isLoading,p=u.isValidating;return{queueEntry:null!==(a=null==c||null===(o=c.data)||void 0===o||null===(n=o.results)||void 0===n?void 0:n.map((function(t){var e,n,r,i;return{id:t.uuid,name:t.queueEntry.queue.display,patientUuid:t.queueEntry.patient.uuid,priority:"Urgent"===t.queueEntry.priority.display?"Priority":t.queueEntry.priority.display,priorityUuid:t.queueEntry.priority.uuid,service:null===(e=t.queueEntry.queue)||void 0===e?void 0:e.display,status:t.queueEntry.status.display,statusUuid:t.queueEntry.status.uuid,visitUuid:null===(n=t.visit)||void 0===n?void 0:n.uuid,visitType:null===(i=t.visit)||void 0===i||null===(r=i.visitType)||void 0===r?void 0:r.display,queueUuid:t.queueEntry.queue.uuid,queueEntryUuid:t.queueEntry.uuid}})).filter((function(t){return void 0!==e&&e===t.visitUuid})).shift())&&void 0!==a?a:null,isLoading:d,isError:l,isValidating:p}}n(268)},6721:(t,e,n)=>{n.r(e),n.d(e,{default:()=>S});var r=n(268),i=n.n(r),o=n(4350),a=n(2870),s=n(4924),u=n(1354),c=n.n(u),l=n(1583),d=n.n(l),p=n(7378),v=n.n(p),f=n(5993),y=n.n(f),h=n(4154),m=n.n(h),b=n(8141),g=n.n(b),A=n(1912),w={};w.styleTagTransform=g(),w.setAttributes=y(),w.insert=v().bind(null,"head"),w.domAPI=d(),w.insertStyleElement=m(),c()(A.Z,w);const C=A.Z&&A.Z.locals?A.Z.locals:void 0;var E=n(4994),q=n(4100);function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const S=function(t){var e,n,u=t.patientUuid,c=t.closeModal,l=(0,s.useTranslation)().t,d=(0,a.useVisit)(u),p=d.currentVisit,v=d.mutate,f=(e=(0,r.useState)(!1),n=2,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,n)||function(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),y=f[0],h=f[1],m=(0,E.t)(u,null==p?void 0:p.uuid),b=(0,r.useCallback)((function(){h(!0),(0,a.openmrsFetch)("/ws/rest/v1/visit/".concat(p.uuid),{headers:{"Content-type":"application/json"},method:"POST",body:{voided:!0}}).then((function(){var t=null==m?void 0:m.queueEntry;v(),c(),h(!1),t&&(0,q.Ls)(t.queueUuid,t.queueEntryUuid,new AbortController),(0,a.showToast)({title:l("cancelVisit","Cancel visit"),kind:"success",description:l("visitCanceled","Canceled active visit successfully")})}),(function(t){(0,a.showNotification)({title:l("cancelVisitError","Error cancelling active visit"),kind:"error",critical:!0,description:null==t?void 0:t.message}),h(!1)}))}),[c,p.uuid,v,l,null==m?void 0:m.queueEntry]);return i().createElement("div",null,i().createElement(o.ModalHeader,{closeModal:c,label:l("visit","Visit"),title:l("cancelActiveVisit","Cancel active visit")}),i().createElement(o.ModalBody,null,i().createElement("p",{className:C.bodyShort02},l("cancelVisitWarningMessage","Cancelling this visit will delete all associated encounters"),".")),i().createElement(o.ModalFooter,null,i().createElement(o.Button,{kind:"secondary",onClick:c},l("cancel","Cancel")),i().createElement(o.Button,{disabled:y,kind:"danger",onClick:b},y?i().createElement(o.InlineLoading,{description:"".concat(l("loading","Loading")," ...")}):l("cancelVisit","Cancel visit"))))}}}]);