"use strict";(self.webpackChunk_openmrs_esm_patient_conditions_app=self.webpackChunk_openmrs_esm_patient_conditions_app||[]).push([[845],{1093:(e,t,n)=>{n.d(t,{Z:()=>h});var i=n(321),o=n.n(i),r=n(1195),a=n.n(r),l=n(3275),s=n.n(l),c=n(7162),d=n.n(c),u=n(2094),m=n.n(u),f=n(757),_=n.n(f),p=n(2016),g={};g.styleTagTransform=_(),g.setAttributes=d(),g.insert=s().bind(null,"head"),g.domAPI=a(),g.insertStyleElement=m(),o()(p.Z,g);const h=p.Z&&p.Z.locals?p.Z.locals:void 0},2016:(e,t,n)=>{n.d(t,{Z:()=>l});var i=n(9601),o=n.n(i),r=n(2609),a=n.n(r)()(o());a.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{padding:0;border:0;margin:0;font:inherit;font-size:100%;vertical-align:baseline}button,select,input,textarea{border-radius:0;font-family:inherit}input[type=text]::-ms-clear{display:none}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section{display:block}body{line-height:1}sup{vertical-align:super}sub{vertical-align:sub}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote::before,blockquote::after,q::before,q::after{content:\"\"}table{border-collapse:collapse;border-spacing:0}*{box-sizing:border-box}button{margin:0}html{font-size:100%}body{font-weight:400;font-family:'IBM Plex Sans', 'Helvetica Neue', Arial, sans-serif;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility}code{font-family:'IBM Plex Mono', 'Menlo', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Courier, monospace}strong{font-weight:600}@media screen and (-ms-high-contrast: active){svg{fill:ButtonText}}h1{font-size:2.625rem;font-weight:300;line-height:1.199;letter-spacing:0}h2{font-size:2rem;font-weight:400;line-height:1.25;letter-spacing:0}h3{font-size:1.75rem;font-weight:400;line-height:1.29;letter-spacing:0}h4{font-size:1.25rem;font-weight:400;line-height:1.4;letter-spacing:0}h5{font-size:1rem;font-weight:600;line-height:1.375;letter-spacing:0}h6{font-size:.875rem;font-weight:600;line-height:1.29;letter-spacing:.16px}p{font-size:1rem;font-weight:400;line-height:1.5;letter-spacing:0}a{color:#0f62fe}em{font-style:italic}@keyframes -esm-patient-conditions__conditions-form__skeleton___H4XV_{0%{opacity:.3;transform:scaleX(0);transform-origin:left}20%{opacity:1;transform:scaleX(1);transform-origin:left}28%{transform:scaleX(1);transform-origin:right}51%{transform:scaleX(0);transform-origin:right}58%{transform:scaleX(0);transform-origin:right}82%{transform:scaleX(1);transform-origin:right}83%{transform:scaleX(1);transform-origin:left}96%{transform:scaleX(0);transform-origin:left}100%{opacity:.3;transform:scaleX(0);transform-origin:left}}.-esm-patient-conditions__conditions-form__condition___RKmYn{padding:1rem .75rem}.-esm-patient-conditions__conditions-form__conditionsList___JiKu0{margin-top:.25rem;background-color:#fff;max-height:14rem;overflow-y:auto;border:1px solid #e0e0e0}.-esm-patient-conditions__conditions-form__conditionsList___JiKu0 li:hover{background-color:#e0e0e0}.-esm-patient-conditions__conditions-form__emptyResults___DwxFa{font-size:.875rem;font-weight:400;line-height:1.29;letter-spacing:.16px;color:#525252;min-height:1rem}.-esm-patient-conditions__conditions-form__form___nVxA8{display:flex;flex-direction:column;justify-content:space-between;height:calc(100vh - 6rem)}.-esm-patient-conditions__conditions-form__formContainer___O_zJT{margin:1rem}.-esm-patient-conditions__conditions-form__button___V4VKa{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-patient-conditions__conditions-form__tablet___qRP8r{padding:1.5rem 1rem;background-color:#fff}.-esm-patient-conditions__conditions-form__desktop___zBkPN{padding:0rem}",""]),a.locals={condition:"-esm-patient-conditions__conditions-form__condition___RKmYn",conditionsList:"-esm-patient-conditions__conditions-form__conditionsList___JiKu0",emptyResults:"-esm-patient-conditions__conditions-form__emptyResults___DwxFa",form:"-esm-patient-conditions__conditions-form__form___nVxA8",formContainer:"-esm-patient-conditions__conditions-form__formContainer___O_zJT",button:"-esm-patient-conditions__conditions-form__button___V4VKa",tablet:"-esm-patient-conditions__conditions-form__tablet___qRP8r",desktop:"-esm-patient-conditions__conditions-form__desktop___zBkPN",skeleton:"-esm-patient-conditions__conditions-form__skeleton___H4XV_"};const l=a},1845:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var i=n(9902),o=n.n(i),r=n(3565),a=n.n(r),l=(n(264),n(3914)),s=n(9857),c=n(1093),d=n(4924),u=n(3066),m=n(786),f=n(4750),_=n(9513),p=n(5343),g=n(6642),h=n(350),b=n(8769),v=n(6086),y=n(4548);function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,r=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);a=!0);}catch(e){l=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const x=function(e){var t,n=e.patientUuid,r=e.closeWorkspace,S=e.setHasSubmissibleValue,x=e.submissionNotifier,w=(0,d.useTranslation)().t,E="tablet"===(0,u.useLayoutType)(),C=(0,u.useSession)(),D=(0,s.kY)().mutate,T=k(o().useState("active"),2),Z=T[0],z=T[1],q=k(o().useState(null),2),I=q[0],V=q[1],A=k(o().useState(new Date),2),P=A[0],N=A[1],O=k(o().useState(!1),2),X=O[0],B=O[1],R=k(o().useState(""),2),j=R[0],F=R[1],L=k(o().useState(null),2),M=L[0],K=L[1],H=k(o().useState(null),2),U=H[0],J=H[1];(0,i.useEffect)((function(){S&&S(!!U)}),[U,S]);var Y=o().useMemo((function(){return(0,l.Z)((function(e){if(e){var t=(0,y.De)(e).subscribe((function(e){K(e),B(!1)}),(function(){return(0,u.createErrorHandler)()}));return function(){t.unsubscribe()}}}),500)}),[]),W=o().useCallback((function(e){J(e),F("")}),[]),$=o().useCallback((function(){var e,t,i;if(U){var o={resourceType:"Condition",clinicalStatus:{coding:[{system:"http://terminology.hl7.org/CodeSystem/condition-clinical",code:Z}]},code:{coding:[{code:null==U||null===(e=U.concept)||void 0===e?void 0:e.uuid,display:null==U||null===(t=U.concept)||void 0===t?void 0:t.display}]},endDate:I?a()(I).format():null,onsetDateTime:P?a()(P).format():null,subject:{reference:"Patient/".concat(n)},recorder:{reference:"Practitioner/".concat(null==C||null===(i=C.user)||void 0===i?void 0:i.uuid)},recordedDate:(new Date).toISOString()},l=new AbortController,s=(0,y.qz)(o,l).subscribe((function(e){201===e.status&&(null==r||r(),(0,u.showToast)({critical:!0,kind:"success",description:w("conditionNowVisible","It is now visible on the Conditions page"),title:w("conditionSaved","Condition saved")}),D("".concat(u.fhirBaseUrl,"/Condition?patient=").concat(n)))}),(function(e){(0,u.createErrorHandler)(),(0,u.showNotification)({title:w("conditionSaveError","Error saving condition"),kind:"error",critical:!0,description:null==e?void 0:e.message})}));return function(){s.unsubscribe()}}}),[Z,r,I,D,P,n,U,null==C||null===(t=C.user)||void 0===t?void 0:t.uuid,w]);return(0,i.useEffect)((function(){var e=null==x?void 0:x.subscribe((function(e){e.isSubmitting&&$()}));return function(){null==e||e.unsubscribe()}}),[$,x]),o().createElement("div",{className:c.Z.formContainer},o().createElement(m.Z,{legendText:w("condition","Condition")},o().createElement(f.Z,{light:E,size:"xl",id:"conditionsSearch",labelText:w("enterCondition","Enter condition"),placeholder:w("searchConditions","Search conditions"),onChange:function(e){J(null),B(!0);var t=e.target.value;F(t),t&&Y(t)},value:j||(U&&!X?U.display:"")}),o().createElement("div",null,!j||U?null:X?o().createElement(_.Z,{role:"progressbar"}):M&&M.length?o().createElement("ul",{className:c.Z.conditionsList},M.map((function(e,t){return o().createElement("li",{role:"menuitem",className:c.Z.condition,key:t,onClick:function(){return W(e)}},e.display)}))):o().createElement(p.n9,{light:E,className:c.Z.emptyResults},o().createElement("span",null,w("noResultsFor","No results for")," ",o().createElement("strong",null,'"',j,'"'))))),o().createElement(m.Z,{legendText:w("onsetDate","Onset date")},o().createElement(g.Z,{id:"onsetDate",datePickerType:"single",dateFormat:"d/m/Y",maxDate:(new Date).toISOString(),placeholder:"dd/mm/yyyy",onChange:function(e){var t=k(e,1)[0];return N(t)},value:P,light:E},o().createElement(h.Z,{id:"onsetDateInput",labelText:""}))),o().createElement(m.Z,{legendText:w("currentStatus","Current status")},o().createElement(b.Z,{defaultSelected:"active",name:"clinicalStatus",valueSelected:"active",orientation:"vertical",onChange:function(e){return z(e.toString())}},o().createElement(v.Z,{id:"active",labelText:"Active",value:"active"}),o().createElement(v.Z,{id:"inactive",labelText:"Inactive",value:"inactive"}))),"inactive"===Z&&o().createElement(g.Z,{id:"endDate",datePickerType:"single",dateFormat:"d/m/Y",minDate:new Date(P).toISOString(),maxDate:a()().utc().format(),placeholder:"dd/mm/yyyy",onChange:function(e){var t=k(e,1)[0];return V(t)},value:I,light:E},o().createElement(h.Z,{id:"endDateInput",labelText:w("endDate","End date")})))}},4548:(e,t,n)=>{n.d(t,{De:()=>l,l4:()=>a,qz:()=>c});var i=n(9857),o=n(2188),r=n(3066);function a(e){var t,n,o,a=(0,i.ZP)("".concat(r.fhirBaseUrl,"/Condition?patient=").concat(e),r.openmrsFetch),l=a.data,c=a.error,d=a.isValidating,u=(null==l||null===(t=l.data)||void 0===t?void 0:t.total)>0?null==l||null===(n=l.data)||void 0===n?void 0:n.entry.map((function(e){return null!==(o=e.resource)&&void 0!==o?o:[]})).map(s).sort((function(e,t){return t.onsetDateTime>e.onsetDateTime?1:-1})):null;return{data:l?u:null,isError:c,isLoading:!l&&!c,isValidating:d}}function l(e){return(0,r.openmrsObservableFetch)("/ws/rest/v1/conceptsearch?conceptClasses=".concat("8d4918b0-c2cc-11de-8d13-0010c6dffd0f","&q=").concat(e)).pipe((0,o.U)((function(e){return e.data.results})))}function s(e){var t,n,i,o,r,a;return{clinicalStatus:null===(n=null==e||null===(t=e.clinicalStatus)||void 0===t?void 0:t.coding[0])||void 0===n?void 0:n.code,conceptId:null===(o=null==e||null===(i=e.code)||void 0===i?void 0:i.coding[0])||void 0===o?void 0:o.code,display:null===(a=null==e||null===(r=e.code)||void 0===r?void 0:r.coding[0])||void 0===a?void 0:a.display,onsetDateTime:null==e?void 0:e.onsetDateTime,recordedDate:null==e?void 0:e.recordedDate,id:null==e?void 0:e.id}}function c(e,t){return(0,r.openmrsObservableFetch)("".concat(r.fhirBaseUrl,"/Condition"),{headers:{"Content-Type":"application/json"},method:"POST",body:e,signal:t})}}}]);