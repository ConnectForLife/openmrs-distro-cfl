"use strict";(globalThis.webpackChunk_openmrs_esm_patient_programs_app=globalThis.webpackChunk_openmrs_esm_patient_programs_app||[]).push([[808],{7763:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(272),o=r.n(n),a=r(2609),l=r.n(a)()(o());l.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-programs__programs-overview__widgetCard___yEo1t{border:1px solid #e0e0e0}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/programs/programs-overview.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCrDF,8DACE,wBAAA",sourceRoot:""}]),l.locals={widgetCard:"-esm-patient-programs__programs-overview__widgetCard___yEo1t"};const i=l},2808:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Z});var n=r(268),o=r.n(n),a=r(4924),l=r(3315),i=r(1279),s=r(6759),c=r(4556),u=r(2870),d=r(4076),m=r(6039);function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){p(e,t,r[t])}))}return e}const b=function(e){var t=e.enrollment,r=(0,a.useTranslation)().t,n="tablet"===(0,u.useLayoutType)(),l="eligible"===t.enrollmentStatus?t.enrollmentFormUuid:t.discontinuationFormUuid,s=function(e){(0,c.launchPatientWorkspace)("patient-form-entry-workspace",{workspaceTitle:"".concat(null==t?void 0:t.display," ").concat(e," Form"),formInfo:{formUuid:l,encounterUuid:""}})};return"eligible"===t.enrollmentStatus?o().createElement(i.zxk,{iconDescription:r("enrollProgram","Enroll to program"),onClick:function(){return s(r("enrollment","Enrollment"))},renderIcon:function(e){return o().createElement(m.sQ,g({size:20},e))},kind:"tertiary",size:n?"lg":"sm",tooltipPosition:"left"},r("enroll","Enroll")):o().createElement(i.zxk,{iconDescription:r("discontinueEnrollment","Discontinue enrollment"),onClick:function(){return s(r("discontinue","Discontinue"))},renderIcon:function(e){return o().createElement(m.sQ,g({size:20},e))},kind:"danger--ghost",size:n?"lg":"sm",tooltipPosition:"left"},r("discontinue","Discontinue"))};var f=r(1354),v=r.n(f),y=r(1583),E=r.n(y),h=r(7378),P=r.n(h),w=r(5993),O=r.n(w),C=r(4154),k=r.n(C),A=r(8141),j=r.n(A),S=r(7763),_={};_.styleTagTransform=j(),_.setAttributes=O(),_.insert=P().bind(null,"head"),_.domAPI=E(),_.insertStyleElement=k(),v()(S.Z,_);const D=S.Z&&S.Z.locals?S.Z.locals:void 0;function T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){T(e,t,r[t])}))}return e}const Z=function(e){e.basePath;var t=e.patientUuid,r=(0,a.useTranslation)().t,n=(0,u.useConfig)(),m=r("programs","Program enrollments"),p=r("carePrograms","Care Programs"),g=r("seeAll","See all"),f="${openmrsSpaBase}/patient/".concat(t,"/chart/Programs"),v=!!n.customUrl,y=(0,u.useLayoutType)(),E="tablet"===y,h=(0,u.isDesktop)(y),P=(0,d.b$)(t),w=P.activeEnrollments,O=P.availablePrograms,C=P.configurablePrograms,k=P.eligiblePrograms,A=P.enrollments,j=P.isError,S=P.isLoading,_=P.isValidating,T=(0,u.usePagination)(v?C:null!=A?A:[],5),Z=T.results,F=T.goTo,z=T.currentPage,I=o().useCallback((function(){return(0,c.launchPatientWorkspace)("programs-form-workspace")}),[]),U=[{key:"display",header:r("activePrograms","Active programs")},{key:"location",header:r("location","Location")},{key:"dateEnrolled",header:r("dateEnrolled","Date enrolled")},{key:"status",header:r("status","Status")},{key:"actions",header:r("actions","Actions")}],x=o().useMemo((function(){return null==Z?void 0:Z.map((function(e){var t,n;return{id:e.uuid,display:e.display,location:null!==(n=null===(t=e.location)||void 0===t?void 0:t.display)&&void 0!==n?n:"--",dateEnrolled:e.dateEnrolled?(0,u.formatDatetime)(new Date(e.dateEnrolled)):"--",status:v?(0,l.Z)(e.enrollmentStatus):e.dateCompleted?"".concat(r("completedOn","Completed On")," ").concat((0,u.formatDate)(new Date(e.dateCompleted))):r("active","Active"),actions:o().createElement(b,{enrollment:e})}}))}),[v,Z,r]);return S?o().createElement(i.gqd,{role:"progressbar",compact:h,zebra:!0}):j?o().createElement(c.ErrorState,{error:j,headerTitle:p}):(v?C.length:null==w?void 0:w.length)?o().createElement("div",{className:D.widgetCard},o().createElement(c.CardHeader,{title:p},o().createElement("span",null,_?o().createElement(i.lSo,null):null),n.hideAddProgramButton?null:o().createElement(i.zxk,{kind:"ghost",renderIcon:function(e){return o().createElement(s.mm,L({size:16},e))},iconDescription:"Add programs",onClick:I,disabled:(null==O?void 0:O.length)&&0===(null==k?void 0:k.length)},r("add","Add"))),(null==O?void 0:O.length)&&0===(null==k?void 0:k.length)&&o().createElement(i.K0D,{style:{minWidth:"100%",margin:"0rem",padding:"0rem"},kind:"info",lowContrast:!0,subtitle:r("noEligibleEnrollments","There are no more programs left to enroll this patient in"),title:r("fullyEnrolled","Enrolled in all programs")}),o().createElement(i.wQF,{rows:x,headers:U,isSortable:!0,size:E?"lg":"sm",useZebraStyles:!0},(function(e){var t=e.rows,r=e.headers,n=e.getHeaderProps,a=e.getTableProps;return o().createElement(i.xJi,null,o().createElement(i.iA_,a(),o().createElement(i.ssF,null,o().createElement(i.SCH,null,r.map((function(e){var t,r;return o().createElement(i.xDH,L({className:"".concat(D.productiveHeading01," ").concat(D.text02)},n({header:e,isSortable:e.isSortable})),null!==(r=null===(t=e.header)||void 0===t?void 0:t.content)&&void 0!==r?r:e.header)})))),o().createElement(i.RMI,null,t.map((function(e){return o().createElement(i.SCH,{key:e.id},e.cells.map((function(e){var t,r;return o().createElement(i.pj1,{key:e.id},null!==(r=null===(t=e.value)||void 0===t?void 0:t.content)&&void 0!==r?r:e.value)})))})))))})),o().createElement(c.PatientChartPagination,{currentItems:Z.length,onPageNumberChange:function(e){var t=e.page;return F(t)},pageNumber:z,pageSize:5,totalItems:v?C.length:null==A?void 0:A.length,dashboardLinkUrl:f,dashboardLinkLabel:g})):o().createElement(c.EmptyState,{displayText:m,headerTitle:p,launchForm:I})}},4076:(e,t,r)=>{r.d(t,{Bw:()=>u,YX:()=>p,b$:()=>g,df:()=>m,oI:()=>d});var n=r(3255),o=r(2870),a=r(4221),l=r(9626),i=r(3139),s=r(6772);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e){var t,r="/ws/rest/v1/programenrollment?patient=".concat(e,"&v=").concat("custom:(uuid,display,program,dateEnrolled,dateCompleted,location:(uuid,display))"),l=(0,n.ZP)(e?r:null,o.openmrsFetch),i=l.data,s=l.error,c=l.isLoading,u=l.isValidating,d=l.mutate,m=(null==i||null===(t=i.data)||void 0===t?void 0:t.results.length)>0?null==i?void 0:i.data.results.sort((function(e,t){return t.dateEnrolled>e.dateEnrolled?1:-1})):null,p=null==m?void 0:m.filter((function(e){return!e.dateCompleted}));return{data:i?(0,a.Z)(m,(function(e){var t;return null==e||null===(t=e.program)||void 0===t?void 0:t.uuid})):null,isError:s,isLoading:c,isValidating:u,activeEnrollments:p,mutateEnrollments:d}}function d(e){var t,r,a=(0,n.ZP)("/ws/rest/v1/program?v=custom:(uuid,display,allWorkflows,concept:(uuid,display))",o.openmrsFetch),c=a.data,u=a.error,d=a.isLoading,m=null!==(r=null==c||null===(t=c.data)||void 0===t?void 0:t.results)&&void 0!==r?r:null;return{data:m,isError:u,isLoading:d,eligiblePrograms:(0,l.Z)(m,(function(t){return!(0,i.Z)((0,s.Z)(e,"program.uuid"),t.uuid)}))}}function m(e,t){if(!e)return null;var r=e.program,n=e.patient,a=e.dateEnrolled,l=e.dateCompleted,i=e.location;return(0,o.openmrsObservableFetch)("/ws/rest/v1/programenrollment",{method:"POST",headers:{"Content-Type":"application/json"},body:{program:r,patient:n,dateEnrolled:a,dateCompleted:l,location:i},signal:t.signal})}function p(e,t,r){if(!t&&!t.program)return null;t.program;var n=t.dateEnrolled,a=t.dateCompleted,l=t.location;return(0,o.openmrsObservableFetch)("/ws/rest/v1/programenrollment/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:{dateEnrolled:n,dateCompleted:a,location:l},signal:r.signal})}var g=function(e){var t,r,a=(0,o.useConfig)().customUrl,l=u(e),i=l.data,s=l.isError,m=l.isLoading,p=l.isValidating,g=l.activeEnrollments,b=d(i),f=b.data,v=b.eligiblePrograms,y=function(e){var t,r=(0,o.useConfig)().customUrl,a=(0,n.ZP)(r?"".concat(r).concat(e):null,o.openmrsFetch),l=a.data,i=a.error,s=a.isLoading;return{configurablePrograms:null!==(t=null==l?void 0:l.data)&&void 0!==t?t:[],isLoading:s,error:i}}(e),E=y.configurablePrograms,h=y.isLoading,P=y.error;return t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){c(e,t,r[t])}))}return e}({enrollments:i},a?{isLoading:h,isError:P}:{isLoading:m,isError:s}),r=null!=(r={isValidating:p,activeEnrollments:g,availablePrograms:f,eligiblePrograms:v,configurablePrograms:E})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})),t}}}]);