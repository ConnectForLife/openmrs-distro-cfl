"use strict";(self.webpackChunk_openmrs_esm_outpatient_app=self.webpackChunk_openmrs_esm_outpatient_app||[]).push([[547],{8132:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(2609),r=n.n(a)()((function(e){return e[1]}));r.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;font:inherit;font-size:100%;vertical-align:baseline;border:0}button,select,input,textarea{font-family:inherit;border-radius:0}input[type=text]::-ms-clear{display:none}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section{display:block}body{line-height:1}sup{vertical-align:super}sub{vertical-align:sub}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote::before,blockquote::after,q::before,q::after{content:\"\"}table{border-collapse:collapse;border-spacing:0}*{box-sizing:border-box}button{margin:0}html{font-size:100%}body{font-weight:400;font-family:'IBM Plex Sans', 'Helvetica Neue', Arial, sans-serif;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}code{font-family:'IBM Plex Mono', 'Menlo', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Courier, monospace}strong{font-weight:600}@media screen and (-ms-high-contrast: active){svg{fill:ButtonText}}h1{font-size:2.625rem;font-weight:300;line-height:1.199;letter-spacing:0}h2{font-size:2rem;font-weight:400;line-height:1.25;letter-spacing:0}h3{font-size:1.75rem;font-weight:400;line-height:1.29;letter-spacing:0}h4{font-size:1.25rem;font-weight:400;line-height:1.4;letter-spacing:0}h5{font-size:1rem;font-weight:600;line-height:1.375;letter-spacing:0}h6{font-size:.875rem;font-weight:600;line-height:1.29;letter-spacing:.16px}p{font-size:1rem;font-weight:400;line-height:1.5;letter-spacing:0}a{color:#0f62fe}em{font-style:italic}@keyframes -esm-outpatient__visit-header__skeleton___2XDt9{0%{transform:scaleX(0);transform-origin:left;opacity:.3}20%{transform:scaleX(1);transform-origin:left;opacity:1}28%{transform:scaleX(1);transform-origin:right}51%{transform:scaleX(0);transform-origin:right}58%{transform:scaleX(0);transform-origin:right}82%{transform:scaleX(1);transform-origin:right}83%{transform:scaleX(1);transform-origin:left}96%{transform:scaleX(0);transform-origin:left}100%{transform:scaleX(0);transform-origin:left;opacity:.3}}.-esm-outpatient__visit-header__topNavHeader___r4krG{top:var(--omrs-offline-banner-height);background-color:#004144;background-color:var(--brand-02)}.-esm-outpatient__visit-header__headerGlobalBarButton___wAaDA{background-color:#005d5d;background-color:var(--brand-01)}.-esm-outpatient__visit-header__headerGlobalBarCloseButton___DAfu3{background-color:#004144;background-color:var(--brand-02)}.-esm-outpatient__visit-header__headerName___-OGyA{display:flex}.-esm-outpatient__visit-header__navLogo___IK\\+EM{margin-right:1.5rem;margin-left:.75rem}.-esm-outpatient__visit-header__startVisitButton___ZgOSy{width:15rem}.-esm-outpatient__visit-header__patientDetails___uVl3H{display:flex;align-items:center;color:#fff;padding:0 1rem}.-esm-outpatient__visit-header__patientDetails___uVl3H:hover{background-color:#022b30}.-esm-outpatient__visit-header__patientDetails___uVl3H .-esm-outpatient__visit-header__patientName___\\+gomy{font-size:.875rem;font-weight:600;line-height:1.29;letter-spacing:.16px;margin-right:1rem;color:#fff;margin:.75rem 0;padding-right:.5rem}.-esm-outpatient__visit-header__patientDetails___uVl3H .-esm-outpatient__visit-header__patientInfo___-u6fX{color:#c6c6c6;font-size:.875rem;font-weight:400;line-height:1.29;letter-spacing:.16px}.-esm-outpatient__visit-header__tooltip___dxX8b .bx--tooltip__trigger.bx--tooltip__trigger--definition{border-bottom:none}.-esm-outpatient__visit-header__navDivider___seFG2{background-color:#9ef0f0;width:.05rem;height:2.25rem}",""]),r.locals={topNavHeader:"-esm-outpatient__visit-header__topNavHeader___r4krG",headerGlobalBarButton:"-esm-outpatient__visit-header__headerGlobalBarButton___wAaDA",headerGlobalBarCloseButton:"-esm-outpatient__visit-header__headerGlobalBarCloseButton___DAfu3",headerName:"-esm-outpatient__visit-header__headerName___-OGyA",navLogo:"-esm-outpatient__visit-header__navLogo___IK+EM",startVisitButton:"-esm-outpatient__visit-header__startVisitButton___ZgOSy",patientDetails:"-esm-outpatient__visit-header__patientDetails___uVl3H",patientName:"-esm-outpatient__visit-header__patientName___+gomy",patientInfo:"-esm-outpatient__visit-header__patientInfo___-u6fX",tooltip:"-esm-outpatient__visit-header__tooltip___dxX8b",navDivider:"-esm-outpatient__visit-header__navDivider___seFG2",skeleton:"-esm-outpatient__visit-header__skeleton___2XDt9"};const o=r},1547:(e,t,n)=>{n.r(t),n.d(t,{default:()=>$});var a=n(9902),r=n.n(a),o=n(7211),i=n(3342),s=n(2023),l=n(9103),c=n(254),u=n(9539),p=n(9688),m=n(5611),d=n(4924),f=n(6062),_=n.n(f),g=n(4036),h=n.n(g),v=n(6793),b=n.n(v),y=n(7892),k=n.n(y),w=n(1173),S=n.n(w),E=n(2464),O=n.n(E),x=n(8132),N={};N.styleTagTransform=O(),N.setAttributes=k(),N.insert=b().bind(null,"head"),N.domAPI=h(),N.insertStyleElement=S(),_()(x.Z,N);const B=x.Z&&x.Z.locals?x.Z.locals:void 0;var A=n(3066),D=n(5573),j=n(6081);function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){P(e,t,n[t])}))}return e}function W(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function V(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Z={};function M(e){var t,n=null==e||null===(t=e.meta)||void 0===t?void 0:t.title;return"string"==typeof n?n:n&&"object"==typeof n?(0,A.translateFrom)(e.moduleName,n.key,n.default):e.name}var T={};function z(e){return T[e]}function G(e,t){var n=F(),a=z(e);if(!t&&a&&a()){var r={title:(0,A.translateFrom)("@openmrs/esm-patient-chart-app","unsavedChangesTitleText","Unsaved Changes"),body:(0,A.translateFrom)("@openmrs/esm-patient-chart-app","unsavedChangeText","You have unsaved changes in the side panel. Do you want to discard these changes?"),onConfirm:function(){var t=n.getState();n.setState(W(I({},t),{prompt:null,openWorkspaces:t.openWorkspaces.filter((function(t){return t.name!=e}))}))},confirmText:(0,A.translateFrom)("@openmrs/esm-patient-chart-app","discard","Discard")};n.setState(W(I({},n.getState()),{prompt:r}))}else{var o=n.getState();n.setState(W(I({},o),{openWorkspaces:o.openWorkspaces.filter((function(t){return t.name!=e}))}))}}var X={patientUuid:null,openWorkspaces:[],prompt:null};function F(){return(0,A.getGlobalStore)("workspace",X)}const H=function(e){var t=e.isExpanded,n=e.toggleSideMenu,a=(0,A.useOnClickOutside)(n,t);return r().useEffect((function(){return window.addEventListener("popstate",n),window.addEventListener("popstate",n)}),[n]),t?r().createElement(A.LeftNavMenu,{ref:a}):null};function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);i=!0);}catch(e){s=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var U=function(e){var t,n,a,i=e.patient,s=e.isTabletView,l="".concat(null===(n=null==i||null===(t=i.name)||void 0===t?void 0:t[0].given)||void 0===n?void 0:n.join(" ")," ").concat(null==i||null===(a=i.name)||void 0===a?void 0:a[0].family),c="".concat(parseInt((0,A.age)(i.birthDate)),", ").concat((0,D.Z)(i.gender)),u="".concat(l," ").concat(c);return!s&&l.trim().length>25?r().createElement(o.Z,{className:B.tooltip,align:"start",direction:"bottom",tooltipText:u},r().createElement("span",{className:B.patientName},l.slice(0,25)+"...")):r().createElement(r().Fragment,null,r().createElement("span",{className:B.patientName},l," "),r().createElement("span",{className:B.patientInfo},parseInt((0,A.age)(i.birthDate)),", ",(0,D.Z)(i.gender)))};const $=function(){var e=(0,d.useTranslation)().t,t=(0,A.usePatient)().patient,n="tablet"===(0,A.useLayoutType)(),o=q((0,a.useState)(!0),2),f=o[0],_=o[1],g=q((0,a.useState)(!1),2),h=g[0],v=g[1],b=(0,A.useAssignedExtensions)("patient-chart-dashboard-slot").map((function(e){return e.id})),y=(0,A.useVisit)(null==t?void 0:t.id),k=y.currentVisit,w=y.isValidating,S=r().useCallback((function(){return function(e,t){var n=F(),a=n.getState(),r=function(e){if(Z[e])return Z[e];var t,n,a,r,o=(0,j.getExtensionRegistration)(e);if(o)return{name:o.name,title:M(o),preferredWindowSize:null!==(a=null===(t=o.meta)||void 0===t?void 0:t.screenSize)&&void 0!==a?a:"normal",load:o.load,type:null!==(r=null===(n=o.meta)||void 0===n?void 0:n.type)&&void 0!==r?r:"form"};throw new Error("No workspace named '".concat(e,"' has been registered."))}(e),o=W(I({},r),{closeWorkspace:function(){return G(e,!(arguments.length>0&&void 0!==arguments[0])||arguments[0])},promptBeforeClosing:function(t){return function(e,t){T[e]=t}(e,t)},additionalProps:t}),i=a.openWorkspaces.filter((function(e){return e.type==o.type}));if(0==i.length)n.setState(W(I({},a),{openWorkspaces:[o].concat(V(a.openWorkspaces))}));else{var s=a.openWorkspaces.findIndex((function(t){return t.name==e})),l=z(i[0].name);if(s>=0){var c=V(a.openWorkspaces);c.splice(s,1),a.openWorkspaces[s].additionalProps=o.additionalProps;var u=[a.openWorkspaces[s]].concat(V(c));n.setState(W(I({},a),{openWorkspaces:u}))}else if(!l||l()){var p,m=null!==(p=i[0].title)&&void 0!==p?p:i[0].name,d={title:(0,A.translateFrom)("@openmrs/esm-patient-chart-app","activeFormWarning","There is an active form open in the workspace"),body:(0,A.translateFrom)("@openmrs/esm-patient-chart-app","workspaceModalText","Launching a new form in the workspace could cause you to lose unsaved work on the ".concat(m," form."),{formName:m}),onConfirm:function(){var e=n.getState();n.setState({openWorkspaces:[o].concat(V(e.openWorkspaces.filter((function(e){return e.type!=o.type})))),prompt:null})},confirmText:(0,A.translateFrom)("@openmrs/esm-patient-chart-app","openAnyway","Open anyway")};n.setState(W(I({},a),{prompt:d}))}else{var f=n.getState();n.setState(W(I({},f),{openWorkspaces:[o].concat(V(f.openWorkspaces.filter((function(e){return e.type!=o.type}))))}))}}}("start-visit-workspace-form")}),[]),E=(0,a.useMemo)((function(){return n&&b.length>0}),[b.length,n]),O=w&&null===k,x=!w&&null===k,N=(0,a.useCallback)((function(){return v((function(e){return!e}))}),[]),D=!O&&x,C=localStorage.getItem("fromPage"),P=function(){C?(0,A.navigate)({to:"".concat(window.spaBase,"/").concat(C)}):(0,A.navigate)({to:"".concat(window.spaBase,"/home")}),_((function(e){return!e})),localStorage.removeItem("fromPage")},X=(0,a.useCallback)((function(){return f?r().createElement(r().Fragment,null,Object.keys(null!=t?t:{}).length>0&&r().createElement(i.Z,{"aria-label":"OpenMRS",className:B.topNavHeader},E&&r().createElement(s.Z,{"aria-label":"Open menu",isCollapsible:!0,className:B.headerMenuButton,onClick:function(e){e.stopPropagation(),N()},isActive:h}),r().createElement(A.ConfigurableLink,{className:B.navLogo,to:"${openmrsSpaBase}/home"},r().createElement("div",{className:B.divider},r().createElement("svg",{role:"img",width:110,height:40},r().createElement("use",{xlinkHref:"#omrs-logo-white"})))),r().createElement("div",{className:B.navDivider}),r().createElement("div",{className:B.patientDetails},r().createElement(U,{patient:t,isTabletView:n})),r().createElement(l.Z,null,D&&r().createElement(c.Z,{className:B.headerGlobalBarButton,"aria-label":e("startVisit","Start a visit"),onClick:S},r().createElement(u.Z,{as:"div",className:B.startVisitButton},e("startVisit","Start a visit"))),r().createElement(c.Z,{className:B.headerGlobalBarCloseButton,"aria-label":e("close","Close"),onClick:P},r().createElement(m.Z,null))),r().createElement(H,{isExpanded:h,toggleSideMenu:N}))):null}),[S,h,n,D,t,E,f,e,N]);return r().createElement(p.Z,{render:X})}}}]);