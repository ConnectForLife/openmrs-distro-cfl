"use strict";(self.webpackChunk_openmrs_esm_patient_appointments_app=self.webpackChunk_openmrs_esm_patient_appointments_app||[]).push([[794],{1405:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(9601),o=n.n(a),i=n(2609),r=n.n(i)()(o());r.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{padding:0;border:0;margin:0;font:inherit;font-size:100%;vertical-align:baseline}button,select,input,textarea{border-radius:0;font-family:inherit}input[type=text]::-ms-clear{display:none}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section{display:block}body{line-height:1}sup{vertical-align:super}sub{vertical-align:sub}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote::before,blockquote::after,q::before,q::after{content:\"\"}table{border-collapse:collapse;border-spacing:0}*{box-sizing:border-box}button{margin:0}html{font-size:100%}body{font-weight:400;font-family:'IBM Plex Sans', 'Helvetica Neue', Arial, sans-serif;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility}code{font-family:'IBM Plex Mono', 'Menlo', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Courier, monospace}strong{font-weight:600}@media screen and (-ms-high-contrast: active){svg{fill:ButtonText}}h1{font-size:2.625rem;font-weight:300;line-height:1.199;letter-spacing:0}h2{font-size:2rem;font-weight:400;line-height:1.25;letter-spacing:0}h3{font-size:1.75rem;font-weight:400;line-height:1.29;letter-spacing:0}h4{font-size:1.25rem;font-weight:400;line-height:1.4;letter-spacing:0}h5{font-size:1rem;font-weight:600;line-height:1.375;letter-spacing:0}h6{font-size:.875rem;font-weight:600;line-height:1.29;letter-spacing:.16px}p{font-size:1rem;font-weight:400;line-height:1.5;letter-spacing:0}a{color:#0f62fe}em{font-style:italic}@keyframes -esm-patient-appointments__appointments-form__skeleton___kLwTK{0%{opacity:.3;transform:scaleX(0);transform-origin:left}20%{opacity:1;transform:scaleX(1);transform-origin:left}28%{transform:scaleX(1);transform-origin:right}51%{transform:scaleX(0);transform-origin:right}58%{transform:scaleX(0);transform-origin:right}82%{transform:scaleX(1);transform-origin:right}83%{transform:scaleX(1);transform-origin:left}96%{transform:scaleX(0);transform-origin:left}100%{opacity:.3;transform:scaleX(0);transform-origin:left}}.-esm-patient-appointments__appointments-form__productiveHeading02___a53cj,.-esm-patient-appointments__appointments-form__formGroup___akpOS span{color:#525252;font-size:1rem;font-weight:600;line-height:1.375;letter-spacing:0}.omrs-breakpoint-lt-desktop .-esm-patient-appointments__appointments-form__formWrapper____zaJ7{background-color:#ededed}.omrs-breakpoint-gt-tablet .-esm-patient-appointments__appointments-form__formWrapper____zaJ7{background-color:#fff}.-esm-patient-appointments__appointments-form__formGroup___akpOS{display:flex;margin-bottom:.25rem;padding:1rem}.omrs-breakpoint-lt-desktop .-esm-patient-appointments__appointments-form__formGroup___akpOS>span{flex:1}.omrs-breakpoint-lt-desktop .-esm-patient-appointments__appointments-form__formGroup___akpOS>div{flex:3}.-esm-patient-appointments__appointments-form__datePickerControl___eaKhw{display:flex}.omrs-breakpoint-lt-desktop .-esm-patient-appointments__appointments-form__formGroup___akpOS{flex-direction:row}.omrs-breakpoint-gt-tablet .-esm-patient-appointments__appointments-form__formGroup___akpOS{flex-direction:column}.-esm-patient-appointments__appointments-form__buttonGroup___TDJWd{display:flex;position:sticky;bottom:0;width:100%}.omrs-breakpoint-lt-desktop .-esm-patient-appointments__appointments-form__buttonGroup___TDJWd{padding:1rem 1.5rem;background-color:#fff}.-esm-patient-appointments__appointments-form__buttonGroup___TDJWd button{max-width:none;width:50%;height:4rem;align-items:flex-start}",""]),r.locals={productiveHeading02:"-esm-patient-appointments__appointments-form__productiveHeading02___a53cj",formGroup:"-esm-patient-appointments__appointments-form__formGroup___akpOS",formWrapper:"-esm-patient-appointments__appointments-form__formWrapper____zaJ7",datePickerControl:"-esm-patient-appointments__appointments-form__datePickerControl___eaKhw",buttonGroup:"-esm-patient-appointments__appointments-form__buttonGroup___TDJWd",skeleton:"-esm-patient-appointments__appointments-form__skeleton___kLwTK"};const l=r},1794:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O});var a=n(9902),o=n.n(a),i=n(4924),r=n(9857),l=n(3565),s=n.n(l),p=n(9513),m=n(2810),c=n(5067),u=n(6642),d=n(350),f=n(5535),_=n(6427),h=n(3172),g=n(7030),v=n(3771),b=n(3066),y=n(9318),k=n(321),T=n.n(k),x=n(1195),E=n.n(x),S=n(3275),w=n.n(S),Z=n(7162),C=n.n(Z),A=n(2094),D=n.n(A),P=n(757),G=n.n(P),z=n(1405),N={};N.styleTagTransform=G(),N.setAttributes=C(),N.insert=w().bind(null,"head"),N.domAPI=E(),N.insertStyleElement=D(),T()(z.Z,N);const L=z.Z&&z.Z.locals?z.Z.locals:void 0;function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,o,i=[],r=!0,l=!1;try{for(n=n.call(e);!(r=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);r=!0);}catch(e){l=!0,o=e}finally{try{r||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var W=[{name:"Scheduled"},{name:"WalkIn"}];const O=function(e){var t,n,l=e.patientUuid,k=e.closeWorkspace,T=(0,i.useTranslation)().t,x="tablet"===(0,b.useLayoutType)(),E=(0,r.kY)().mutate,S=(0,b.useLocations)(),w=(0,b.useSession)(),Z=M((0,a.useState)(""),2),C=Z[0],A=Z[1],D=M((0,a.useState)(""),2),P=D[0],G=D[1],z=M((0,a.useState)(""),2),N=z[0],q=z[1],O=M((0,a.useState)(""),2),j=O[0],I=O[1],X=M((0,a.useState)(new Date),2),J=X[0],U=X[1],B=M((0,a.useState)(s()(new Date).format("hh:mm")),2),F=B[0],H=B[1],K=M((0,a.useState)((new Date).getHours()>=12?"PM":"AM"),2),V=K[0],R=K[1],Y=M((0,a.useState)(""),2),$=Y[0],Q=Y[1];!$&&(null==w||null===(t=w.sessionLocation)||void 0===t?void 0:t.uuid)&&Q(null==w||null===(n=w.sessionLocation)||void 0===n?void 0:n.uuid);var ee,te,ne=(0,y.l9)(),ae=ne.data,oe=ne.isLoading;return(null==ae?void 0:ae.length)&&(te=M(ae,1),ee=te[0].serviceTypes),oe?o().createElement(p.Z,{role:"progressbar"}):o().createElement("div",{className:L.formWrapper},o().createElement("section",{className:L.formGroup},o().createElement("span",null,T("location","Location")),o().createElement(m.Z,{id:"location",invalidText:"Required",labelText:T("selectLocation","Select a location"),light:x,onChange:function(e){return Q(e.target.value)},value:$},$?null:o().createElement(c.Z,{text:T("chooseLocation","Choose a location"),value:""}),(null==S?void 0:S.length)>0&&S.map((function(e){return o().createElement(c.Z,{key:e.uuid,text:e.display,value:e.uuid},e.display)})))),o().createElement("section",{className:L.formGroup},o().createElement("span",null,T("dateTime","Date & Time")),o().createElement("div",{className:L.datePickerControl},o().createElement(u.Z,{datePickerType:"single",dateFormat:"d/m/Y",light:x,value:J,onChange:function(e){var t=M(e,1)[0];return U(t)}},o().createElement(d.Z,{id:"datePickerInput",labelText:T("date","Date"),style:{width:"100%"},placeholder:"dd/mm/yyyy"})),o().createElement(f.Z,{light:x,pattern:"([\\d]+:[\\d]{2})",onChange:function(e){return H(e.target.value)},value:F,style:{marginLeft:"0.125rem",flex:"none"},labelText:T("time","Time"),id:"time-picker"},o().createElement(_.Z,{id:"time-picker-select-1",onChange:function(e){return R(e.target.value)},value:V,labelText:T("time","Time"),"aria-label":T("time","Time")},o().createElement(c.Z,{value:"AM",text:"AM"}),o().createElement(c.Z,{value:"PM",text:"PM"}))))),o().createElement("section",{className:L.formGroup},o().createElement("span",null,T("service","Service")),o().createElement(m.Z,{id:"service",invalidText:"Required",labelText:T("selectService","Select a service"),light:x,onChange:function(e){return q(e.target.value)},value:j},N?null:o().createElement(c.Z,{text:T("chooseService","Select service"),value:""}),(null==ae?void 0:ae.length)>0&&ae.map((function(e){return o().createElement(c.Z,{key:e.uuid,text:e.name,value:e.name},e.name)})))),o().createElement("section",{className:L.formGroup},o().createElement("span",null,T("serviceType","Service Type")),o().createElement(m.Z,{id:"serviceType",invalidText:"Required",labelText:"Select the type of service",light:x,onChange:function(e){return I(e.target.value)},value:j},j?null:o().createElement(c.Z,{text:T("chooseService","Select service type"),value:""}),(null==ee?void 0:ee.length)>0&&ee.map((function(e){return o().createElement(c.Z,{key:e.uuid,text:e.name,value:e.name},e.name)})))),o().createElement("section",{className:L.formGroup},o().createElement("span",null,T("appointmentType","Appointment Type")),o().createElement(m.Z,{disabled:!(null==W?void 0:W.length),id:"appointmentType",invalidText:"Required",labelText:T("selectAppointmentType","Select the type of appointment"),light:x,onChange:function(e){return G(e.target.value)},value:P},P?null:o().createElement(c.Z,{text:T("chooseAppointmentType","Choose appointment type"),value:""}),(null==W?void 0:W.length)>0&&W.map((function(e,t){return o().createElement(c.Z,{key:t,text:e.name,value:e.name},e.name)})))),o().createElement("section",{className:L.formGroup},o().createElement("span",null,T("note","Note")),o().createElement(h.Z,{id:"appointmentNote",light:x,labelText:T("appointmentNoteLabel","Write an additional note"),placeholder:T("appointmentNotePlaceholder","Write any additional points here"),onChange:function(e){return A(e.target.value)}})),o().createElement("section",{className:L.buttonGroup},o().createElement(g.Z,{onClick:k,kind:"secondary"},T("discard","Discard")),o().createElement(g.Z,{disabled:!N,onClick:function(){var e,t;if(j){var n=ee.find((function(e){return e.name===j})),a=null===(e=ae.find((function(e){return e.name===N})))||void 0===e?void 0:e.uuid,o=M((0,v.convertTime12to24)(F,V),2),i=o[0],r=o[1],p=new Date(s()(J).year(),s()(J).month(),s()(J).date(),i,r),m=s()(new Date(s()(J).year(),s()(J).month(),s()(J).date(),i,r)).add(n.duration,"minutes").toDate(),c={appointmentKind:P,serviceUuid:a,startDateTime:s()(p).format(),endDateTime:s()(m).format(),providerUuid:null==w||null===(t=w.currentProvider)||void 0===t?void 0:t.uuid,providers:[{uuid:w.currentProvider.uuid,comments:C}],locationUuid:$,patientUuid:l},u=new AbortController;(0,y.Pc)(c,u).then((function(e){200===e.status&&(k(),(0,b.showToast)({critical:!0,kind:"success",description:T("appointmentNowVisible","It is now visible on the Appointments page"),title:T("appointmentScheduled","Appointment scheduled")})),E("".concat(y.ep))}),(function(e){(0,b.showNotification)({title:T("appointmentFormError","Error scheduling appointment"),kind:"error",critical:!0,description:null==e?void 0:e.message})}))}}},T("saveAndClose","Save and close"))))}},9318:(e,t,n)=>{n.d(t,{Pc:()=>m,ep:()=>l,l9:()=>p,zt:()=>s});var a=n(3565),o=n.n(a),i=n(9857),r=n(3066),l="/ws/rest/v1/appointments/search";function s(e,t,n){var a,s=(0,i.ZP)(l,(function(){return(0,r.openmrsFetch)(l,{method:"POST",signal:n.signal,headers:{"Content-Type":"application/json"},body:{patientUuid:e,startDate:t}})})),p=s.data,m=s.error,c=s.isValidating,u=(null==p||null===(a=p.data)||void 0===a?void 0:a.length)?p.data.sort((function(e,t){return t.startDateTime>e.startDateTime?1:-1})):null,d=null==u?void 0:u.filter((function(e){return o()(e.startDateTime/1e3*1e3).isBefore(o()())})),f=null==u?void 0:u.filter((function(e){return o()(e.startDateTime/1e3*1e3).isAfter(o()())}));return{data:p?{pastAppointments:d,upcomingAppointments:f}:null,isError:m,isLoading:!p&&!m,isValidating:c}}function p(){var e=(0,i.ZP)("/ws/rest/v1/appointmentService/all/full",r.openmrsFetch),t=e.data,n=e.error;return{data:t?t.data:null,isError:n,isLoading:!t&&!n}}function m(e,t){return(0,r.openmrsFetch)("/ws/rest/v1/appointment",{method:"POST",signal:t.signal,headers:{"Content-Type":"application/json"},body:e})}}}]);