"use strict";(self.webpackChunk_openmrs_esm_offline_tools_app=self.webpackChunk_openmrs_esm_offline_tools_app||[]).push([[194],{4065:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(361),o=n.n(a)()((function(e){return e[1]}));o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-offline-tools__shared-page-layout-styles__productiveHeading01___CXsOT{font-size:.875rem;font-weight:600;line-height:1.29;letter-spacing:.16px}.-esm-offline-tools__shared-page-layout-styles__productiveHeading02___ZcF5Z{font-size:1rem;font-weight:600;line-height:1.375;letter-spacing:0}.-esm-offline-tools__shared-page-layout-styles__productiveHeading03___1pkiK,.-esm-offline-tools__shared-page-layout-styles__pageHeaderContainer___BgGBm .-esm-offline-tools__shared-page-layout-styles__pageHeader___nTpsF{font-size:1.25rem;font-weight:400;line-height:1.4;letter-spacing:0}.-esm-offline-tools__shared-page-layout-styles__productiveHeading04___hbvhi{font-size:1.75rem;font-weight:400;line-height:1.29;letter-spacing:0}.-esm-offline-tools__shared-page-layout-styles__bodyShort01___kGD3Y{font-size:.875rem;font-weight:400;line-height:1.29;letter-spacing:.16px}.-esm-offline-tools__shared-page-layout-styles__bodyLong01___UyYAR{font-size:.875rem;font-weight:400;line-height:1.43;letter-spacing:.16px}.-esm-offline-tools__shared-page-layout-styles__label01___MNQ2L{font-size:.75rem;font-weight:400;line-height:1.34;letter-spacing:.32px}.-esm-offline-tools__shared-page-layout-styles__pageHeaderContainer___BgGBm{display:flex;justify-content:space-between;align-items:center;margin:0 1rem 1rem 1rem}.-esm-offline-tools__shared-page-layout-styles__pageHeaderContainer___BgGBm .-esm-offline-tools__shared-page-layout-styles__pageHeader___nTpsF{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}",""]),o.locals={productiveHeading01:"-esm-offline-tools__shared-page-layout-styles__productiveHeading01___CXsOT",productiveHeading02:"-esm-offline-tools__shared-page-layout-styles__productiveHeading02___ZcF5Z",productiveHeading03:"-esm-offline-tools__shared-page-layout-styles__productiveHeading03___1pkiK",pageHeaderContainer:"-esm-offline-tools__shared-page-layout-styles__pageHeaderContainer___BgGBm",pageHeader:"-esm-offline-tools__shared-page-layout-styles__pageHeader___nTpsF",productiveHeading04:"-esm-offline-tools__shared-page-layout-styles__productiveHeading04___hbvhi",bodyShort01:"-esm-offline-tools__shared-page-layout-styles__bodyShort01___kGD3Y",bodyLong01:"-esm-offline-tools__shared-page-layout-styles__bodyLong01___UyYAR",label01:"-esm-offline-tools__shared-page-layout-styles__label01___MNQ2L"};const l=o},215:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(361),o=n.n(a)()((function(e){return e[1]}));o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-offline-tools__last-updated-table-cell__productiveHeading01___RE4rK{font-size:.875rem;font-weight:600;line-height:1.29;letter-spacing:.16px}.-esm-offline-tools__last-updated-table-cell__productiveHeading02___qqO4Q{font-size:1rem;font-weight:600;line-height:1.375;letter-spacing:0}.-esm-offline-tools__last-updated-table-cell__productiveHeading03___N56WM{font-size:1.25rem;font-weight:400;line-height:1.4;letter-spacing:0}.-esm-offline-tools__last-updated-table-cell__productiveHeading04___NYu3O{font-size:1.75rem;font-weight:400;line-height:1.29;letter-spacing:0}.-esm-offline-tools__last-updated-table-cell__bodyShort01___1Xkoo{font-size:.875rem;font-weight:400;line-height:1.29;letter-spacing:.16px}.-esm-offline-tools__last-updated-table-cell__bodyLong01___lBcBD{font-size:.875rem;font-weight:400;line-height:1.43;letter-spacing:.16px}.-esm-offline-tools__last-updated-table-cell__label01___j-tbY{font-size:.75rem;font-weight:400;line-height:1.34;letter-spacing:.32px}.-esm-offline-tools__last-updated-table-cell__errorIcon___X\\+q9m{color:#da1e28}.-esm-offline-tools__last-updated-table-cell__pendingIcon___KBj4y{color:#ff832b}.-esm-offline-tools__last-updated-table-cell__cellContainer___xDUA\\+{display:flex;align-items:center;gap:.25rem}",""]),o.locals={productiveHeading01:"-esm-offline-tools__last-updated-table-cell__productiveHeading01___RE4rK",productiveHeading02:"-esm-offline-tools__last-updated-table-cell__productiveHeading02___qqO4Q",productiveHeading03:"-esm-offline-tools__last-updated-table-cell__productiveHeading03___N56WM",productiveHeading04:"-esm-offline-tools__last-updated-table-cell__productiveHeading04___NYu3O",bodyShort01:"-esm-offline-tools__last-updated-table-cell__bodyShort01___1Xkoo",bodyLong01:"-esm-offline-tools__last-updated-table-cell__bodyLong01___lBcBD",label01:"-esm-offline-tools__last-updated-table-cell__label01___j-tbY",errorIcon:"-esm-offline-tools__last-updated-table-cell__errorIcon___X+q9m",pendingIcon:"-esm-offline-tools__last-updated-table-cell__pendingIcon___KBj4y",cellContainer:"-esm-offline-tools__last-updated-table-cell__cellContainer___xDUA+"};const l=o},7090:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(361),o=n.n(a)()((function(e){return e[1]}));o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-offline-tools__offline-patient-table__productiveHeading01___1SWQ0{font-size:.875rem;font-weight:600;line-height:1.29;letter-spacing:.16px}.-esm-offline-tools__offline-patient-table__productiveHeading02___K9Dzg{font-size:1rem;font-weight:600;line-height:1.375;letter-spacing:0}.-esm-offline-tools__offline-patient-table__productiveHeading03___QIvSG{font-size:1.25rem;font-weight:400;line-height:1.4;letter-spacing:0}.-esm-offline-tools__offline-patient-table__productiveHeading04___v0s2H{font-size:1.75rem;font-weight:400;line-height:1.29;letter-spacing:0}.-esm-offline-tools__offline-patient-table__bodyShort01___mrgNn{font-size:.875rem;font-weight:400;line-height:1.29;letter-spacing:.16px}.-esm-offline-tools__offline-patient-table__bodyLong01___Wowak{font-size:.875rem;font-weight:400;line-height:1.43;letter-spacing:.16px}.-esm-offline-tools__offline-patient-table__label01___xbZtN{font-size:.75rem;font-weight:400;line-height:1.34;letter-spacing:.32px}.-esm-offline-tools__offline-patient-table__tableContainer___rqIiM{background-color:transparent}.-esm-offline-tools__offline-patient-table__tableHeaderContainer___NTOoG{display:grid;grid-template-rows:auto auto;grid-template-columns:1fr 1fr auto auto}.-esm-offline-tools__offline-patient-table__tableHeaderContainer___NTOoG .-esm-offline-tools__offline-patient-table__tableHeader___xRLwl{font-size:1.25rem;font-weight:400;line-height:1.4;letter-spacing:0;color:#525252;padding:.75rem 0 .75rem .75rem;grid-row:1;grid-column:1/span 4}.-esm-offline-tools__offline-patient-table__tableHeaderContainer___NTOoG .-esm-offline-tools__offline-patient-table__tableSearch___pnm9P{grid-row:2;grid-column:2;align-self:end}.-esm-offline-tools__offline-patient-table__tableHeaderContainer___NTOoG .-esm-offline-tools__offline-patient-table__tablePrimaryAction___NgzzW{grid-row:2;grid-column:4;align-self:end}.-esm-offline-tools__offline-patient-table__tableHeaderContainer___NTOoG .-esm-offline-tools__offline-patient-table__tableSecondaryAction___oJ-yy{grid-row:2;grid-column:3;align-self:end}.omrs-breakpoint-gt-tablet .-esm-offline-tools__offline-patient-table__tableHeaderContainer___NTOoG{grid-template-columns:1fr 20% 250px auto auto}.omrs-breakpoint-gt-tablet .-esm-offline-tools__offline-patient-table__tableHeaderContainer___NTOoG .-esm-offline-tools__offline-patient-table__tableHeader___xRLwl{grid-column:1;padding:.75rem 0 .25rem .75rem}.omrs-breakpoint-gt-tablet .-esm-offline-tools__offline-patient-table__tableHeaderContainer___NTOoG .-esm-offline-tools__offline-patient-table__tableSearch___pnm9P{grid-row:1;grid-column:3}.omrs-breakpoint-gt-tablet .-esm-offline-tools__offline-patient-table__tableHeaderContainer___NTOoG .-esm-offline-tools__offline-patient-table__tablePrimaryAction___NgzzW{grid-row:1;grid-column:5}.omrs-breakpoint-gt-tablet .-esm-offline-tools__offline-patient-table__tableHeaderContainer___NTOoG .-esm-offline-tools__offline-patient-table__tableSecondaryAction___oJ-yy{grid-row:1;grid-column:4}",""]),o.locals={productiveHeading01:"-esm-offline-tools__offline-patient-table__productiveHeading01___1SWQ0",productiveHeading02:"-esm-offline-tools__offline-patient-table__productiveHeading02___K9Dzg",productiveHeading03:"-esm-offline-tools__offline-patient-table__productiveHeading03___QIvSG",productiveHeading04:"-esm-offline-tools__offline-patient-table__productiveHeading04___v0s2H",bodyShort01:"-esm-offline-tools__offline-patient-table__bodyShort01___mrgNn",bodyLong01:"-esm-offline-tools__offline-patient-table__bodyLong01___Wowak",label01:"-esm-offline-tools__offline-patient-table__label01___xbZtN",tableContainer:"-esm-offline-tools__offline-patient-table__tableContainer___rqIiM",tableHeaderContainer:"-esm-offline-tools__offline-patient-table__tableHeaderContainer___NTOoG",tableHeader:"-esm-offline-tools__offline-patient-table__tableHeader___xRLwl",tableSearch:"-esm-offline-tools__offline-patient-table__tableSearch___pnm9P",tablePrimaryAction:"-esm-offline-tools__offline-patient-table__tablePrimaryAction___NgzzW",tableSecondaryAction:"-esm-offline-tools__offline-patient-table__tableSecondaryAction___oJ-yy"};const l=o},5143:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(361),o=n.n(a)()((function(e){return e[1]}));o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-offline-tools__patient-name-table-cell__productiveHeading01___lnBiX{font-size:.875rem;font-weight:600;line-height:1.29;letter-spacing:.16px}.-esm-offline-tools__patient-name-table-cell__productiveHeading02___boYmb{font-size:1rem;font-weight:600;line-height:1.375;letter-spacing:0}.-esm-offline-tools__patient-name-table-cell__productiveHeading03___\\+t9na{font-size:1.25rem;font-weight:400;line-height:1.4;letter-spacing:0}.-esm-offline-tools__patient-name-table-cell__productiveHeading04___eaaYs{font-size:1.75rem;font-weight:400;line-height:1.29;letter-spacing:0}.-esm-offline-tools__patient-name-table-cell__bodyShort01___-7CAB{font-size:.875rem;font-weight:400;line-height:1.29;letter-spacing:.16px}.-esm-offline-tools__patient-name-table-cell__bodyLong01___cXcvt{font-size:.875rem;font-weight:400;line-height:1.43;letter-spacing:.16px}.-esm-offline-tools__patient-name-table-cell__label01___QGgmJ{font-size:.75rem;font-weight:400;line-height:1.34;letter-spacing:.32px}.-esm-offline-tools__patient-name-table-cell__cellContainer___EHkf0{display:flex;align-items:center;column-gap:.5rem}",""]),o.locals={productiveHeading01:"-esm-offline-tools__patient-name-table-cell__productiveHeading01___lnBiX",productiveHeading02:"-esm-offline-tools__patient-name-table-cell__productiveHeading02___boYmb",productiveHeading03:"-esm-offline-tools__patient-name-table-cell__productiveHeading03___+t9na",productiveHeading04:"-esm-offline-tools__patient-name-table-cell__productiveHeading04___eaaYs",bodyShort01:"-esm-offline-tools__patient-name-table-cell__bodyShort01___-7CAB",bodyLong01:"-esm-offline-tools__patient-name-table-cell__bodyLong01___cXcvt",label01:"-esm-offline-tools__patient-name-table-cell__label01___QGgmJ",cellContainer:"-esm-offline-tools__patient-name-table-cell__cellContainer___EHkf0"};const l=o},6530:(e,t,n)=>{n.d(t,{Z:()=>v});var a=n(6983),o=n.n(a),l=n(487),r=n.n(l),i=n(631),s=n.n(i),_=n(2052),f=n.n(_),c=n(4010),d=n.n(c),u=n(1469),p=n.n(u),m=n(9329),g=n.n(m),b=n(4065),h={};h.styleTagTransform=g(),h.setAttributes=d(),h.insert=f().bind(null,"head"),h.domAPI=s(),h.insertStyleElement=p(),r()(b.Z,h);const y=b.Z&&b.Z.locals?b.Z.locals:void 0,v=function(e){var t=e.header,n=e.primaryActions,a=e.children;return o().createElement(o().Fragment,null,o().createElement("header",{className:y.pageHeaderContainer},o().createElement("h1",{className:y.pageHeader},t),n),a)}},524:(e,t,n)=>{n.d(t,{_$:()=>f,jH:()=>_,jJ:()=>c});var a=n(1602),o=n.n(a),l=n(7644),r=n(9136);function i(e,t,n,a,o,l,r){try{var i=e[l](r),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,o)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(a,o){var l=e.apply(t,n);function r(e){i(l,a,o,r,s,"next",e)}function s(e){i(l,a,o,r,s,"throw",e)}r(void 0)}))}}function _(){return(0,r.ZP)("offlineTools/offlineRegisteredPatients",s(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.getDynamicOfflineDataEntries)("patient");case 2:return t=e.sent,e.next=5,(0,l.getSynchronizationItems)("patient-registration");case 5:return n=e.sent,e.abrupt("return",n.filter((function(e){return e.fhirPatient&&!t.find((function(t){return t.identifier===e.fhirPatient.id}))})).map((function(e){return e.fhirPatient})));case 7:case"end":return e.stop()}}),e)}))))}function f(){return(0,r.ZP)("offlineTools/offlinePatients",s(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.getDynamicOfflineDataEntries)("patient");case 2:return t=e.sent,e.next=5,Promise.all(t.map(function(){var e=s(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,(0,l.fetchCurrentPatient)(t.identifier);case 3:if(e.t1=n=e.sent,e.t0=null===e.t1,e.t0){e.next=7;break}e.t0=void 0===n;case 7:if(!e.t0){e.next=11;break}e.t2=void 0,e.next=12;break;case 11:e.t2=n.data;case 12:return e.t3=e.t2,e.t4=t,e.abrupt("return",{patient:e.t3,entry:e.t4});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return n=e.sent,e.abrupt("return",n.filter((function(e){return e.patient})));case 7:case"end":return e.stop()}}),e)}))))}function c(e){return(0,r.ZP)("offlineTools/offlinePatient/".concat(e,"/lastSyncState"),s(o().mark((function t(){var n,a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,l.getDynamicOfflineDataEntries)("patient");case 2:return n=t.sent,a=n.find((function(t){return t.identifier===e})),t.abrupt("return",null==a?void 0:a.syncState);case 5:case"end":return t.stop()}}),t)}))))}},1933:(e,t,n)=>{n.d(t,{Z:()=>$});var a=n(1602),o=n.n(a),l=n(6983),r=n.n(l),i=n(9784),s=n(7644),_=n(2680),f=n(4008),c=n(341),d=n(8810),u=n(1706),p=n(487),m=n.n(p),g=n(631),b=n.n(g),h=n(2052),y=n.n(h),v=n(4010),w=n.n(v),H=n(1469),S=n.n(H),T=n(9329),x=n.n(T),C=n(215),E={};E.styleTagTransform=x(),E.setAttributes=w(),E.insert=y().bind(null,"head"),E.domAPI=b(),E.insertStyleElement=S(),m()(C.Z,E);const P=C.Z&&C.Z.locals?C.Z.locals:void 0;function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function N(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const z=function(e){var t=e.patientUuid,n=e.isSyncing,a=e.lastSyncState,o=(0,_.useTranslation)().t,l=function(){return n?r().createElement(r().Fragment,null,r().createElement(c.Z,{className:P.pendingIcon}),o("offlinePatientsTableLastUpdatedDownloading","Downloading...")):a?function(e){var t=(0,s.getDynamicOfflineDataHandlers)().filter((function(e){return"patient"===e.type})).map((function(e){return e.id})),n=N(e.succeededHandlers).concat(N(e.erroredHandlers));return t.some((function(e){return!n.includes(e)}))}(a)?r().createElement(r().Fragment,null,r().createElement(d.Z,{className:P.errorIcon}),o("offlinePatientsTableLastUpdatedOutdatedData","Outdated data")):a.erroredHandlers.length>0?r().createElement(r().Fragment,null,r().createElement(d.Z,{className:P.errorIcon}),r().createElement(i.Link,{onClick:function(){return(0,s.navigate)({to:"".concat(window.getOpenmrsSpaBase(),"offline-tools/patients/").concat(t,"/offline-data")})}},a.erroredHandlers.length," ",1===a.erroredHandlers.length?o("offlinePatientsTableLastUpdatedError","error"):o("offlinePatientsTableLastUpdatedErrors","errors"))):r().createElement(r().Fragment,null,r().createElement(u.Z,null),a.syncedOn.toLocaleDateString()):r().createElement(r().Fragment,null,r().createElement(d.Z,{className:P.errorIcon}),o("offlinePatientsTableLastUpdatedNotYetSynchronized","Not synchronized"))};return r().createElement("div",{className:P.cellContainer},r().createElement(l,null))};var A=n(7090),O={};O.styleTagTransform=x(),O.setAttributes=w(),O.insert=y().bind(null,"head"),O.domAPI=b(),O.insertStyleElement=S(),m()(A.Z,O);const Z=A.Z&&A.Z.locals?A.Z.locals:void 0;var D=n(5143),I={};I.styleTagTransform=x(),I.setAttributes=w(),I.insert=y().bind(null,"head"),I.domAPI=b(),I.insertStyleElement=S(),m()(D.Z,I);const L=D.Z&&D.Z.locals?D.Z.locals:void 0,B=function(e){var t=e.patient,n=e.isNewlyRegistered,a=void 0!==n&&n,o=(0,_.useTranslation)().t,l="".concat(t.name[0].given.join(" ")," ").concat(t.name[0].family);return r().createElement("div",{className:L.cellContainer},r().createElement(i.Link,{onClick:function(){return(0,s.navigate)({to:"".concat(window.getOpenmrsSpaBase(),"patient/").concat(t.id,"/chart")})}},l),a&&r().createElement(i.Tag,{type:"magenta"},o("offlinePatientsTableNameNewlyRegistered","New")))};var G=n(7099),R=n(524);function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function j(e,t,n,a,o,l,r){try{var i=e[l](r),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,o)}function M(e){return function(){var t=this,n=arguments;return new Promise((function(a,o){var l=e.apply(t,n);function r(e){j(l,a,o,r,i,"next",e)}function i(e){j(l,a,o,r,i,"throw",e)}r(void 0)}))}}function F(){return F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},F.apply(this,arguments)}function Y(e){return function(e){if(Array.isArray(e))return U(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Q(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(e,t){if(e){if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}var X=function(e){var t=e.showHeader;return r().createElement(i.TableContainer,{className:Z.tableContainer},r().createElement("div",{className:Z.tableHeaderContainer},t&&r().createElement(i.SkeletonText,{heading:!0,width:"20%",className:Z.tableHeader}),r().createElement(i.SearchSkeleton,{className:Z.tableSearch})),r().createElement(i.DataTableSkeleton,{showToolbar:!1,showHeader:!1}))};function W(e){var t=e.rowIds,n=e.headers,a=e.cellsById,o=e.inputValue,l=e.getCellId;return t.filter((function(e){return n.some((function(t){var n,r,i,s=t.key,_=l(e,s),f=a[_].value;return(null!==(i=null!==(r=null==f||null===(n=f.filterableValue)||void 0===n?void 0:n.toString())&&void 0!==r?r:null==f?void 0:f.toString())&&void 0!==i?i:"").replace(/\s/g,"").toLowerCase().includes(o.replace(/\s/g,"").toLowerCase())}))}))}function q(e){return K.apply(this,arguments)}function K(){return(K=M(o().mark((function e(t){var n,a,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.getDynamicOfflineDataEntries)("patient");case 2:return n=e.sent,a=n.map((function(e){return e.identifier})),l=t.filter((function(e){return a.includes(e)})),e.next=7,Promise.all(l.map((function(e){return(0,s.syncDynamicOfflineData)("patient",e)})));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e){return V.apply(this,arguments)}function V(){return V=M(o().mark((function e(t){var n,a,l,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.getDynamicOfflineDataEntries)("patient");case 2:return n=e.sent,e.next=5,(0,s.getFullSynchronizationItems)("patient-registration");case 5:return a=e.sent,l=t.filter((function(e){return n.some((function(t){return t.identifier===e}))})),r=t.filter((function(e){return!l.includes(e)})),i=Y(l.map((function(e){return(0,s.removeDynamicOfflineData)("patient",e)}))).concat(Y(r.map(function(){var e=M(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=a.find((function(e){return e.content.fhirPatient.id===t})))){e.next=4;break}return e.next=4,(0,s.deleteSynchronizationItem)(n.id);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))),e.next=11,Promise.all(i);case 11:case"end":return e.stop()}}),e)}))),V.apply(this,arguments)}const $=function(e){var t,n,a,c,d=e.isInteractive,u=e.showHeader,p=(0,_.useTranslation)().t,m=(0,s.useLayoutType)(),g=(0,R._$)(),b=(0,R.jH)(),h="desktop"===m?"sm":void 0,y=(a=(0,l.useState)([]),c=2,function(e){if(Array.isArray(e))return e}(a)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,o,l=[],r=!0,i=!1;try{for(n=n.call(e);!(r=(a=n.next()).done)&&(l.push(a.value),!t||l.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==n.return||n.return()}finally{if(i)throw o}}return l}}(a,c)||Q(a,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=y[0],w=y[1],H=function(){var e=(0,_.useTranslation)().t;return(0,l.useMemo)((function(){return[{key:"name",header:e("offlinePatientsTableHeaderName","Name")},{key:"lastUpdated",header:e("offlinePatientsTableHeaderLastUpdated","Last updated")},{key:"gender",header:e("offlinePatientsTableHeaderGender","Gender")},{key:"age",header:e("offlinePatientsTableHeaderAge","Age")}]}),[e])}(),S=function(e){var t=(0,R._$)(),n=(0,R.jH)();return(0,l.useMemo)((function(){var a,o,l=[],i=function(t,n,a){return{id:t.id,name:{value:r().createElement(B,{key:t.id,patient:t,isNewlyRegistered:n}),filterableValue:JSON.stringify(t.name)},lastUpdated:n?"--":r().createElement(z,{key:t.id,patientUuid:t.id,isSyncing:e.includes(t.id),lastSyncState:a}),gender:(0,f.Z)(t.gender),age:t.birthDate?(0,s.age)(t.birthDate):""}},_=!0,c=!1,d=void 0;try{for(var u,p=(null!==(a=n.data)&&void 0!==a?a:[])[Symbol.iterator]();!(_=(u=p.next()).done);_=!0){var m=u.value;l.push(i(m,!0))}}catch(e){c=!0,d=e}finally{try{_||null==p.return||p.return()}finally{if(c)throw d}}var g=!0,b=!1,h=void 0;try{for(var y,v=(null!==(o=t.data)&&void 0!==o?o:[])[Symbol.iterator]();!(g=(y=v.next()).done);g=!0){var w=y.value,H=w.patient,S=w.entry;l.push(i(H,!1,S.syncState))}}catch(e){b=!0,h=e}finally{try{g||null==v.return||v.return()}finally{if(b)throw h}}return l}),[e,t.data,n.data])}(v),T=(t=M(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map((function(e){return e.id})),w(n),e.next=4,q(n).finally((function(){return w([])}));case 4:g.mutate(),b.mutate();case 6:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),x=function(){var e=M(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,s.showModal)("offline-tools-confirmation-modal",{title:p("offlinePatientsTableDeleteConfirmationModalTitle","Remove offline patients"),children:p("offlinePatientsTableDeleteConfirmationModalContent","Are you sure that you want to remove all selected patients from the offline list? Their charts will no longer be available in offline mode and any newly registered patient will be permanently deleted."),confirmText:p("offlinePatientsTableDeleteConfirmationModalConfirm","Remove patients"),cancelText:p("offlinePatientsTableDeleteConfirmationModalCancel","Cancel"),closeModal:function(){return n()},onConfirm:M(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(t.map((function(e){return e.id})));case 2:g.mutate(),b.mutate();case 4:case"end":return e.stop()}}),e)})))});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return g.isValidating||b.isValidating?r().createElement(X,{showHeader:u}):r().createElement(r().Fragment,null,r().createElement(i.DataTable,{rows:S,headers:H,filterRows:W},(function(e){var t=e.rows,a=e.headers,o=e.getTableProps,l=e.getHeaderProps,s=e.getRowProps,_=e.getTableContainerProps,f=e.getSelectionProps,c=e.onInputChange,m=e.selectedRows;return r().createElement(i.TableContainer,F({className:Z.tableContainer},_()),r().createElement("div",{className:Z.tableHeaderContainer},u&&r().createElement("h4",{className:Z.tableHeader},p("offlinePatientsTableTitle","Offline patients")),0===m.length&&r().createElement(i.Search,{className:Z.tableSearch,labelText:p("offlinePatientsTableSearchLabel","Search this list"),placeholder:p("offlinePatientsTableSearchPlaceholder","Search this list"),size:h,onChange:c,light:!0}),m.length>0&&r().createElement(r().Fragment,null,r().createElement(i.Button,{className:Z.tableSecondaryAction,kind:"ghost",size:h,renderIcon:G.Z,onClick:function(){return T(m)}},1===m.length?p("offlinePatientsTableUpdatePatient","Update patient"):p("offlinePatientsTableUpdatePatients","Update patients")),r().createElement(i.Button,{className:Z.tablePrimaryAction,kind:"danger",size:h,onClick:function(){return x(m)}},p("offlinePatientsTableRemoveFromOfflineList","Remove from list")))),r().createElement(i.Table,F({},o(),{useZebraStyles:!0}),r().createElement(i.TableHead,null,r().createElement(i.TableRow,null,d&&r().createElement(i.TableSelectAll,F({},f())),a.map((function(e){return r().createElement(i.TableHeader,F({},l({header:e}),{isSortable:!0}),e.header)})))),r().createElement(i.TableBody,null,t.map((function(e){return r().createElement(i.TableRow,F({},s({row:e})),d&&r().createElement(i.TableSelectRow,F({},f({row:e}))),e.cells.map((function(e){var t;return r().createElement(i.TableCell,{key:e.id},null!==(n=null===(t=e.value)||void 0===t?void 0:t.value)&&void 0!==n?n:e.value)})))})))))})))}}}]);