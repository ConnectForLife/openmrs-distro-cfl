"use strict";(self.webpackChunk_openmrs_esm_patient_forms_app=self.webpackChunk_openmrs_esm_patient_forms_app||[]).push([[474],{5497:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(9601),a=n.n(r),o=n(2609),i=n.n(o)()(a());i.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}:root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-forms__offline-forms-styles__productiveHeading01___HW2wY{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px);margin-bottom:.5rem}.-esm-patient-forms__offline-forms-styles__productiveHeading03___CWOKE,.-esm-patient-forms__offline-forms-styles__pageHeaderContainer___IUuvp .-esm-patient-forms__offline-forms-styles__pageHeader___R94iz{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0);margin-bottom:.5rem}.-esm-patient-forms__offline-forms-styles__productiveHeading04___tgV7v{font-size:var(--cds-heading-04-font-size, 1.75rem);font-weight:var(--cds-heading-04-font-weight, 400);line-height:var(--cds-heading-04-line-height, 1.28572);letter-spacing:var(--cds-heading-04-letter-spacing, 0)}.-esm-patient-forms__offline-forms-styles__bodyLong01___lKbvE{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}.-esm-patient-forms__offline-forms-styles__bodyShort01___HZE4C{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-patient-forms__offline-forms-styles__label01___Rd3u7{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px)}.-esm-patient-forms__offline-forms-styles__pageHeaderContainer___IUuvp{display:flex;justify-content:space-between;align-items:center;margin:0 1rem 1rem 1rem}.-esm-patient-forms__offline-forms-styles__pageHeaderContainer___IUuvp .-esm-patient-forms__offline-forms-styles__pageHeader___R94iz{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.-esm-patient-forms__offline-forms-styles__contentContainer___TEKTs{margin:0 1rem}.-esm-patient-forms__offline-forms-styles__tableHeaderContainer___raVpJ{display:grid;grid-template-columns:1fr 50%}.-esm-patient-forms__offline-forms-styles__tableHeaderContainer___raVpJ .-esm-patient-forms__offline-forms-styles__tableSearch___wk53Z{grid-column:2;align-self:end}.omrs-breakpoint-gt-tablet .-esm-patient-forms__offline-forms-styles__tableHeaderContainer___raVpJ{grid-template-columns:1fr 250px}.omrs-breakpoint-gt-tablet .-esm-patient-forms__offline-forms-styles__tableHeaderContainer___raVpJ .-esm-patient-forms__offline-forms-styles__tableSearch___wk53Z{grid-column:3}.-esm-patient-forms__offline-forms-styles__availableOfflineToggle___oD4dD .cds--toggle__switch{margin-top:0 !important}.-esm-patient-forms__offline-forms-styles__availableOfflineToggle___oD4dD .cds--toggle__label-text{display:none}.-esm-patient-forms__offline-forms-styles__availableOfflineToggleSkeleton___jhTe2{width:2rem;height:1rem}",""]),i.locals={productiveHeading01:"-esm-patient-forms__offline-forms-styles__productiveHeading01___HW2wY",productiveHeading03:"-esm-patient-forms__offline-forms-styles__productiveHeading03___CWOKE",pageHeaderContainer:"-esm-patient-forms__offline-forms-styles__pageHeaderContainer___IUuvp",pageHeader:"-esm-patient-forms__offline-forms-styles__pageHeader___R94iz",productiveHeading04:"-esm-patient-forms__offline-forms-styles__productiveHeading04___tgV7v",bodyLong01:"-esm-patient-forms__offline-forms-styles__bodyLong01___lKbvE",bodyShort01:"-esm-patient-forms__offline-forms-styles__bodyShort01___HZE4C",label01:"-esm-patient-forms__offline-forms-styles__label01___Rd3u7",contentContainer:"-esm-patient-forms__offline-forms-styles__contentContainer___TEKTs",tableHeaderContainer:"-esm-patient-forms__offline-forms-styles__tableHeaderContainer___raVpJ",tableSearch:"-esm-patient-forms__offline-forms-styles__tableSearch___wk53Z",availableOfflineToggle:"-esm-patient-forms__offline-forms-styles__availableOfflineToggle___oD4dD",availableOfflineToggleSkeleton:"-esm-patient-forms__offline-forms-styles__availableOfflineToggleSkeleton___jhTe2"};const s=i},4450:(e,t,n)=>{n.d(t,{MS:()=>u,cq:()=>_});var r=n(5047),a=n.n(r),o=n(3565),i=n.n(o),s=n(9857),l=n(906),f=n(8179);function c(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){c(o,r,a,i,s,"next",e)}function s(e){c(o,r,a,i,s,"throw",e)}i(void 0)}))}}function _(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=(0,l.useConfig)(),r=n.showConfigurableForms,o=n.customFormsUrl,i=n.showHtmlFormEntryForms,c=r?o.concat("?patientUuid=".concat(t)):i?f.lA:f.HW;return(0,s.ZP)([c,e],m(a().mark((function t(){var n,o,i,s,f,m;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,(0,l.openmrsFetch)(c);case 3:if(i=t.sent,f=r?null==i?void 0:i.data.results:null!==(s=null===(n=i.data)||void 0===n||null===(o=n.results)||void 0===o?void 0:o.filter((function(e){return e.published&&!/component/i.test(e.name)})))&&void 0!==s?s:[],e){t.next=8;break}return t.abrupt("return",f);case 8:return t.next=10,(0,l.getDynamicOfflineDataEntries)("form");case 10:return m=t.sent,t.abrupt("return",f.filter((function(e){return m.some((function(t){return t.identifier===e.uuid}))})));case 12:case"end":return t.stop()}}),t)}))))}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i()(new Date).startOf("day").subtract(500,"day").toDate(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i()(new Date).endOf("day").toDate(),r="/ws/rest/v1/encounter?v=".concat(f._V,"&patient=").concat(e,"&fromdate=").concat(t.toISOString(),"&todate=").concat(n.toISOString());return(0,s.ZP)(r,(function(e){return(0,l.openmrsFetch)(e)}))}function u(e,t,n){var r,a,o,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=_(i,e),l=d(e,t,n),f=null!==(o=null===(r=l.data)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.results)&&void 0!==o?o:[],c=s.data?p(s.data,f):void 0;return{data:c,error:s.error,isValidating:s.isValidating||l.isValidating,allForms:s.data}}function p(e,t){return e.map((function(e){var n=t.filter((function(t){var n;return(null===(n=t.form)||void 0===n?void 0:n.uuid)===(null==e?void 0:e.uuid)})).sort((function(e,t){return new Date(t.encounterDatetime).getTime()-new Date(e.encounterDatetime).getTime()})),r=n.length>0?new Date(null==n?void 0:n[0].encounterDatetime):void 0;return{form:e,associatedEncounters:n,lastCompleted:r}}))}},5186:(e,t,n)=>{n.d(t,{LD:()=>o,nY:()=>s});var r=n(9857),a=n(906);function o(e,t){var n=t.some((function(t){return t.formUuid===e.uuid})),r=e.resources.some(i);return!n&&r}function i(e){return"AmpathJsonSchema"===e.dataType||"JSON schema"===e.name}function s(){return(0,r.ZP)("dynamicFormEntries",(function(){return(0,a.getDynamicOfflineDataEntries)("form")}))}},4474:(e,t,n)=>{n.r(t),n.d(t,{default:()=>F});var r=n(5047),a=n.n(r),o=n(268),i=n.n(o),s=n(4924),l=n(1740),f=n(906),c=n(5186),m=n(4450);function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(){var e,t,n,r=(0,m.cq)(),a=(0,f.useConfig)();return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){_(e,t,n[t])}))}return e}({},r),n=null!=(n={data:null===(e=r.data)||void 0===e?void 0:e.filter((function(e){return(0,c.LD)(e,a.htmlFormEntryForms)}))})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t}var u=n(6062),p=n.n(u),g=n(4036),v=n.n(g),h=n(6793),b=n.n(h),y=n(7892),w=n.n(y),O=n(1173),S=n.n(O),H=n(2464),E=n.n(H),D=n(5497),T={};T.styleTagTransform=E(),T.setAttributes=w(),T.insert=b().bind(null,"head"),T.domAPI=v(),T.insertStyleElement=S(),p()(D.Z,T);const C=D.Z&&D.Z.locals?D.Z.locals:void 0;function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function x(){return x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},x.apply(this,arguments)}function j(e){var t,n,r,m,_,d=e.form,u=e.disabled,p=(0,s.useTranslation)().t,g=(m=(0,o.useState)(!1),_=2,function(e){if(Array.isArray(e))return e}(m)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw a}}return o}}(m,_)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(m,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=g[0],h=g[1],b=(0,c.nY)(),y=null===(t=b.data)||void 0===t?void 0:t.some((function(e){return e.identifier===d.uuid})),w=(n=a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h(!0),e.prev=1,!t){e.next=9;break}return e.next=5,(0,f.putDynamicOfflineData)("form",d.uuid);case 5:return e.next=7,(0,f.syncDynamicOfflineData)("form",d.uuid);case 7:e.next=11;break;case 9:return e.next=11,(0,f.removeDynamicOfflineData)("form",d.uuid);case 11:return e.prev=11,h(!1),b.mutate(),e.finish(11);case 15:case"end":return e.stop()}}),e,null,[[1,,11,15]])})),r=function(){var e=this,t=arguments;return new Promise((function(r,a){var o=n.apply(e,t);function i(e){k(o,r,a,i,s,"next",e)}function s(e){k(o,r,a,i,s,"throw",e)}i(void 0)}))},function(e){return r.apply(this,arguments)});return b.isValidating?i().createElement(l.uKo,{className:C.availableOfflineToggleSkeleton}):i().createElement("div",null,i().createElement(l.ZDl,{"aria-label":p("offlineToggle","Offline toggle"),id:"".concat(d.uuid,"-offline-toggle"),className:C.availableOfflineToggle,labelA:"",labelB:"",labelText:"",size:"sm",toggled:y,disabled:u||v||b.isValidating,onToggle:w}))}const F=function(e){var t,n,r,a=e.canMarkFormsAsOffline,o=(0,s.useTranslation)().t,c=d(),m=(0,f.useLayoutType)(),_=(0,f.isDesktop)(m)?"sm":void 0,u=[{key:"formName",header:o("offlineFormsTableFormNameHeader","Form name")},{key:"availableOffline",header:o("offlineFormsTableFormAvailableOffline","Offline")}],p=null!==(n=null===(t=c.data)||void 0===t?void 0:t.map((function(e){return{id:e.uuid,formName:e.name,availableOffline:i().createElement(j,{form:e,disabled:!a})}})))&&void 0!==n?n:[];return i().createElement(i().Fragment,null,i().createElement("header",{className:C.pageHeaderContainer},i().createElement("h1",{className:C.pageHeader},o("offlineFormsTitle","Offline forms"))),i().createElement("main",{className:C.contentContainer},i().createElement(l.wQF,{rows:p,headers:u,size:"sm",useZebraStyles:!0},(function(e){var t=e.rows,n=e.headers,a=e.getTableProps,s=e.getHeaderProps,f=e.getRowProps,c=e.getTableContainerProps,m=e.onInputChange;return i().createElement(l.xJi,x({},c()),i().createElement("div",{className:C.tableHeaderContainer},i().createElement(l.olm,{className:C.tableSearch,labelText:o("offlinePatientsTableSearchLabel","Search this list"),placeholder:o("offlinePatientsTableSearchPlaceholder","Search this list"),size:_,onChange:m,light:!0})),i().createElement(l.iA_,x({},a(),{isSortable:!0,useZebraStyles:!0}),i().createElement(l.ssF,null,i().createElement(l.SCH,null,n.map((function(e){return i().createElement(l.xDH,x({},s({header:e}),{isSortable:!0}),e.header)})))),i().createElement(l.RMI,null,t.map((function(e){return i().createElement(l.SCH,x({},f({row:e})),e.cells.map((function(e){var t;return i().createElement(l.pj1,{key:e.id},null!==(r=null===(t=e.value)||void 0===t?void 0:t.value)&&void 0!==r?r:e.value)})))})))))}))))}}}]);