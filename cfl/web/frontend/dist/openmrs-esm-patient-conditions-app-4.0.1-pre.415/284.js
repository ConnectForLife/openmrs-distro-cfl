(self.webpackChunk_openmrs_esm_patient_conditions_app=self.webpackChunk_openmrs_esm_patient_conditions_app||[]).push([[284,565],{2016:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c});var i=n(9601),o=n.n(i),r=n(2609),a=n.n(r)()(o());a.push([t.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-conditions__conditions-form__condition___RKmYn{padding:1rem .75rem}.-esm-patient-conditions__conditions-form__conditionsList___JiKu0{margin-top:.25rem;background-color:#fff;max-height:14rem;overflow-y:auto;border:1px solid #e0e0e0}.-esm-patient-conditions__conditions-form__conditionsList___JiKu0 li:hover{background-color:#e0e0e0}.-esm-patient-conditions__conditions-form__emptyResults___DwxFa{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px);color:#525252;min-height:1rem}.-esm-patient-conditions__conditions-form__form___nVxA8{display:flex;flex-direction:column;justify-content:space-between;height:calc(100vh - 6rem)}.-esm-patient-conditions__conditions-form__formContainer___O_zJT{margin:1rem}.-esm-patient-conditions__conditions-form__button___V4VKa{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-patient-conditions__conditions-form__tablet___qRP8r{padding:1.5rem 1rem;background-color:#fff}.-esm-patient-conditions__conditions-form__desktop___zBkPN{padding:0rem}",""]),a.locals={condition:"-esm-patient-conditions__conditions-form__condition___RKmYn",conditionsList:"-esm-patient-conditions__conditions-form__conditionsList___JiKu0",emptyResults:"-esm-patient-conditions__conditions-form__emptyResults___DwxFa",form:"-esm-patient-conditions__conditions-form__form___nVxA8",formContainer:"-esm-patient-conditions__conditions-form__formContainer___O_zJT",button:"-esm-patient-conditions__conditions-form__button___V4VKa",tablet:"-esm-patient-conditions__conditions-form__tablet___qRP8r",desktop:"-esm-patient-conditions__conditions-form__desktop___zBkPN"};const c=a},264:function(t){t.exports=function(){"use strict";var t="minute",e=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(i,o,r){var a=o.prototype;r.utc=function(t){return new o({date:t,utc:!0,args:arguments})},a.utc=function(e){var n=r(this.toDate(),{locale:this.$L,utc:!0});return e?n.add(this.utcOffset(),t):n},a.local=function(){return r(this.toDate(),{locale:this.$L,utc:!1})};var c=a.parse;a.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),c.call(this,t)};var s=a.init;a.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else s.call(this)};var l=a.utcOffset;a.utcOffset=function(i,o){var r=this.$utils().u;if(r(i))return this.$u?0:r(this.$offset)?l.call(this):this.$offset;if("string"==typeof i&&(i=function(t){void 0===t&&(t="");var i=t.match(e);if(!i)return null;var o=(""+i[0]).match(n)||["-",0,0],r=o[0],a=60*+o[1]+ +o[2];return 0===a?0:"+"===r?a:-a}(i),null===i))return this;var a=Math.abs(i)<=16?60*i:i,c=this;if(o)return c.$offset=a,c.$u=0===i,c;if(0!==i){var s=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(c=this.local().add(a+s,t)).$offset=a,c.$x.$localOffset=s}else c=this.utc();return c};var u=a.format;a.format=function(t){var e=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,e)},a.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*t},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var d=a.toDate;a.toDate=function(t){return"s"===t&&this.$offset?r(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var f=a.diff;a.diff=function(t,e,n){if(t&&this.$u===t.$u)return f.call(this,t,e,n);var i=this.local(),o=r(t).local();return f.call(i,o,e,n)}}}()},6509:(t,e,n)=>{"use strict";n.d(e,{Z:()=>h});var i=n(6062),o=n.n(i),r=n(4036),a=n.n(r),c=n(6793),s=n.n(c),l=n(7892),u=n.n(l),d=n(1173),f=n.n(d),m=n(2464),v=n.n(m),_=n(2016),p={};p.styleTagTransform=v(),p.setAttributes=u(),p.insert=s().bind(null,"head"),p.domAPI=a(),p.insertStyleElement=f(),o()(_.Z,p);const h=_.Z&&_.Z.locals?_.Z.locals:void 0},3284:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>w});var i=n(268),o=n.n(i),r=n(4924),a=n(3565),c=n.n(a),s=(n(264),n(3122)),l=n(3221);const u=function(){return l.Z.Date.now()};var d=/\s/;var f=/^\s+/;const m=function(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&d.test(t.charAt(e)););return e}(t)+1).replace(f,""):t};var v=n(2758),_=/^[-+]0x[0-9a-f]+$/i,p=/^0b[01]+$/i,h=/^0o[0-7]+$/i,g=parseInt;const b=function(t){if("number"==typeof t)return t;if((0,v.Z)(t))return NaN;if((0,s.Z)(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=(0,s.Z)(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=m(t);var n=p.test(t);return n||h.test(t)?g(t.slice(2),n?2:8):_.test(t)?NaN:+t};var y=Math.max,S=Math.min;var T=n(9857),D=n(3385),$=n(906),C=n(4548),E=n(6509);function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Z(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,o,r=[],a=!0,c=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(r.push(i.value),!e||r.length!==e);a=!0);}catch(t){c=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return r}}(t,e)||function(t,e){if(t){if("string"==typeof t)return O(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const w=function(t){var e,n=t.patientUuid,a=t.closeWorkspace,l=t.setHasSubmissibleValue,d=t.submissionNotifier,f=(0,r.useTranslation)().t,m="tablet"===(0,$.useLayoutType)(),v=(0,$.useSession)(),_=(0,T.kY)().mutate,p=Z(o().useState("active"),2),h=p[0],g=p[1],O=Z(o().useState(null),2),w=O[0],x=O[1],k=Z(o().useState(new Date),2),j=k[0],U=k[1],Y=Z(o().useState(!1),2),I=Y[0],M=Y[1],N=Z(o().useState(""),2),A=N[0],z=N[1],H=Z(o().useState(null),2),P=H[0],F=H[1],L=Z(o().useState(null),2),V=L[0],R=L[1];(0,i.useEffect)((function(){l&&l(!!V)}),[V,l]);var K=function(t){R(null),M(!0);var e=t.target.value;z(e),e&&q(e)},q=o().useMemo((function(){return function(t,e,n){var i,o,r,a,c,l,d=0,f=!1,m=!1,v=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function _(e){var n=i,r=o;return i=o=void 0,d=e,a=t.apply(r,n)}function p(t){return d=t,c=setTimeout(g,e),f?_(t):a}function h(t){var n=t-l;return void 0===l||n>=e||n<0||m&&t-d>=r}function g(){var t=u();if(h(t))return T(t);c=setTimeout(g,function(t){var n=e-(t-l);return m?S(n,r-(t-d)):n}(t))}function T(t){return c=void 0,v&&i?_(t):(i=o=void 0,a)}function D(){var t=u(),n=h(t);if(i=arguments,o=this,l=t,n){if(void 0===c)return p(l);if(m)return clearTimeout(c),c=setTimeout(g,e),_(l)}return void 0===c&&(c=setTimeout(g,e)),a}return e=b(e)||0,(0,s.Z)(n)&&(f=!!n.leading,r=(m="maxWait"in n)?y(b(n.maxWait)||0,e):r,v="trailing"in n?!!n.trailing:v),D.cancel=function(){void 0!==c&&clearTimeout(c),d=0,i=l=o=c=void 0},D.flush=function(){return void 0===c?a:T(u())},D}((function(t){if(t){var e=(0,C.De)(t).subscribe((function(t){F(t),M(!1)}),(function(){return(0,$.createErrorHandler)()}));return function(){e.unsubscribe()}}}),500)}),[]),B=o().useCallback((function(t){R(t),z("")}),[]),J=o().useCallback((function(){var t,e,i;if(V){var o={resourceType:"Condition",clinicalStatus:{coding:[{system:"http://terminology.hl7.org/CodeSystem/condition-clinical",code:h}]},code:{coding:[{code:null==V||null===(t=V.concept)||void 0===t?void 0:t.uuid,display:null==V||null===(e=V.concept)||void 0===e?void 0:e.display}]},endDate:w?c()(w).format():null,onsetDateTime:j?c()(j).format():null,subject:{reference:"Patient/".concat(n)},recorder:{reference:"Practitioner/".concat(null==v||null===(i=v.user)||void 0===i?void 0:i.uuid)},recordedDate:(new Date).toISOString()},r=new AbortController,s=(0,C.qz)(o,r).subscribe((function(t){201===t.status&&(null==a||a(),(0,$.showToast)({critical:!0,kind:"success",description:f("conditionNowVisible","It is now visible on the Conditions page"),title:f("conditionSaved","Condition saved")}),_("".concat($.fhirBaseUrl,"/Condition?patient=").concat(n)))}),(function(t){(0,$.createErrorHandler)(),(0,$.showNotification)({title:f("conditionSaveError","Error saving condition"),kind:"error",critical:!0,description:null==t?void 0:t.message})}));return function(){s.unsubscribe()}}}),[h,a,w,_,j,n,V,null==v||null===(e=v.user)||void 0===e?void 0:e.uuid,f]);return(0,i.useEffect)((function(){var t=null==d?void 0:d.subscribe((function(t){t.isSubmitting&&J()}));return function(){null==t||t.unsubscribe()}}),[J,d]),o().createElement("div",{className:E.Z.formContainer},o().createElement(D.Kqy,{gap:7},o().createElement(D.cwH,{legendText:f("condition","Condition")},m?o().createElement(D.mh4,null,o().createElement(D.olm,{size:"lg",id:"conditionsSearch",labelText:f("enterCondition","Enter condition"),placeholder:f("searchConditions","Search conditions"),onChange:K,value:A||(V&&!I?V.display:"")})):o().createElement(D.olm,{size:"lg",id:"conditionsSearch",labelText:f("enterCondition","Enter condition"),placeholder:f("searchConditions","Search conditions"),onChange:K,value:A||(V&&!I?V.display:"")}),o().createElement("div",null,!A||V?null:I?o().createElement(D.kD0,{role:"progressbar"}):P&&P.length?o().createElement("ul",{className:E.Z.conditionsList},P.map((function(t,e){return o().createElement("li",{role:"menuitem",className:E.Z.condition,key:e,onClick:function(){return B(t)}},t.display)}))):o().createElement(D.n9L,{light:m,className:E.Z.emptyResults},o().createElement("span",null,f("noResultsFor","No results for")," ",o().createElement("strong",null,'"',A,'"'))))),o().createElement(D.cwH,{legendText:f("onsetDate","Onset date")},o().createElement(D.Mtg,{id:"onsetDate",datePickerType:"single",dateFormat:"d/m/Y",maxDate:(new Date).toISOString(),placeholder:"dd/mm/yyyy",onChange:function(t){var e=Z(t,1)[0];return U(e)},value:j,light:m},o().createElement(D.aj6,{id:"onsetDateInput",labelText:""}))),o().createElement(D.cwH,{legendText:f("currentStatus","Current status")},o().createElement(D.SYO,{defaultSelected:"active",name:"clinicalStatus",valueSelected:"active",orientation:"vertical",onChange:function(t){return g(t.toString())}},o().createElement(D.EUY,{id:"active",labelText:"Active",value:"active"}),o().createElement(D.EUY,{id:"inactive",labelText:"Inactive",value:"inactive"}))),"inactive"===h&&o().createElement(D.Mtg,{id:"endDate",datePickerType:"single",dateFormat:"d/m/Y",minDate:new Date(j).toISOString(),maxDate:c()().utc().format(),placeholder:"dd/mm/yyyy",onChange:function(t){var e=Z(t,1)[0];return x(e)},value:w,light:m},o().createElement(D.aj6,{id:"endDateInput",labelText:f("endDate","End date")}))))}},4548:(t,e,n)=>{"use strict";n.d(e,{De:()=>c,l4:()=>a,qz:()=>l});var i=n(9857),o=n(2188),r=n(906);function a(t){var e,n,o,a=(0,i.ZP)("".concat(r.fhirBaseUrl,"/Condition?patient=").concat(t),r.openmrsFetch),c=a.data,l=a.error,u=a.isValidating,d=(null==c||null===(e=c.data)||void 0===e?void 0:e.total)>0?null==c||null===(n=c.data)||void 0===n?void 0:n.entry.map((function(t){return null!==(o=t.resource)&&void 0!==o?o:[]})).map(s).sort((function(t,e){return e.onsetDateTime>t.onsetDateTime?1:-1})):null;return{data:c?d:null,isError:l,isLoading:!c&&!l,isValidating:u}}function c(t){return(0,r.openmrsObservableFetch)("/ws/rest/v1/conceptsearch?conceptClasses=".concat("8d4918b0-c2cc-11de-8d13-0010c6dffd0f","&q=").concat(t)).pipe((0,o.U)((function(t){return t.data.results})))}function s(t){var e,n,i,o,r,a;return{clinicalStatus:null===(n=null==t||null===(e=t.clinicalStatus)||void 0===e?void 0:e.coding[0])||void 0===n?void 0:n.code,conceptId:null===(o=null==t||null===(i=t.code)||void 0===i?void 0:i.coding[0])||void 0===o?void 0:o.code,display:null===(a=null==t||null===(r=t.code)||void 0===r?void 0:r.coding[0])||void 0===a?void 0:a.display,onsetDateTime:null==t?void 0:t.onsetDateTime,recordedDate:null==t?void 0:t.recordedDate,id:null==t?void 0:t.id}}function l(t,e){return(0,r.openmrsObservableFetch)("".concat(r.fhirBaseUrl,"/Condition"),{headers:{"Content-Type":"application/json"},method:"POST",body:t,signal:e})}},187:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i=n(3221).Z.Symbol},9001:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var i=n(187),o=Object.prototype,r=o.hasOwnProperty,a=o.toString,c=i.Z?i.Z.toStringTag:void 0;var s=Object.prototype.toString;var l=i.Z?i.Z.toStringTag:void 0;const u=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":l&&l in Object(t)?function(t){var e=r.call(t,c),n=t[c];try{t[c]=void 0;var i=!0}catch(t){}var o=a.call(t);return i&&(e?t[c]=n:delete t[c]),o}(t):function(t){return s.call(t)}(t)}},2168:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i="object"==typeof global&&global&&global.Object===Object&&global},3221:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(2168),o="object"==typeof self&&self&&self.Object===Object&&self;const r=i.Z||o||Function("return this")()},3122:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},3391:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i=function(t){return null!=t&&"object"==typeof t}},2758:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(9001),o=n(3391);const r=function(t){return"symbol"==typeof t||(0,o.Z)(t)&&"[object Symbol]"==(0,i.Z)(t)}}}]);