(self.webpackChunk_openmrs_esm_patient_conditions_app=self.webpackChunk_openmrs_esm_patient_conditions_app||[]).push([[941],{2016:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var i=n(9601),o=n.n(i),r=n(2609),a=n.n(r)()(o());a.push([t.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-conditions__conditions-form__condition___RKmYn{padding:1rem .75rem}.-esm-patient-conditions__conditions-form__conditionsList___JiKu0{margin-top:.25rem;background-color:#fff;max-height:14rem;overflow-y:auto;border:1px solid #e0e0e0}.-esm-patient-conditions__conditions-form__conditionsList___JiKu0 li:hover{background-color:#e0e0e0}.-esm-patient-conditions__conditions-form__emptyResults___DwxFa{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px);color:#525252;min-height:1rem}.-esm-patient-conditions__conditions-form__form___nVxA8{display:flex;flex-direction:column;justify-content:space-between;height:calc(100vh - 6rem)}.-esm-patient-conditions__conditions-form__formContainer___O_zJT{margin:1rem}.-esm-patient-conditions__conditions-form__button___V4VKa{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-patient-conditions__conditions-form__tablet___qRP8r{padding:1.5rem 1rem;background-color:#fff}.-esm-patient-conditions__conditions-form__desktop___zBkPN{padding:0rem}",""]),a.locals={condition:"-esm-patient-conditions__conditions-form__condition___RKmYn",conditionsList:"-esm-patient-conditions__conditions-form__conditionsList___JiKu0",emptyResults:"-esm-patient-conditions__conditions-form__emptyResults___DwxFa",form:"-esm-patient-conditions__conditions-form__form___nVxA8",formContainer:"-esm-patient-conditions__conditions-form__formContainer___O_zJT",button:"-esm-patient-conditions__conditions-form__button___V4VKa",tablet:"-esm-patient-conditions__conditions-form__tablet___qRP8r",desktop:"-esm-patient-conditions__conditions-form__desktop___zBkPN"};const s=a},264:function(t){t.exports=function(){"use strict";var t="minute",e=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(i,o,r){var a=o.prototype;r.utc=function(t){return new o({date:t,utc:!0,args:arguments})},a.utc=function(e){var n=r(this.toDate(),{locale:this.$L,utc:!0});return e?n.add(this.utcOffset(),t):n},a.local=function(){return r(this.toDate(),{locale:this.$L,utc:!1})};var s=a.parse;a.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),s.call(this,t)};var c=a.init;a.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else c.call(this)};var l=a.utcOffset;a.utcOffset=function(i,o){var r=this.$utils().u;if(r(i))return this.$u?0:r(this.$offset)?l.call(this):this.$offset;if("string"==typeof i&&(i=function(t){void 0===t&&(t="");var i=t.match(e);if(!i)return null;var o=(""+i[0]).match(n)||["-",0,0],r=o[0],a=60*+o[1]+ +o[2];return 0===a?0:"+"===r?a:-a}(i),null===i))return this;var a=Math.abs(i)<=16?60*i:i,s=this;if(o)return s.$offset=a,s.$u=0===i,s;if(0!==i){var c=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(a+c,t)).$offset=a,s.$x.$localOffset=c}else s=this.utc();return s};var u=a.format;a.format=function(t){var e=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,e)},a.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*t},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var d=a.toDate;a.toDate=function(t){return"s"===t&&this.$offset?r(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var f=a.diff;a.diff=function(t,e,n){if(t&&this.$u===t.$u)return f.call(this,t,e,n);var i=this.local(),o=r(t).local();return f.call(i,o,e,n)}}}()},6509:(t,e,n)=>{"use strict";n.d(e,{Z:()=>_});var i=n(6062),o=n.n(i),r=n(4036),a=n.n(r),s=n(6793),c=n.n(s),l=n(7892),u=n.n(l),d=n(1173),f=n.n(d),m=n(2464),v=n.n(m),p=n(2016),h={};h.styleTagTransform=v(),h.setAttributes=u(),h.insert=c().bind(null,"head"),h.domAPI=a(),h.insertStyleElement=f(),o()(p.Z,h);const _=p.Z&&p.Z.locals?p.Z.locals:void 0},8941:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>f});var i=n(268),o=n.n(i),r=(n(264),n(4924)),a=n(2444),s=n(3385),c=n(906),l=n(3284),u=n(6509);function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}const f=function(t){var e,n,f=t.closeWorkspace,m=t.patientUuid,v=(0,r.useTranslation)().t,p="tablet"===(0,c.useLayoutType)(),h=(e=o().useState(!1),n=2,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,o,r=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(r.push(i.value),!e||r.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return r}}(e,n)||function(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),_=h[0],b=h[1],g=(0,i.useMemo)((function(){return new a.BehaviorSubject({isSubmitting:!1})}),[]),y=o().useCallback((function(t){t.preventDefault(),g.next({isSubmitting:!0})}),[g]);return o().createElement(s.l09,{className:u.Z.form,onSubmit:y},o().createElement(l.default,{patientUuid:m,closeWorkspace:f,setHasSubmissibleValue:b,submissionNotifier:g}),o().createElement(s.uVA,{className:p?u.Z.tablet:u.Z.desktop},o().createElement(s.zxk,{className:u.Z.button,kind:"secondary",onClick:function(){return f()}},v("cancel","Cancel")),o().createElement(s.zxk,{className:u.Z.button,disabled:!_,kind:"primary",type:"submit"},v("saveAndClose","Save and close"))))}},3284:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>O});var i=n(268),o=n.n(i),r=n(4924),a=n(3565),s=n.n(a),c=(n(264),n(3122)),l=n(3221);const u=function(){return l.Z.Date.now()};var d=/\s/;var f=/^\s+/;const m=function(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&d.test(t.charAt(e)););return e}(t)+1).replace(f,""):t};var v=n(2758),p=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,_=/^0o[0-7]+$/i,b=parseInt;const g=function(t){if("number"==typeof t)return t;if((0,v.Z)(t))return NaN;if((0,c.Z)(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=(0,c.Z)(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=m(t);var n=h.test(t);return n||_.test(t)?b(t.slice(2),n?2:8):p.test(t)?NaN:+t};var y=Math.max,S=Math.min;var T=n(9857),C=n(3385),D=n(906),E=n(4548),$=n(6509);function Z(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function w(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,o,r=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(r.push(i.value),!e||r.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return r}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Z(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const O=function(t){var e,n=t.patientUuid,a=t.closeWorkspace,l=t.setHasSubmissibleValue,d=t.submissionNotifier,f=(0,r.useTranslation)().t,m="tablet"===(0,D.useLayoutType)(),v=(0,D.useSession)(),p=(0,T.kY)().mutate,h=w(o().useState("active"),2),_=h[0],b=h[1],Z=w(o().useState(null),2),O=Z[0],x=Z[1],k=w(o().useState(new Date),2),j=k[0],U=k[1],A=w(o().useState(!1),2),N=A[0],I=A[1],M=w(o().useState(""),2),Y=M[0],z=M[1],H=w(o().useState(null),2),P=H[0],V=H[1],L=w(o().useState(null),2),F=L[0],R=L[1];(0,i.useEffect)((function(){l&&l(!!F)}),[F,l]);var K=function(t){R(null),I(!0);var e=t.target.value;z(e),e&&q(e)},q=o().useMemo((function(){return function(t,e,n){var i,o,r,a,s,l,d=0,f=!1,m=!1,v=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function p(e){var n=i,r=o;return i=o=void 0,d=e,a=t.apply(r,n)}function h(t){return d=t,s=setTimeout(b,e),f?p(t):a}function _(t){var n=t-l;return void 0===l||n>=e||n<0||m&&t-d>=r}function b(){var t=u();if(_(t))return T(t);s=setTimeout(b,function(t){var n=e-(t-l);return m?S(n,r-(t-d)):n}(t))}function T(t){return s=void 0,v&&i?p(t):(i=o=void 0,a)}function C(){var t=u(),n=_(t);if(i=arguments,o=this,l=t,n){if(void 0===s)return h(l);if(m)return clearTimeout(s),s=setTimeout(b,e),p(l)}return void 0===s&&(s=setTimeout(b,e)),a}return e=g(e)||0,(0,c.Z)(n)&&(f=!!n.leading,r=(m="maxWait"in n)?y(g(n.maxWait)||0,e):r,v="trailing"in n?!!n.trailing:v),C.cancel=function(){void 0!==s&&clearTimeout(s),d=0,i=l=o=s=void 0},C.flush=function(){return void 0===s?a:T(u())},C}((function(t){if(t){var e=(0,E.De)(t).subscribe((function(t){V(t),I(!1)}),(function(){return(0,D.createErrorHandler)()}));return function(){e.unsubscribe()}}}),500)}),[]),B=o().useCallback((function(t){R(t),z("")}),[]),W=o().useCallback((function(){var t,e,i;if(F){var o={resourceType:"Condition",clinicalStatus:{coding:[{system:"http://terminology.hl7.org/CodeSystem/condition-clinical",code:_}]},code:{coding:[{code:null==F||null===(t=F.concept)||void 0===t?void 0:t.uuid,display:null==F||null===(e=F.concept)||void 0===e?void 0:e.display}]},endDate:O?s()(O).format():null,onsetDateTime:j?s()(j).format():null,subject:{reference:"Patient/".concat(n)},recorder:{reference:"Practitioner/".concat(null==v||null===(i=v.user)||void 0===i?void 0:i.uuid)},recordedDate:(new Date).toISOString()},r=new AbortController,c=(0,E.qz)(o,r).subscribe((function(t){201===t.status&&(null==a||a(),(0,D.showToast)({critical:!0,kind:"success",description:f("conditionNowVisible","It is now visible on the Conditions page"),title:f("conditionSaved","Condition saved")}),p("".concat(D.fhirBaseUrl,"/Condition?patient=").concat(n)))}),(function(t){(0,D.createErrorHandler)(),(0,D.showNotification)({title:f("conditionSaveError","Error saving condition"),kind:"error",critical:!0,description:null==t?void 0:t.message})}));return function(){c.unsubscribe()}}}),[_,a,O,p,j,n,F,null==v||null===(e=v.user)||void 0===e?void 0:e.uuid,f]);return(0,i.useEffect)((function(){var t=null==d?void 0:d.subscribe((function(t){t.isSubmitting&&W()}));return function(){null==t||t.unsubscribe()}}),[W,d]),o().createElement("div",{className:$.Z.formContainer},o().createElement(C.Kqy,{gap:7},o().createElement(C.cwH,{legendText:f("condition","Condition")},m?o().createElement(C.mh4,null,o().createElement(C.olm,{size:"lg",id:"conditionsSearch",labelText:f("enterCondition","Enter condition"),placeholder:f("searchConditions","Search conditions"),onChange:K,value:Y||(F&&!N?F.display:"")})):o().createElement(C.olm,{size:"lg",id:"conditionsSearch",labelText:f("enterCondition","Enter condition"),placeholder:f("searchConditions","Search conditions"),onChange:K,value:Y||(F&&!N?F.display:"")}),o().createElement("div",null,!Y||F?null:N?o().createElement(C.kD0,{role:"progressbar"}):P&&P.length?o().createElement("ul",{className:$.Z.conditionsList},P.map((function(t,e){return o().createElement("li",{role:"menuitem",className:$.Z.condition,key:e,onClick:function(){return B(t)}},t.display)}))):o().createElement(C.n9L,{light:m,className:$.Z.emptyResults},o().createElement("span",null,f("noResultsFor","No results for")," ",o().createElement("strong",null,'"',Y,'"'))))),o().createElement(C.cwH,{legendText:f("onsetDate","Onset date")},o().createElement(C.Mtg,{id:"onsetDate",datePickerType:"single",dateFormat:"d/m/Y",maxDate:(new Date).toISOString(),placeholder:"dd/mm/yyyy",onChange:function(t){var e=w(t,1)[0];return U(e)},value:j,light:m},o().createElement(C.aj6,{id:"onsetDateInput",labelText:""}))),o().createElement(C.cwH,{legendText:f("currentStatus","Current status")},o().createElement(C.SYO,{defaultSelected:"active",name:"clinicalStatus",valueSelected:"active",orientation:"vertical",onChange:function(t){return b(t.toString())}},o().createElement(C.EUY,{id:"active",labelText:"Active",value:"active"}),o().createElement(C.EUY,{id:"inactive",labelText:"Inactive",value:"inactive"}))),"inactive"===_&&o().createElement(C.Mtg,{id:"endDate",datePickerType:"single",dateFormat:"d/m/Y",minDate:new Date(j).toISOString(),maxDate:s()().utc().format(),placeholder:"dd/mm/yyyy",onChange:function(t){var e=w(t,1)[0];return x(e)},value:O,light:m},o().createElement(C.aj6,{id:"endDateInput",labelText:f("endDate","End date")}))))}},4548:(t,e,n)=>{"use strict";n.d(e,{De:()=>s,l4:()=>a,qz:()=>l});var i=n(9857),o=n(2188),r=n(906);function a(t){var e,n,o,a=(0,i.ZP)("".concat(r.fhirBaseUrl,"/Condition?patient=").concat(t),r.openmrsFetch),s=a.data,l=a.error,u=a.isValidating,d=(null==s||null===(e=s.data)||void 0===e?void 0:e.total)>0?null==s||null===(n=s.data)||void 0===n?void 0:n.entry.map((function(t){return null!==(o=t.resource)&&void 0!==o?o:[]})).map(c).sort((function(t,e){return e.onsetDateTime>t.onsetDateTime?1:-1})):null;return{data:s?d:null,isError:l,isLoading:!s&&!l,isValidating:u}}function s(t){return(0,r.openmrsObservableFetch)("/ws/rest/v1/conceptsearch?conceptClasses=".concat("8d4918b0-c2cc-11de-8d13-0010c6dffd0f","&q=").concat(t)).pipe((0,o.U)((function(t){return t.data.results})))}function c(t){var e,n,i,o,r,a;return{clinicalStatus:null===(n=null==t||null===(e=t.clinicalStatus)||void 0===e?void 0:e.coding[0])||void 0===n?void 0:n.code,conceptId:null===(o=null==t||null===(i=t.code)||void 0===i?void 0:i.coding[0])||void 0===o?void 0:o.code,display:null===(a=null==t||null===(r=t.code)||void 0===r?void 0:r.coding[0])||void 0===a?void 0:a.display,onsetDateTime:null==t?void 0:t.onsetDateTime,recordedDate:null==t?void 0:t.recordedDate,id:null==t?void 0:t.id}}function l(t,e){return(0,r.openmrsObservableFetch)("".concat(r.fhirBaseUrl,"/Condition"),{headers:{"Content-Type":"application/json"},method:"POST",body:t,signal:e})}},187:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i=n(3221).Z.Symbol},9001:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var i=n(187),o=Object.prototype,r=o.hasOwnProperty,a=o.toString,s=i.Z?i.Z.toStringTag:void 0;var c=Object.prototype.toString;var l=i.Z?i.Z.toStringTag:void 0;const u=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":l&&l in Object(t)?function(t){var e=r.call(t,s),n=t[s];try{t[s]=void 0;var i=!0}catch(t){}var o=a.call(t);return i&&(e?t[s]=n:delete t[s]),o}(t):function(t){return c.call(t)}(t)}},2168:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i="object"==typeof global&&global&&global.Object===Object&&global},3221:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(2168),o="object"==typeof self&&self&&self.Object===Object&&self;const r=i.Z||o||Function("return this")()},3122:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},3391:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i=function(t){return null!=t&&"object"==typeof t}},2758:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(9001),o=n(3391);const r=function(t){return"symbol"==typeof t||(0,o.Z)(t)&&"[object Symbol]"==(0,i.Z)(t)}}}]);