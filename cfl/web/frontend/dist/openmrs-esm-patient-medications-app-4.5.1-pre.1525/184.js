"use strict";(globalThis.webpackChunk_openmrs_esm_patient_medications_app=globalThis.webpackChunk_openmrs_esm_patient_medications_app||[]).push([[184],{4017:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(272),o=n.n(r),i=n(2609),a=n.n(i)()(o());a.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-medications__order-basket-action-button__elementContainer___Cv0c2{display:flex;align-items:center;position:relative}.-esm-patient-medications__order-basket-action-button__elementContainer___Cv0c2 .-esm-patient-medications__order-basket-action-button__countTag___qwFY8{position:absolute;transform:scale(0.7);min-width:initial;min-height:initial;background-color:#fa4d56;color:#fff;right:-10px;top:-15px}.-esm-patient-medications__order-basket-action-button__container___wf174{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;width:100%;color:#161616;max-width:none}.-esm-patient-medications__order-basket-action-button__container___wf174:hover{color:#525252}.-esm-patient-medications__order-basket-action-button__container___wf174>span{margin-top:.25rem;font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px);color:#525252}.omrs-breakpoint-gt-tablet .-esm-patient-medications__order-basket-action-button__active___lyWIz{border:.125rem solid;border-color:#007d79;border-color:var(--brand-03);border-radius:50%;background-color:#fff}.omrs-breakpoint-gt-tablet .-esm-patient-medications__order-basket-action-button__active___lyWIz:focus{border-color:var(--brand-03) !important}.omrs-breakpoint-gt-tablet .-esm-patient-medications__order-basket-action-button__elementContainer___Cv0c2{color:#525252}.omrs-breakpoint-lt-desktop .-esm-patient-medications__order-basket-action-button__active___lyWIz{background-color:#edf5ff;color:#0f62fe}.omrs-breakpoint-lt-desktop .-esm-patient-medications__order-basket-action-button__active___lyWIz:hover{color:#0f62fe}.omrs-breakpoint-lt-desktop .-esm-patient-medications__order-basket-action-button__active___lyWIz>span{color:#0f62fe;font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px)}.omrs-breakpoint-lt-desktop .-esm-patient-medications__order-basket-action-button__active___lyWIz svg{fill:#0f62fe}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/medications-summary/order-basket-action-button.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,gFACE,YAAA,CACA,kBAAA,CACA,iBAAA,CAEA,wJACE,iBAAA,CACA,oBAAA,CACA,iBAAA,CACA,kBAAA,CACA,wBAAA,CACA,UDdI,CCeJ,WAAA,CACA,SAAA,CAIJ,yEACE,YAAA,CACA,qBAAA,CACA,sBAAA,CACA,kBAAA,CACA,WAAA,CACA,UAAA,CACA,aDxBM,CCyBN,cAAA,CAEA,+EACE,aD3BM,CC8BR,8EACE,iBCpBS,CC0zBT,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CFpyBA,aDjCM,CCuCR,iGACE,oBAAA,CDGF,oBAAA,CACA,4BAAA,CCFE,iBAAA,CACA,qBD/CI,CCiDJ,uGACE,uCAAA,CAIJ,2GACE,aDnDM,CCyDR,kGACE,wBDnDY,CCoDZ,aD3Ca,CC6Cb,wGACE,aD9CW,CCiDb,uGACE,aDlDW,CGqzBb,2DAAA,CAAA,0DAAA,CAAA,8DAAA,CAAA,mEAAA,CF/vBA,sGACE,YDvDW",sourceRoot:""}]),a.locals={elementContainer:"-esm-patient-medications__order-basket-action-button__elementContainer___Cv0c2",countTag:"-esm-patient-medications__order-basket-action-button__countTag___qwFY8",container:"-esm-patient-medications__order-basket-action-button__container___wf174",active:"-esm-patient-medications__order-basket-action-button__active___lyWIz"};const s=a},4339:(e,t,n)=>{n.d(t,{P4:()=>u,Xm:()=>l,bi:()=>A,mv:()=>d,qs:()=>m});var r=n(3255),o=n(2303),i=n(906),a=n(268),s=n(6217);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){var n=(0,i.useConfig)(),o=n.careSettingUuid,s=n.drugOrderTypeUUID,c="/ws/rest/v1/order?patient=".concat(e,"&careSetting=").concat(o,"&status=").concat(t,"&orderType=").concat(s,"&v=").concat("custom:(uuid,dosingType,orderNumber,accessionNumber,patient:ref,action,careSetting:ref,previousOrder:ref,dateActivated,scheduledDate,dateStopped,autoExpireDate,orderType:ref,encounter:ref,orderer:(uuid,display,person:(display)),orderReason,orderReasonNonCoded,orderType,urgency,instructions,commentToFulfiller,drug:(uuid,display,strength,dosageForm:(display,uuid),concept),dose,doseUnits:ref,frequency:ref,asNeeded,asNeededCondition,quantity,quantityUnits:ref,numRefills,dosingInstructions,duration,durationUnits:ref,route:ref,brandName,dispenseAsWritten)"),l=(0,r.ZP)(e?c:null,i.openmrsFetch),u=l.data,d=l.error,A=l.isLoading,m=l.isValidating,p=l.mutate,_=(0,a.useMemo)((function(){var e,t;return(null==u||null===(e=u.data)||void 0===e?void 0:e.results)?null===(t=u.data.results.filter((function(e){return"Drug Order"===e.orderType.display})))||void 0===t?void 0:t.sort((function(e,t){return t.dateActivated>e.dateActivated?1:-1})):null}),[u]);return{data:u?_:null,error:d,isLoading:A,isValidating:m,mutateOrders:p}}function u(e,t,n,r,o){var a={patient:e,location:r,encounterType:t,encounterDatetime:(new Date).toISOString(),visit:n,obs:[]};return(0,i.openmrsFetch)("/ws/rest/v1/encounter",{headers:{"Content-Type":"application/json"},method:"POST",body:a,signal:null==o?void 0:o.signal}).then((function(e){var t;return null==e||null===(t=e.data)||void 0===t?void 0:t.uuid}))}function d(e,t){return(0,i.openmrsFetch)("/ws/rest/v1/order",{method:"POST",signal:null==t?void 0:t.signal,headers:{"Content-Type":"application/json"},body:e})}function A(){var e,t=(0,o.Z)("/ws/rest/v1/systemsetting/visits.enabled?v=custom:(value)",i.openmrsFetch),n=t.data,r=t.isLoading,s=t.error,c=(0,a.useMemo)((function(){var t;return{systemVisitEnabled:"true"===(null!==(e=null==n||null===(t=n.data)||void 0===t?void 0:t.value)&&void 0!==e?e:"true").toLowerCase(),errorFetchingSystemVisitSetting:s,isLoadingSystemVisitSetting:r}}),[n,r,s]);return c}function m(e){var t,n,o=A(),l=o.systemVisitEnabled,u=o.isLoadingSystemVisitSetting,d=o.errorFetchingSystemVisitSetting,m=(t=(new Date).toISOString().split("T"),n=1,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],p=(0,r.ZP)(u||l||!e?null:"/ws/rest/v1/encounter?patient=".concat(e,"&fromdate=").concat(m,"&limit=1"),i.openmrsFetch),_=(0,s.useVisitOrOfflineVisit)(e),b=(0,a.useMemo)((function(){var e,t,n,r,o,i,a;return u||d?{activeVisitRequired:!1,isLoading:u,error:d,encounterUuid:null,mutate:function(){}}:l?{activeVisitRequired:!0,isLoading:null==_?void 0:_.isLoading,encounterUuid:null==_||null===(e=_.currentVisit)||void 0===e||null===(t=e.encounters)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.uuid,error:null==_?void 0:_.error,mutate:null==_?void 0:_.mutate}:{activeVisitRequired:!1,isLoading:null==p?void 0:p.isLoading,encounterUuid:null==p||null===(r=p.data)||void 0===r||null===(o=r.data)||void 0===o||null===(i=o.results)||void 0===i||null===(a=i[0])||void 0===a?void 0:a.uuid,error:null==p?void 0:p.error,mutate:null==p?void 0:p.mutate}}),[u,d,_,p,l]);return b}},3184:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var r=n(268),o=n.n(r),i=n(4924),a=n(305),s=n(37),c=n(906),l=n(6217),u=n(7622),d=n(1354),A=n.n(d),m=n(1583),p=n.n(m),_=n(7378),b=n.n(_),v=n(5993),f=n.n(v),C=n(4154),g=n.n(C),y=n(8141),h=n.n(y),k=n(4017),w={};w.styleTagTransform=h(),w.setAttributes=f(),w.insert=b().bind(null,"head"),w.domAPI=p(),w.insertStyleElement=g(),A()(k.Z,w);const O=k.Z&&k.Z.locals?k.Z.locals:void 0;var D=n(4600);function E(){return E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},E.apply(this,arguments)}const S=function(){var e,t,n=(0,c.useLayoutType)(),r=(0,i.useTranslation)().t,d=(0,l.useWorkspaces)().workspaces,A=(0,c.useStore)(u.wM).items,m=(0,c.usePatient)().patientUuid,p=null==d||null===(e=d[0])||void 0===e||null===(t=e.name)||void 0===t?void 0:t.match(/order-basket/i),_=(0,u.xA)(A,m),b=(0,D.J)(m).launchOrderBasket;return"tablet"===n?o().createElement(a.zxk,{kind:"ghost",className:"".concat(O.container," ").concat(p?O.active:""),role:"button",tabIndex:0,onClick:b},o().createElement("div",{className:O.elementContainer},o().createElement(s.yT,{size:16})," ",(null==_?void 0:_.length)>0&&o().createElement(a.Vp9,{className:O.countTag},null==_?void 0:_.length)),o().createElement("span",null,r("orderBasket","Order basket"))):o().createElement(a.zxk,{className:p&&O.active,kind:"ghost",size:"sm",renderIcon:function(e){return o().createElement("div",{className:O.elementContainer},o().createElement(s.yT,E({size:20},e))," ",(null==_?void 0:_.length)>0&&o().createElement(a.Vp9,{className:O.countTag},null==_?void 0:_.length))},hasIconOnly:!0,iconDescription:r("medications","Medications"),enterDelayMs:1e3,tooltipAlignment:"center",tooltipPosition:"left",onClick:b})}},7622:(e,t,n)=>{function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){r(e,t,n[t])}))}return e}n.d(t,{RT:()=>a,wM:()=>i,xA:()=>s});var i=(0,n(906).createGlobalStore)("drug-order-basket",{items:{}}),a={setItems:function(e,t){var n,i,a,s=(n=/\/patient\/([a-zA-Z0-9\-]+)\/?/.exec(location.pathname))&&n[1];return{items:(i=o({},e.items),a=r({},s,"function"==typeof t?t():t),a=null!=a?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(a)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(a,e))})),i)}}};function s(e,t){var n;return null!==(n=null==e?void 0:e[t])&&void 0!==n?n:[]}},4600:(e,t,n)=>{n.d(t,{J:()=>a});var r=n(6217),o=n(268),i=n(4339);function a(e){var t=(0,i.bi)().systemVisitEnabled,n=(0,r.useVisitOrOfflineVisit)(e).currentVisit;return(0,o.useMemo)((function(){return{launchOrderBasket:function(){!t||n?(0,r.launchPatientWorkspace)("order-basket-workspace"):(0,r.launchStartVisitPrompt)()}}}),[n,t])}}}]);