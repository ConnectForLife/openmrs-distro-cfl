"use strict";(globalThis.webpackChunk_openmrs_esm_patient_forms_app=globalThis.webpackChunk_openmrs_esm_patient_forms_app||[]).push([[338],{8360:(e,t,n)=>{n.d(t,{Z:()=>l});var r=n(272),o=n.n(r),a=n(2609),i=n.n(a)()(o());i.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}:root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-forms__offline-forms-styles__productiveHeading01___VR54s{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px)}.-esm-patient-forms__offline-forms-styles__productiveHeading03___ES52X,.-esm-patient-forms__offline-forms-styles__pageHeaderContainer___ecJQd .-esm-patient-forms__offline-forms-styles__pageHeader___svGcH{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-patient-forms__offline-forms-styles__productiveHeading04___du0_u{font-size:var(--cds-heading-04-font-size, 1.75rem);font-weight:var(--cds-heading-04-font-weight, 400);line-height:var(--cds-heading-04-line-height, 1.28572);letter-spacing:var(--cds-heading-04-letter-spacing, 0)}.-esm-patient-forms__offline-forms-styles__bodyLong01___i3PY8{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}.-esm-patient-forms__offline-forms-styles__bodyShort01___S0vYz{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-patient-forms__offline-forms-styles__label01___xfyMv{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px)}.-esm-patient-forms__offline-forms-styles__pageHeaderContainer___ecJQd{display:flex;justify-content:space-between;align-items:center;margin:0 1rem 1rem 1rem}.-esm-patient-forms__offline-forms-styles__pageHeaderContainer___ecJQd .-esm-patient-forms__offline-forms-styles__pageHeader___svGcH{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.-esm-patient-forms__offline-forms-styles__contentContainer___lLDEj{margin:0 1rem}.-esm-patient-forms__offline-forms-styles__tableHeaderContainer___cPVP8{display:grid;grid-template-columns:1fr 50%}.-esm-patient-forms__offline-forms-styles__tableHeaderContainer___cPVP8 .-esm-patient-forms__offline-forms-styles__tableSearch___GZer3{grid-column:2;align-self:end}.omrs-breakpoint-gt-tablet .-esm-patient-forms__offline-forms-styles__tableHeaderContainer___cPVP8{grid-template-columns:1fr 250px}.omrs-breakpoint-gt-tablet .-esm-patient-forms__offline-forms-styles__tableHeaderContainer___cPVP8 .-esm-patient-forms__offline-forms-styles__tableSearch___GZer3{grid-column:3}.-esm-patient-forms__offline-forms-styles__availableOfflineToggle___w_RVf .cds--toggle__switch{margin-top:0 !important}.-esm-patient-forms__offline-forms-styles__availableOfflineToggle___w_RVf .cds--toggle__label-text{display:none}.-esm-patient-forms__offline-forms-styles__availableOfflineToggleSkeleton___hD9xS{width:2rem;height:1rem}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/root.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss","webpack://./src/offline-forms/offline-forms.styles.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CAHF,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,uECs0BI,2DAAA,CAAA,0DAAA,CAAA,8DAAA,CAAA,mEAAA,CDl0BJ,4MCk0BI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CD9zBJ,uEC8zBI,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CAAA,sDAAA,CD1zBJ,8DC0zBI,gDAAA,CAAA,+CAAA,CAAA,mDAAA,CAAA,wDAAA,CDtzBJ,+DCszBI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CDlzBJ,2DCkzBI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CCr0BJ,uEACE,YAAA,CACA,6BAAA,CACA,kBAAA,CACA,uBAAA,CAEA,qIAEE,sBAAA,CACA,eAAA,CACA,kBAAA,CAIJ,oEACE,aAAA,CAGF,wEACE,YAAA,CACA,6BAAA,CAEA,uIACE,aAAA,CACA,cAAA,CAIJ,mGACE,+BAAA,CAEA,kKACE,aAAA,CAKF,+FAKE,uBAAA,CAGF,mGACE,YAAA,CAIJ,kFACE,UCfW,CDgBX,WC1BW",sourceRoot:""}]),i.locals={productiveHeading01:"-esm-patient-forms__offline-forms-styles__productiveHeading01___VR54s",productiveHeading03:"-esm-patient-forms__offline-forms-styles__productiveHeading03___ES52X",pageHeaderContainer:"-esm-patient-forms__offline-forms-styles__pageHeaderContainer___ecJQd",pageHeader:"-esm-patient-forms__offline-forms-styles__pageHeader___svGcH",productiveHeading04:"-esm-patient-forms__offline-forms-styles__productiveHeading04___du0_u",bodyLong01:"-esm-patient-forms__offline-forms-styles__bodyLong01___i3PY8",bodyShort01:"-esm-patient-forms__offline-forms-styles__bodyShort01___S0vYz",label01:"-esm-patient-forms__offline-forms-styles__label01___xfyMv",contentContainer:"-esm-patient-forms__offline-forms-styles__contentContainer___lLDEj",tableHeaderContainer:"-esm-patient-forms__offline-forms-styles__tableHeaderContainer___cPVP8",tableSearch:"-esm-patient-forms__offline-forms-styles__tableSearch___GZer3",availableOfflineToggle:"-esm-patient-forms__offline-forms-styles__availableOfflineToggle___w_RVf",availableOfflineToggleSkeleton:"-esm-patient-forms__offline-forms-styles__availableOfflineToggleSkeleton___hD9xS"};const l=i},4450:(e,t,n)=>{n.d(t,{MS:()=>_,cq:()=>m});var r=n(3565),o=n.n(r),a=n(3255),i=n(2870),l=n(8179),s=n(5186);function f(e,t,n,r,o,a,i){try{var l=e[a](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){f(a,r,o,i,l,"next",e)}function l(e){f(a,r,o,i,l,"throw",e)}i(void 0)}))}}function u(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}function m(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=(0,i.useConfig)(),r=n.customFormsUrl,o=n.showHtmlFormEntryForms,s=Boolean(r),f=s?r.concat("?patientUuid=".concat(t)):o?l.lA:l.HW;return(0,a.ZP)([f,e],c((function(){var t,n,r,o,a,l;return u(this,(function(c){switch(c.label){case 0:return[4,(0,i.openmrsFetch)(f)];case 1:return r=c.sent(),a=s?null==r?void 0:r.data.results:null!==(o=null===(n=r.data)||void 0===n||null===(t=n.results)||void 0===t?void 0:t.filter((function(e){return e.published&&!/component/i.test(e.name)})))&&void 0!==o?o:[],e?[4,(0,i.getDynamicOfflineDataEntries)("form")]:[2,a];case 2:return l=c.sent(),[2,a.filter((function(e){return l.some((function(t){return t.identifier===e.uuid}))}))]}}))})))}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o()(new Date).startOf("day").subtract(500,"day").toDate(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o()(new Date).endOf("day").toDate(),r="/ws/rest/v1/encounter?v=".concat(l._V,"&patient=").concat(e,"&fromdate=").concat(t.toISOString(),"&todate=").concat(n.toISOString());return(0,a.ZP)(r,(function(e){return(0,i.openmrsFetch)(e)}))}function _(e,t,n){var r,o,a,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],f=(0,i.useConfig)().htmlFormEntryForms,c=m(l,e),u=d(e,t,n),_=null!==(a=null===(o=u.data)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.results)&&void 0!==a?a:[],p=c.data?A(c.data,_):void 0,g=(0,i.useSession)(),v=function(){c.mutate(),u.mutate()},b=l?null==p?void 0:p.filter((function(e){return(0,s.LD)(e.form,f)})):p;return(null==g?void 0:g.user)&&(b=null==b?void 0:b.filter((function(e){var t,n,r;return(0,i.userHasAccess)(null==e||null===(r=e.form)||void 0===r||null===(n=r.encounterType)||void 0===n||null===(t=n.editPrivilege)||void 0===t?void 0:t.display,g.user)}))),{data:b,error:c.error,isValidating:c.isValidating||u.isValidating,allForms:c.data,mutateForms:v}}function A(e,t){return e.map((function(e){var n=t.filter((function(t){var n;return(null===(n=t.form)||void 0===n?void 0:n.uuid)===(null==e?void 0:e.uuid)})).sort((function(e,t){var n,r;return(null===(n=e.form)||void 0===n?void 0:n.display)>(null===(r=t.form)||void 0===r?void 0:r.display)?1:-1})),r=n.length>0?new Date(null==n?void 0:n[0].encounterDatetime):void 0;return{form:e,associatedEncounters:n,lastCompleted:r}}))}},5186:(e,t,n)=>{n.d(t,{LD:()=>a,nY:()=>l});var r=n(3255),o=n(2870);function a(e,t){var n=t.some((function(t){return t.formUuid===e.uuid})),r=e.resources.some(i);return!n&&r}function i(e){return"AmpathJsonSchema"===e.dataType||"JSON schema"===e.name}function l(){return(0,r.ZP)("dynamicFormEntries",(function(){return(0,o.getDynamicOfflineDataEntries)("form")}))}},6338:(e,t,n)=>{n.r(t),n.d(t,{default:()=>B});var r=n(268),o=n.n(r),a=n(4924),i=n(7883),l=n(2870),s=n(5186),f=n(4450);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(){var e,t,n,r=(0,f.cq)(),o=(0,l.useConfig)();return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){c(e,t,n[t])}))}return e}({},r),n=null!=(n={data:null===(e=r.data)||void 0===e?void 0:e.filter((function(e){return(0,s.LD)(e,o.htmlFormEntryForms)}))})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t}var m=n(1354),d=n.n(m),_=n(1583),A=n.n(_),p=n(7378),g=n.n(p),v=n(3927),b=n.n(v),y=n(4154),h=n.n(y),C=n(8141),w=n.n(C),O=n(8360),D={};D.styleTagTransform=w(),D.setAttributes=b(),D.insert=g().bind(null,"head"),D.domAPI=A(),D.insertStyleElement=h(),d()(O.Z,D);const E=O.Z&&O.Z.locals?O.Z.locals:void 0;var S=n(4556);function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t,n,r,o,a,i){try{var l=e[a](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,o)}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){H(e,t,n[t])}))}return e}function T(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function F(e){var t,n,f,c,u,m=e.form,d=e.disabled,_=(0,a.useTranslation)().t,A=(c=(0,r.useState)(!1),u=2,function(e){if(Array.isArray(e))return e}(c)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw o}}return a}}(c,u)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(c,u)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=A[0],g=A[1],v=(0,s.nY)(),b=null===(t=v.data)||void 0===t?void 0:t.some((function(e){return e.identifier===m.uuid})),y=(n=function(e){return function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}(this,(function(t){switch(t.label){case 0:g(!0),t.label=1;case 1:return t.trys.push([1,,7,8]),e?[4,(0,l.putDynamicOfflineData)("form",m.uuid)]:[3,4];case 2:return t.sent(),[4,(0,l.syncDynamicOfflineData)("form",m.uuid)];case 3:return t.sent(),[3,6];case 4:return[4,(0,l.removeDynamicOfflineData)("form",m.uuid)];case 5:t.sent(),t.label=6;case 6:return[3,8];case 7:return g(!1),v.mutate(),[7];case 8:return[2]}}))},f=function(){var e=this,t=arguments;return new Promise((function(r,o){var a=n.apply(e,t);function i(e){k(a,r,o,i,l,"next",e)}function l(e){k(a,r,o,i,l,"throw",e)}i(void 0)}))},function(e){return f.apply(this,arguments)});return v.isValidating?o().createElement(i.uKo,{className:E.availableOfflineToggleSkeleton}):o().createElement("div",null,o().createElement(i.ZDl,{"aria-label":_("offlineToggle","Offline toggle"),id:"".concat(m.uuid,"-offline-toggle"),className:E.availableOfflineToggle,labelA:"",labelB:"",labelText:"",size:"sm",toggled:b,disabled:d||p||v.isValidating,onToggle:y}))}const B=function(e){var t,n,r,s=e.canMarkFormsAsOffline,f=(0,a.useTranslation)().t,c=(0,l.useSession)(),m=u(),d=(0,l.useLayoutType)(),_=(0,l.isDesktop)(d)?"sm":void 0,A=[{key:"formName",header:f("offlineFormsTableFormNameHeader","Form name")},{key:"availableOffline",header:f("offlineFormsTableFormAvailableOffline","Offline")}],p=null!==(r=null===(t=m.data)||void 0===t?void 0:t.filter((function(e){var t,n;return(0,l.userHasAccess)(null==e||null===(n=e.encounterType)||void 0===n||null===(t=n.editPrivilege)||void 0===t?void 0:t.display,null==c?void 0:c.user)})).map((function(e){return{id:e.uuid,formName:e.name,availableOffline:o().createElement(F,{form:e,disabled:!s})}})))&&void 0!==r?r:[];return 0===(null==m||null===(n=m.data)||void 0===n?void 0:n.length)?o().createElement("div",{className:E.contentContainer},o().createElement(S.EmptyState,{displayText:f("offlineForms__lower","offline forms"),headerTitle:f("offlineForms","Offline forms")})):o().createElement(o().Fragment,null,o().createElement("header",{className:E.pageHeaderContainer},o().createElement("h1",{className:E.pageHeader},f("offlineFormsTitle","Offline forms"))),o().createElement("main",{className:E.contentContainer},o().createElement(i.wQF,{rows:p,headers:A,size:"sm",useZebraStyles:!0},(function(e){var t=e.rows,n=e.headers,r=e.getTableProps,a=e.getHeaderProps,l=e.getRowProps,s=e.getTableContainerProps,c=e.onInputChange;return o().createElement(i.xJi,s(),o().createElement("div",{className:E.tableHeaderContainer},o().createElement(i.mh4,null,o().createElement(i.olm,{className:E.tableSearch,labelText:f("offlinePatientsTableSearchLabel","Search this list"),placeholder:f("offlinePatientsTableSearchPlaceholder","Search this list"),size:_,onChange:c}))),o().createElement(i.iA_,T(j({},r()),{isSortable:!0,useZebraStyles:!0}),o().createElement(i.ssF,null,o().createElement(i.SCH,null,n.map((function(e){return o().createElement(i.xDH,T(j({},a({header:e})),{isSortable:!0}),e.header)})))),o().createElement(i.RMI,null,t.map((function(e){return o().createElement(i.SCH,l({row:e}),e.cells.map((function(e){var t,n;return o().createElement(i.pj1,{key:e.id},null!==(n=null===(t=e.value)||void 0===t?void 0:t.value)&&void 0!==n?n:e.value)})))})))))}))))}}}]);