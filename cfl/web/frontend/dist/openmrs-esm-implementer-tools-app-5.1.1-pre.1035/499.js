"use strict";(globalThis.webpackChunk_openmrs_esm_implementer_tools_app=globalThis.webpackChunk_openmrs_esm_implementer_tools_app||[]).push([[499],{7499:(e,n,t)=>{t.r(n),t.d(n,{default:()=>I});var r,o=t(5776),i=t.n(o),u=t(4610),a=t(1004),l=t(500);function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function s(e,n,t,r,o,i,u){try{var a=e[i](u),l=a.value}catch(e){return void t(e)}a.done?n(l):Promise.resolve(l).then(r,o)}function f(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function u(e){s(i,r,o,u,a,"next",e)}function a(e){s(i,r,o,u,a,"throw",e)}u(void 0)}))}}function p(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return c(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,n){var t,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;u;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=n.call(e,u)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function y(){return m.apply(this,arguments)}function m(){return(m=f((function(){var e;return d(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,u.openmrsFetch)("/ws/rest/v1/module?v=custom:(uuid,version)",{method:"GET"})];case 1:return[2,n.sent().data.results];case 2:return e=n.sent(),console.error(e),[3,3];case 3:return[2,[]]}}))}))).apply(this,arguments)}function b(e,n){return(0,u.isVersionSatisfied)(e,n)?"okay":"version-mismatch"}function v(){return(v=f((function(){var e,n,t;return d(this,(function(o){switch(o.label){case 0:return r?[3,2]:(n=(null!==(e=window.installedModules)&&void 0!==e?e:[]).filter((function(e){var n;return Boolean(null===(n=e[1])||void 0===n?void 0:n.backendDependencies)})).map((function(e){return{backendDependencies:e[1].backendDependencies,moduleName:e[0]}})),[4,y()]);case 1:t=o.sent(),r=n.map((function(e){return function(e,n){var t,r=[],o=function(e,n){if(!e)return[];var t=Object.keys(e),r=n.map((function(e){return e.uuid}));return(0,l.Z)(t,r).map((function(n){return{uuid:n,version:e[n]}}))}(e.backendDependencies,n),i=function(e,n){return e?Object.keys(e).map((function(n){return{uuid:n,version:e[n]}})).filter((function(e){return n.find((function(n){return e.uuid===n.uuid}))})):[]}(e.backendDependencies,n);return(t=r).push.apply(t,p(o.map((function(e){return{name:e.uuid,requiredVersion:e.version,type:"missing"}}))).concat(p(i.map((function(e){var t=e.version,r=function(e,n){var t,r,o=e.uuid;return null!==(r=null===(t=n.find((function(e){return e.uuid==o})))||void 0===t?void 0:t.version)&&void 0!==r?r:""}(e,n);return{name:e.uuid,requiredVersion:t,installedVersion:r,type:b(t,r)}}))))),{name:e.moduleName,dependencies:r}}(e,t)})),o.label=2;case 2:return[2,r]}}))}))).apply(this,arguments)}function h(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function w(){var e,n,t=(e=(0,o.useState)([]),n=2,function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i=[],u=!0,a=!1;try{for(t=t.call(e);!(u=(r=t.next()).done)&&(i.push(r.value),!n||i.length!==n);u=!0);}catch(e){a=!0,o=e}finally{try{u||null==t.return||t.return()}finally{if(a)throw o}}return i}}(e,n)||function(e,n){if(e){if("string"==typeof e)return h(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?h(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=t[0],i=t[1];return(0,o.useEffect)((function(){(function(){return v.apply(this,arguments)})().then(i)}),[]),r}var g=t(2680);function O(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function k(){return(0,o.useMemo)((function(){var e;return(null!==(e=window.installedModules)&&void 0!==e?e:[]).filter((function(e){return Boolean(e)&&Boolean(e[1])})).map((function(e){return n=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){O(e,n,t[n])}))}return e}({},e[1]),t=null!=(t={name:e[0]})?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})),n;var n,t}))}),[])}function S(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var j=i().lazy((function(){return Promise.all([t.e(220),t.e(837),t.e(575),t.e(329),t.e(551),t.e(478),t.e(278)]).then(t.bind(t,3199))})),A=i().lazy((function(){return Promise.all([t.e(220),t.e(837),t.e(551),t.e(478),t.e(587)]).then(t.bind(t,587))}));function E(){var e,n,t=k(),r=w(),l=(e=(0,o.useState)(!1),n=2,function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i=[],u=!0,a=!1;try{for(t=t.call(e);!(u=(r=t.next()).done)&&(i.push(r.value),!n||i.length!==n);u=!0);}catch(e){a=!0,o=e}finally{try{u||null==t.return||t.return()}finally{if(a)throw o}}return i}}(e,n)||function(e,n){if(e){if("string"==typeof e)return S(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?S(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=l[0],s=l[1],f=(0,g.useTranslation)().t;(0,o.useEffect)((function(){s((function(e){return e||function(e){return e.some((function(e){return e.dependencies.some((function(e){return"okay"!==e.type}))}))}(r)}))}),[r]),(0,o.useEffect)((function(){c&&(0,u.showActionableNotification)({critical:!1,kind:"error",subtitle:f("checkImplementerToolsMessage","Check the Backend Modules tab in the Implementer Tools for more details"),title:f("modulesWithMissingDependenciesWarning","Some modules have unresolved backend dependencies"),actionButtonLabel:f("viewModules","View modules"),onActionButtonClick:a.XE})}),[f,c]);var p=(0,u.useStore)(a.wT),d=p.isOpen,y=p.isUIEditorEnabled,m=p.openTabIndex;return i().createElement(i().Fragment,null,d?i().createElement(j,{close:a.zI,frontendModules:t,backendDependencies:r,visibleTabIndex:m}):null,y?i().createElement(A,null):null)}function I(){return i().createElement(u.UserHasAccess,{privilege:"coreapps.systemAdministration"},i().createElement(E,null))}}}]);