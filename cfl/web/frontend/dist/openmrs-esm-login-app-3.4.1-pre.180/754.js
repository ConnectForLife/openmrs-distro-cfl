"use strict";(self.webpackChunk_openmrs_esm_login_app=self.webpackChunk_openmrs_esm_login_app||[]).push([[754],{5048:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(361),r=n.n(o)()((function(e){return e[1]}));r.push([e.id,".-esm-login__loading__centerLoadingSVG___mTF5v{display:flex;width:100vw;height:100vh;justify-content:center;align-items:center}",""]),r.locals={centerLoadingSVG:"-esm-login__loading__centerLoadingSVG___mTF5v"};const i=r},8591:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(361),r=n.n(o)()((function(e){return e[1]}));r.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-login__styles__productiveHeading01___5sIFe{font-size:.875rem;font-weight:600;line-height:1.29;letter-spacing:.16px}.-esm-login__styles__productiveHeading02___DMIYV{font-size:1rem;font-weight:600;line-height:1.375;letter-spacing:0}.-esm-login__styles__productiveHeading03___\\+nU0Y{font-size:1.25rem;font-weight:400;line-height:1.4;letter-spacing:0}.-esm-login__styles__productiveHeading04___RkSuA{font-size:1.75rem;font-weight:400;line-height:1.29;letter-spacing:0}.-esm-login__styles__productiveHeading05___3fj9t{font-size:2rem;font-weight:400;line-height:1.25;letter-spacing:0}.-esm-login__styles__productiveHeading06___k2R6d{font-size:2rem;font-weight:300;line-height:1.199;letter-spacing:0}.-esm-login__styles__bodyShort01___x0bsq,.-esm-login__styles__contact-administrator-need-help___0lG2O,.-esm-login__styles__need-help-txt___7gwGM{font-size:.875rem;font-weight:400;line-height:1.29;letter-spacing:.16px}.-esm-login__styles__bodyShort02___AAWD5{font-size:1rem;font-weight:400;line-height:1.375;letter-spacing:0}.-esm-login__styles__bodyLong01___GN1sw{font-size:.875rem;font-weight:400;line-height:1.43;letter-spacing:.16px}.-esm-login__styles__bodyLong02___LBXin{font-size:1rem;font-weight:400;line-height:1.5;letter-spacing:0}.-esm-login__styles__label01___tdF54,.-esm-login__styles__inputStyle___wP6gc{font-size:.75rem;font-weight:400;line-height:1.34;letter-spacing:.32px}.-esm-login__styles__caption01___ag3pm,.-esm-login__styles__powered-by-txt___clKgK{font-size:.75rem;font-weight:400;line-height:1.34;letter-spacing:.32px}.-esm-login__styles__helperText01___MJ4X5{font-size:.75rem;line-height:1.34;letter-spacing:.32px}.-esm-login__styles__text01___MntUe{color:#161616}.-esm-login__styles__text02___nKQyT{color:#525252}.-esm-login__styles__container___toRwL{display:flex;flex-direction:column;justify-content:center;align-items:center}.-esm-login__styles__center___9CsO2{text-align:center}.-esm-login__styles__right___dLSHk{text-align:right}.-esm-login__styles__logo___OHgAS{margin-bottom:2.5rem;height:5rem;width:13rem}.-esm-login__styles__logo-img___GmKgk{margin-bottom:3rem;max-width:100%}.-esm-login__styles__icon-btn___xZD4p{cursor:pointer}.-esm-login__styles__error-msg___1B3-t{margin-top:1rem;color:#da1e28}.-esm-login__styles__powered-by-txt___clKgK{text-align:center;color:#525252;color:#525252}.-esm-login__styles__need-help___Uu8xO{display:flex;width:23rem}.-esm-login__styles__need-help-txt___7gwGM{text-align:left;color:#525252;display:flex;flex-direction:row;align-items:center}.-esm-login__styles__contact-administrator-need-help___0lG2O{padding-left:.5rem}.-esm-login__styles__powered-by-logo___rIu4y{height:2.5rem;width:6.5rem}.-esm-login__styles__login-card___FpE42{border-radius:0;border:1px solid #c6c6c6;background-color:#fff;width:23rem;padding:2.5rem;position:relative}@media only screen and (min-width: 481px){.-esm-login__styles__container___toRwL{height:100vh}}@media only screen and (max-width: 480px){.-esm-login__styles__login-card___FpE42{margin-top:2.5%;border:none}.-esm-login__styles__container___toRwL{height:100vh}}.-esm-login__styles__card-content___JlY\\+6{border:none;padding:.625rem .25rem .625rem 1rem;border-radius:0}.-esm-login__styles__card___btZG3{width:21.75rem;margin:.5rem 1rem}.-esm-login__styles__input-group___Xyurj{display:flex;justify-content:center;flex-direction:column;align-items:center;width:18rem}.-esm-login__styles__continueButton___Z08b\\+{margin-top:1.5rem;width:18rem}.-esm-login__styles__back-button-div___E\\+ai0{width:23rem;position:absolute;bottom:100%;left:0}.-esm-login__styles__back-button___Y60Xa{height:3rem}.-esm-login__styles__back-button___Y60Xa svg{margin-right:.5rem}.-esm-login__styles__inputStyle___wP6gc{width:18rem;height:3rem}.-esm-login__styles__footer___-6YSd{margin-top:6.75rem}",""]),r.locals={productiveHeading01:"-esm-login__styles__productiveHeading01___5sIFe",productiveHeading02:"-esm-login__styles__productiveHeading02___DMIYV",productiveHeading03:"-esm-login__styles__productiveHeading03___+nU0Y",productiveHeading04:"-esm-login__styles__productiveHeading04___RkSuA",productiveHeading05:"-esm-login__styles__productiveHeading05___3fj9t",productiveHeading06:"-esm-login__styles__productiveHeading06___k2R6d",bodyShort01:"-esm-login__styles__bodyShort01___x0bsq","contact-administrator-need-help":"-esm-login__styles__contact-administrator-need-help___0lG2O","need-help-txt":"-esm-login__styles__need-help-txt___7gwGM",bodyShort02:"-esm-login__styles__bodyShort02___AAWD5",bodyLong01:"-esm-login__styles__bodyLong01___GN1sw",bodyLong02:"-esm-login__styles__bodyLong02___LBXin",label01:"-esm-login__styles__label01___tdF54",inputStyle:"-esm-login__styles__inputStyle___wP6gc",caption01:"-esm-login__styles__caption01___ag3pm","powered-by-txt":"-esm-login__styles__powered-by-txt___clKgK",helperText01:"-esm-login__styles__helperText01___MJ4X5",text01:"-esm-login__styles__text01___MntUe",text02:"-esm-login__styles__text02___nKQyT",container:"-esm-login__styles__container___toRwL",center:"-esm-login__styles__center___9CsO2",right:"-esm-login__styles__right___dLSHk",logo:"-esm-login__styles__logo___OHgAS","logo-img":"-esm-login__styles__logo-img___GmKgk","icon-btn":"-esm-login__styles__icon-btn___xZD4p","error-msg":"-esm-login__styles__error-msg___1B3-t","need-help":"-esm-login__styles__need-help___Uu8xO","powered-by-logo":"-esm-login__styles__powered-by-logo___rIu4y","login-card":"-esm-login__styles__login-card___FpE42","card-content":"-esm-login__styles__card-content___JlY+6",card:"-esm-login__styles__card___btZG3","input-group":"-esm-login__styles__input-group___Xyurj",continueButton:"-esm-login__styles__continueButton___Z08b+","back-button-div":"-esm-login__styles__back-button-div___E+ai0","back-button":"-esm-login__styles__back-button___Y60Xa",footer:"-esm-login__styles__footer___-6YSd"};const i=r},1754:(e,t,n)=>{n.r(t),n.d(t,{default:()=>K});var o=n(6983),r=n.n(o),i=n(1602),s=n.n(i),_=n(487),l=n.n(_),a=n(631),c=n.n(a),g=n(2052),u=n.n(g),m=n(4010),d=n.n(m),p=n(1469),h=n.n(p),y=n(9329),f=n.n(y),v=n(8591),b={};b.styleTagTransform=f(),b.setAttributes=d(),b.insert=u().bind(null,"head"),b.domAPI=c(),b.insertStyleElement=h(),l()(v.Z,b);const w=v.Z&&v.Z.locals?v.Z.locals:void 0;var x=n(2718),E=n(3837),S=n(9784),k=n(2680),L=n(7644);function C(e,t){var n=window.btoa("".concat(e,":").concat(t));return(0,L.openmrsFetch)("/ws/rest/v1/session",{headers:{Authorization:"Basic ".concat(n)}}).then((function(e){return(0,L.refetchCurrentUser)(),e}))}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function N(e,t,n,o,r,i,s){try{var _=e[i](s),l=_.value}catch(e){return void n(e)}_.done?t(l):Promise.resolve(l).then(o,r)}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i=[],s=!0,_=!1;try{for(n=n.call(e);!(s=(o=n.next()).done)&&(i.push(o.value),!t||i.length!==t);s=!0);}catch(e){_=!0,r=e}finally{try{s||null==n.return||n.return()}finally{if(_)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?H(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var B={height:0,width:0,border:0,padding:0};const T=function(e){var t=e.history,n=e.location,i=e.isLoginEnabled,_=(0,L.useConfig)(),l=(0,L.useSession)().user,a=A((0,o.useState)(""),2),c=a[0],g=a[1],u=A((0,o.useState)(""),2),m=u[0],d=u[1],p=A((0,o.useState)(""),2),h=p[0],y=p[1],f=(0,o.useRef)(null),v=(0,o.useRef)(null),b=(0,o.useRef)(null),H=A((0,k.useTranslation)(),1)[0],T="/login/confirm"===n.pathname;(0,o.useEffect)((function(){l?t.push("/login/location",n.state):c||"/login/confirm"!==n.pathname||t.replace("/login",n.state)}),[l,c,t,n]),(0,o.useEffect)((function(){var e=T?f.current:v.current;e&&e.focus()}),[T]),(0,o.useEffect)((function(){if(!l&&"oauth2"===_.provider.type){var e=_.provider.loginUrl;window.location.href=e}}),[_,l]);var R,Z,I=(0,o.useCallback)((function(){var e=v.current;e.value.length>0?t.push("/login/confirm",n.state):e.focus()}),[t]),P=(0,o.useCallback)((function(e){return g(e.target.value)}),[]),U=(0,o.useCallback)((function(e){return d(e.target.value)}),[]),G=(0,o.useCallback)((function(){g(""),d("")}),[]),O=(0,o.useCallback)((R=s().mark((function e(t){var n,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),t.stopPropagation(),T){e.next=5;break}return I(),e.abrupt("return",!1);case 5:return e.prev=5,e.next=8,C(c,m);case 8:if(n=e.sent,(o=n.data)&&o.authenticated){e.next=13;break}throw new Error("invalidCredentials");case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(5),y(e.t0.message),G();case 19:return e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,null,[[5,15]])})),Z=function(){var e=this,t=arguments;return new Promise((function(n,o){var r=R.apply(e,t);function i(e){N(r,n,o,i,s,"next",e)}function s(e){N(r,n,o,i,s,"throw",e)}i(void 0)}))},function(e){return Z.apply(this,arguments)}),[I,G,T,c,m]),z=_.logo.src?r().createElement("img",{src:(0,L.interpolateUrl)(_.logo.src),alt:_.logo.alt,className:w["logo-img"]}):r().createElement("svg",{role:"img",className:w.logo},r().createElement("title",null,"OpenMRS logo"),r().createElement("use",{xlinkHref:"#omrs-logo-full-color"}));return"basic"===_.provider.type?r().createElement("div",{className:"canvas ".concat(w.container)},h&&r().createElement(S.InlineNotification,{kind:"error",style:{width:"23rem"},subtitle:H(h),title:H("error","Error"),onClick:function(){return y("")}}),r().createElement(S.Tile,{className:w["login-card"]},T?r().createElement("div",{className:w["back-button-div"]},r().createElement(S.Button,{className:w["back-button"],kind:"ghost",iconDescription:"Back to username",onClick:function(){return t.push("/login")}},r().createElement(E.Z,{style:{marginRight:"1rem"}}),"Back")):null,r().createElement("div",{className:w.center},z),r().createElement("form",{onSubmit:O,ref:b},!T&&r().createElement("div",{className:w["input-group"]},r().createElement(S.TextInput,{id:"username",type:"text",name:"username",labelText:H("username","Username"),className:w.inputStyle,value:c,onChange:P,ref:v,autoFocus:!0,required:!0}),r().createElement("input",{id:"password",style:B,type:"password",name:"password",value:m,onChange:U}),r().createElement(S.Button,{className:w.continueButton,renderIcon:x.Z,type:"submit",iconDescription:"Next",onClick:I,disabled:!i},H("continue","Continue"))),T&&r().createElement("div",{className:w["input-group"]},r().createElement("input",{id:"username",type:"text",name:"username",style:B,value:c,onChange:P,required:!0}),r().createElement(S.TextInput.PasswordInput,{id:"password",invalidText:H("validValueRequired","A valid value is required"),labelText:H("password","Password"),name:"password",className:w.inputStyle,value:m,onChange:U,ref:f,required:!0,showPasswordLabel:"Show password"}),r().createElement(S.Button,{"aria-label":"submit",type:"submit",className:w.continueButton,renderIcon:x.Z,iconDescription:"Next",disabled:!i},H("login","Log in"))))),r().createElement("div",{className:w["need-help"]},r().createElement("p",{className:w["need-help-txt"]},H("needHelp","Need help?"),r().createElement(S.Button,{kind:"ghost"},H("contactAdmin","Contact the site administrator")))),r().createElement("div",{className:w.footer},r().createElement("p",{className:w["powered-by-txt"]},H("poweredBy","Powered by")),r().createElement("div",null,r().createElement("svg",{role:"img",className:w["powered-by-logo"]},r().createElement("use",{xlinkHref:"#omrs-logo-partial-mono"}))))):null};var R=n(5048),Z={};Z.styleTagTransform=f(),Z.setAttributes=d(),Z.insert=u().bind(null,"head"),Z.domAPI=c(),Z.insertStyleElement=h(),l()(R.Z,Z);const I=R.Z&&R.Z.locals?R.Z.locals:void 0,P=function(){return r().createElement("div",{className:I.centerLoadingSVG},r().createElement(S.Loading,{description:"Active loading indicator",role:"progressbar",withOverlay:!1,small:!0}))};var U=n(9607),G=n(4865);const O=function(e){var t,n=e.location,i=e.isLoginEnabled,s=new URLSearchParams(null==n?void 0:n.search).get("returnToUrl"),_=null==n||null===(t=n.state)||void 0===t?void 0:t.referrer,l=(0,L.useConfig)(),a=(0,L.useSession)().user,c=(0,G.h)(l.chooseLocation.useLoginLocationTag),g=c.locationData,u=c.isLoading,m=(0,o.useCallback)((function(e){(e?(0,L.setSessionLocation)(e,new AbortController):Promise.resolve()).then((function(){!_||["/","/login","/login/location"].includes(_)?s&&"/"!==s?(0,L.navigate)({to:s}):(0,L.navigate)({to:l.links.loginSuccess}):(0,L.navigate)({to:"${openmrsSpaBase}"+_})}))}),[_,l.links.loginSuccess,s]);return(0,o.useEffect)((function(){var e;u||(l.chooseLocation.enabled&&1!==(null==g?void 0:g.length)||m(null===(e=g[0])||void 0===e?void 0:e.resource.id),u||(null==g?void 0:g.length)||m())}),[g,a,m,l.chooseLocation.enabled,u]),u||a?u&&i?r().createElement(P,null):r().createElement(U.default,{currentUser:a.display,loginLocations:null!=g?g:[],onChangeLocation:m,isLoginEnabled:i}):((0,L.navigate)({to:"${openmrsSpaBase}/login"}),null)};function z(e,t,n,o,r,i,s){try{var _=e[i](s),l=_.value}catch(e){return void n(e)}_.done?t(l):Promise.resolve(l).then(o,r)}function j(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function s(e){z(i,o,r,s,_,"next",e)}function _(e){z(i,o,r,s,_,"throw",e)}s(void 0)}))}}function D(){return(D=j(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,L.openmrsFetch)("/ws/rest/v1/session",{method:"DELETE"});case 2:return(0,L.clearCurrentUser)(),e.next=5,(0,L.refetchCurrentUser)();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}const F=function(e){var t=e.isLoginEnabled,n=(0,L.useConfig)(),r=(0,L.useSession)();return(0,o.useEffect)((function(){r.authenticated&&t?function(){return D.apply(this,arguments)}().then((function(){"oauth2"===n.provider.type?location.href=n.provider.logoutUrl:(0,L.navigate)({to:"${openmrsSpaBase}/login"})})):(0,L.navigate)({to:"${openmrsSpaBase}/login"})}),[t,r,n]),null};var M=n(2268);function Y(){return Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Y.apply(this,arguments)}const K=function(e){var t=e.isLoginEnabled;return r().createElement(M.BrowserRouter,{basename:window.spaBase},r().createElement(M.Route,{exact:!0,path:"/login(/confirm)?",render:function(e){return r().createElement(T,Y({},e,{isLoginEnabled:t}))}}),r().createElement(M.Route,{exact:!0,path:"/login/location",render:function(e){return r().createElement(O,Y({},e,{isLoginEnabled:t}))}}),r().createElement(M.Route,{exact:!0,path:"/logout",render:function(e){return r().createElement(F,Y({},e,{isLoginEnabled:t}))}}))}}}]);