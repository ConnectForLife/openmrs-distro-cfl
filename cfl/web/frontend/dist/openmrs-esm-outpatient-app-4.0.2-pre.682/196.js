"use strict";(self.webpackChunk_openmrs_esm_outpatient_app=self.webpackChunk_openmrs_esm_outpatient_app||[]).push([[196],{5039:(t,e,n)=>{n.d(e,{Z:()=>o});var a=n(2609),i=n.n(a)()((function(t){return t[1]}));i.push([t.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-outpatient__appointment-details__widgetCard___yBzo5{border:1px solid #d0e2ff;border-left:none;border-right:none;background-color:#edf5ff;padding:1rem}.-esm-outpatient__appointment-details__title___efLGc{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px);color:#525252;margin-bottom:.25rem}.-esm-outpatient__appointment-details__subtitle___Y5-uv{color:#525252;font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-outpatient__appointment-details__content___N365S{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px);background-color:#edf5ff;padding:1rem;border:1px solid #d0e2ff}.-esm-outpatient__appointment-details__tile___u-pjO{text-align:center}",""]),i.locals={widgetCard:"-esm-outpatient__appointment-details__widgetCard___yBzo5",title:"-esm-outpatient__appointment-details__title___efLGc",subtitle:"-esm-outpatient__appointment-details__subtitle___Y5-uv",content:"-esm-outpatient__appointment-details__content___N365S",tile:"-esm-outpatient__appointment-details__tile___u-pjO"};const o=i},4683:(t,e,n)=>{n.d(e,{Z:()=>o});var a=n(2609),i=n.n(a)()((function(t){return t[1]}));i.push([t.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-outpatient__contact-details__heading___Zcw3g{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px);color:#525252}.-esm-outpatient__contact-details__container___-zWaM{background-color:#edf5ff;display:grid;grid-template-columns:1fr 1fr;border-top:1px solid #d0e2ff;margin-top:.125rem}.-esm-outpatient__contact-details__container___-zWaM>div{padding:1rem}.-esm-outpatient__contact-details__container___-zWaM>div:first-child{border-right:1px solid #d0e2ff}.-esm-outpatient__contact-details__container___-zWaM ul>li{padding:.25rem 0;color:#525252;font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}",""]),i.locals={heading:"-esm-outpatient__contact-details__heading___Zcw3g",container:"-esm-outpatient__contact-details__container___-zWaM"};const o=i},3280:(t,e,n)=>{n.d(e,{Z:()=>o});var a=n(2609),i=n.n(a)()((function(t){return t[1]}));i.push([t.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-outpatient__patient-info__container___C2u29{border-bottom:.0125rem solid #c6c6c6;background-color:#fff;padding:0}.-esm-outpatient__patient-info__patientInfoContainer___8LsQP{background-color:#fff;padding:0 0 0 1rem;display:flex;align-items:center;min-height:7rem}.-esm-outpatient__patient-info__activePatientInfoContainer___O4qHD{background-color:#edf5ff;padding:0 0 0 1rem;display:flex;align-items:center;min-height:7rem}.-esm-outpatient__patient-info__patientName___pSifS{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-outpatient__patient-info__patientInfoContent___wKyNV{margin:1rem 0 0 1rem;width:100%}.-esm-outpatient__patient-info__demographics___n7CnB{font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0);color:#525252;margin-top:.25rem}.-esm-outpatient__patient-info__identifier___I6fwF{font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0);color:#8d8d8d}.-esm-outpatient__patient-info__patientInfoRow___9IXjq{display:flex;justify-content:space-between;align-items:center}.-esm-outpatient__patient-info__patientInfoRow___9IXjq>button{min-height:2rem}.-esm-outpatient__patient-info__patientEditBtn___wkTKa{color:#161616;margin:.5rem}",""]),i.locals={container:"-esm-outpatient__patient-info__container___C2u29",patientInfoContainer:"-esm-outpatient__patient-info__patientInfoContainer___8LsQP",activePatientInfoContainer:"-esm-outpatient__patient-info__activePatientInfoContainer___O4qHD",patientName:"-esm-outpatient__patient-info__patientName___pSifS",patientInfoContent:"-esm-outpatient__patient-info__patientInfoContent___wKyNV",demographics:"-esm-outpatient__patient-info__demographics___n7CnB",identifier:"-esm-outpatient__patient-info__identifier___I6fwF",patientInfoRow:"-esm-outpatient__patient-info__patientInfoRow___9IXjq",patientEditBtn:"-esm-outpatient__patient-info__patientEditBtn___wkTKa"};const o=i},5865:(t,e,n)=>{n.d(e,{L:()=>r,N:()=>o});var a=n(9857),i=n(906);function o(t){var e,n,o=(0,a.ZP)("/ws/rest/v1/visit?patient=".concat(t,"&v=").concat("custom:(uuid,encounters:(uuid,form:(uuid,display),encounterDatetime,orders:full,obs:(uuid,concept:(uuid,display,conceptClass:(uuid,display)),display,groupMembers:(uuid,concept:(uuid,display),value:(uuid,display)),value),encounterType:(uuid,display),encounterProviders:(uuid,display,encounterRole:(uuid,display),provider:(uuid,person:(uuid,display)))),visitType:(uuid,name,display),startDatetime,patient"),i.openmrsFetch),r=o.data,s=o.error,l=o.isValidating,c=null==r||null===(e=r.data)||void 0===e||null===(n=e.results)||void 0===n?void 0:n.find((function(t){return null!==t.stopDatetime}));return{visits:r?c:null,isError:s,isLoading:!r&&!s,isValidating:l}}function r(t,e){if(!t||!e)return"";var n=t.search(/\D/),a=parseInt(t.substring(0,n)),i=t.search(/\//),o=t.substring(n);if(i>=0){o=t.substring(n,i);var r=t.substring(i+1).search(/\D/),s=parseInt(t.substr(i+1,r)),l=t.substring(i+1+r);return"".concat(e," ").concat(o," (").concat(e/a*s," ").concat(l,")")}return"".concat(a*e," ").concat(o)}},6196:(t,e,n)=>{n.r(e),n.d(e,{default:()=>K});var a=n(5206),i=n.n(a),o=n(4924),r=n(8648),s=n(7631),l=n(2074),c=n(906),d=n(8879),u=n.n(d),p=n(9857),m="/ws/rest/v1/appointments/search",_=n(6062),f=n.n(_),g=n(4036),v=n.n(g),h=n(6793),b=n.n(h),y=n(7892),E=n.n(y),w=n(1173),I=n.n(w),N=n(2464),C=n.n(N),D=n(5039),T={};T.styleTagTransform=C(),T.setAttributes=E(),T.insert=b().bind(null,"head"),T.domAPI=v(),T.insertStyleElement=I(),f()(D.Z,T);const S=D.Z&&D.Z.locals?D.Z.locals:void 0;var z=n(5865),L=function(t){var e,n,a=t.pastVisit,s=t.isLoading,l=(0,o.useTranslation)().t;return s?i().createElement("div",{className:S.widgetCard},i().createElement(r.lSo,{description:l("loading","Loading..."),role:"progressbar"})):a?i().createElement("div",{className:S.widgetCard},i().createElement(i().Fragment,null,i().createElement("p",{className:S.title},l("lastEncounter","Last encounter")),i().createElement("p",{className:S.subtitle},(0,c.formatDatetime)((0,c.parseDate)(null==a?void 0:a.startDatetime))," ·"," ",(null==a?void 0:a.visitType)?null==a||null===(e=a.visitType)||void 0===e?void 0:e.display:"--"," ·"," ",(null==a?void 0:a.location)?null===(n=a.location)||void 0===n?void 0:n.display:"--"))):i().createElement("p",{className:S.content},l("noLastEncounter","There is no last encounter to display for this patient"))},A=function(t){var e,n,a=t.upcomingAppointment,s=t.isLoading,l=(0,o.useTranslation)().t;return s?i().createElement("div",{className:S.widgetCard},i().createElement(r.lSo,{description:l("loading","Loading..."),role:"progressbar"})):a?i().createElement("div",{className:S.widgetCard},i().createElement(i().Fragment,null,i().createElement("p",{className:S.title},l("returnDate","Return date")),i().createElement("p",{className:S.subtitle},(0,c.formatDatetime)((0,c.parseDate)(null==a?void 0:a.startDateTime))," ·"," ",(null==a?void 0:a.service)?null==a||null===(e=a.service)||void 0===e?void 0:e.name:"--"," ·"," ",(null==a?void 0:a.location)?null==a||null===(n=a.location)||void 0===n?void 0:n.name:"--"," "))):i().createElement("p",{className:S.content},l("noReturnDate","There is no return date to display for this patient"))};const k=function(t){var e=t.patientUuid,n=((0,o.useTranslation)().t,function(t,e,n){var a,i=(0,p.ZP)(m,(function(){return(0,c.openmrsFetch)(m,{method:"POST",signal:n.signal,headers:{"Content-Type":"application/json"},body:{patientUuid:t,startDate:e}})})),o=i.data,r=i.error,s=i.isValidating,l=(null==o||null===(a=o.data)||void 0===a?void 0:a.length)?o.data.sort((function(t,e){return e.startDateTime>t.startDateTime?1:-1})):null;return{upcomingAppointment:(null==l?void 0:l.find((function(t){return u()(t.startDateTime/1e3*1e3).isAfter(u()())})))||null,isError:r,isLoading:!o&&!r,isValidating:s}}(e,u()((new Date).toISOString()).subtract(6,"month").toISOString(),new AbortController)),a=n.upcomingAppointment,r=n.isLoading,s=(0,z.N)(e),l=s.visits,d=s.isLoading;return i().createElement(i().Fragment,null,i().createElement(L,{pastVisit:l,isLoading:d}),i().createElement(A,{upcomingAppointment:a,isLoading:r}))};var P=n(2303),Z=n(4683),x={};x.styleTagTransform=C(),x.setAttributes=E(),x.insert=b().bind(null,"head"),x.domAPI=v(),x.insertStyleElement=I(),f()(Z.Z,x);const O=Z.Z&&Z.Z.locals?Z.Z.locals:void 0;var j=function(t){var e=t.address,n=(0,o.useTranslation)().t;return i().createElement("div",null,i().createElement("p",{className:O.heading},n("placeOfResidence","Place of Residence")),i().createElement("ul",null,e?i().createElement(i().Fragment,null,i().createElement("li",null,e.postalCode),i().createElement("li",null,e.city),i().createElement("li",null,e.state),i().createElement("li",null,e.country)):"--"))},R=function(t){var e=t.contact,n=t.patientUuid,a=(0,o.useTranslation)().t,s=(null==e?void 0:e.length)?e[0].value:"--",l=function(t){var e=(0,c.useConfig)().contactAttributeType,n=function(t){var e,n=(0,P.Z)("/ws/rest/v1/patient/".concat(t,"?v=").concat("custom:(uuid,display,identifiers:(identifier,uuid,preferred,location:(uuid,name),identifierType:(uuid,name,format,formatDescription,validator)),person:(uuid,display,gender,birthdate,dead,age,deathDate,birthdateEstimated,causeOfDeath,preferredName:(uuid,preferred,givenName,middleName,familyName),attributes,preferredAddress:(uuid,preferred,address1,address2,cityVillage,longitude,stateProvince,latitude,country,postalCode,countyDistrict,address3,address4,address5,address6,address7)))"),c.openmrsFetch),a=n.data,i=n.error;return{isLoading:!a&&!i,attributes:null!==(e=null==a?void 0:a.data.person.attributes)&&void 0!==e?e:[],error:i}}(t),a=n.attributes,i=n.isLoading,o=a.filter((function(t){var n=t.attributeType;return null==e?void 0:e.some((function(t){return n.uuid===t}))}));return{contactAttributes:null!=o?o:[],isLoading:i}}(n),d=l.isLoading,u=l.contactAttributes;return i().createElement("div",null,i().createElement("p",{className:O.heading},a("contactDetails","Contact Details")),i().createElement("ul",null,i().createElement("li",null,s),d?i().createElement(r.lSo,{description:a("loading","Loading...")}):null==u?void 0:u.map((function(t){var e=t.attributeType,n=t.value,a=t.uuid;return i().createElement("li",{key:a},e.display," : ",n)}))))};const F=function(t){var e=t.patientId,n=t.address,a=t.contact,o=n?n.find((function(t){return"home"===t.use})):void 0;return i().createElement("div",{className:O.container},i().createElement(j,{address:o}),i().createElement(R,{contact:a,patientUuid:e}))};var B=n(3280),M={};M.styleTagTransform=C(),M.setAttributes=E(),M.insert=b().bind(null,"head"),M.domAPI=v(),M.insertStyleElement=I(),f()(B.Z,M);const U=B.Z&&B.Z.locals?B.Z.locals:void 0;function V(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function q(){return q=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},q.apply(this,arguments)}const K=function(t){var e,n,d,u,p,m,_,f=t.patient,g=t.handlePatientInfoClick,v=(0,o.useTranslation)().t,h=(m=(0,a.useState)(!1),_=2,function(t){if(Array.isArray(t))return t}(m)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,i,o=[],r=!0,s=!1;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(o.push(a.value),!e||o.length!==e);r=!0);}catch(t){s=!0,i=t}finally{try{r||null==n.return||n.return()}finally{if(s)throw i}}return o}}(m,_)||function(t,e){if(t){if("string"==typeof t)return V(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V(t,e):void 0}}(m,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),b=h[0],y=h[1],E="".concat(null===(n=null===(e=f.name)||void 0===e?void 0:e[0].given)||void 0===n?void 0:n.join(" ")," ").concat(null==f||null===(d=f.name)||void 0===d?void 0:d[0].family),w=i().useMemo((function(){return{patientUuid:f.id,patientName:E}}),[f.id,E]);return i().createElement(r.Ohc,{className:U.container,onClick:g},i().createElement("div",{className:"".concat(b?U.activePatientInfoContainer:U.patientInfoContainer)},i().createElement(c.ExtensionSlot,{extensionSlotName:"patient-photo-slot",state:w}),i().createElement("div",{className:U.patientInfoContent},i().createElement("div",{className:U.patientInfoRow},i().createElement("span",{className:U.patientName},E),i().createElement(c.ConfigurableLink,{to:"${openmrsSpaBase}/patient/".concat(f.id,"/edit"),className:U.patientEditBtn,title:v("editPatientDetails","Edit Patient Details")},i().createElement(s.I8,{size:16}))),i().createElement("div",{className:U.patientInfoRow},i().createElement("div",{className:U.demographics},i().createElement("span",null,(null!==(u=f.gender)&&void 0!==u?u:v("unknown","Unknown")).replace(/^\w/,(function(t){return t.toUpperCase()}))," ·"," "),i().createElement("span",null,(0,c.age)(f.birthDate)," · "),i().createElement("span",null,(0,c.formatDate)((0,c.parseDate)(f.birthDate),{mode:"wide",time:!1})))),i().createElement("div",{className:U.patientInfoRow},i().createElement("span",{className:U.identifier},f.identifier.length?f.identifier.map((function(t){return t.value})).join(", "):"--"),i().createElement(r.zxk,{kind:"ghost",renderIcon:function(t){return b?i().createElement(l.Kh,q({size:16},t)):i().createElement(l._M,q({size:16},t))},iconDescription:"Toggle contact details",onClick:function(t){return function(t){t.stopPropagation(),y((function(t){return!t}))}(t)}},b?v("showLess","Show less"):v("showAllDetails","Show all details"))))),b&&i().createElement(i().Fragment,null,i().createElement(F,{patientId:f.id,address:null!==(p=f.address)&&void 0!==p?p:[],contact:f.contact}),i().createElement(k,{patientUuid:f.id})))}}}]);