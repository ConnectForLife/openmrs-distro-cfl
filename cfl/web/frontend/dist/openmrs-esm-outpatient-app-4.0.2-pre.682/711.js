"use strict";(self.webpackChunk_openmrs_esm_outpatient_app=self.webpackChunk_openmrs_esm_outpatient_app||[]).push([[711],{1472:(e,t,n)=>{n.d(t,{Z:()=>r});var i=n(2609),a=n.n(i)()((function(e){return e[1]}));a.push([e.id,':root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-outpatient__base-visit-type__visitTypeOverviewWrapper___Ejvld{margin:1rem 0rem;border:.0625rem solid #e0e0e0}.-esm-outpatient__base-visit-type__tablet___g7Hry{background-color:#fff}.-esm-outpatient__base-visit-type__desktop___3gyma{background-color:#f4f4f4}.-esm-outpatient__base-visit-type__desktop___3gyma .-esm-outpatient__base-visit-type__paginationContainer___M0-cx div{background-color:#f4f4f4}.-esm-outpatient__base-visit-type__visitTypeOverviewWrapper___Ejvld div:nth-child(3)>div:nth-child(2){position:relative}.-esm-outpatient__base-visit-type__visitTypeOverviewWrapper___Ejvld div:nth-child(3) span *{display:none}.-esm-outpatient__base-visit-type__radioButtonGroup___rqNuL{display:flex;flex-direction:column;align-items:flex-start;margin-top:.5rem;min-height:4rem;width:100%;font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-outpatient__base-visit-type__radioButton___eV5Nk{padding:.25rem 1rem;margin:.5rem 0}.-esm-outpatient__base-visit-type__content___K2t5z{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px);color:#525252;margin-top:1rem;margin-bottom:.5rem}.-esm-outpatient__base-visit-type__desktopHeading___NxESW h4{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);color:#525252}.-esm-outpatient__base-visit-type__tabletHeading___4ZD\\+w h4{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0);color:#525252}.-esm-outpatient__base-visit-type__desktopHeading___NxESW,.-esm-outpatient__base-visit-type__tabletHeading___4ZD\\+w{text-align:left;text-transform:capitalize;margin-bottom:1rem}.-esm-outpatient__base-visit-type__desktopHeading___NxESW h4:after,.-esm-outpatient__base-visit-type__tabletHeading___4ZD\\+w h4:after{content:"";display:block;width:2rem;padding-top:.188rem;border-bottom:.375rem solid var(--brand-03)}.-esm-outpatient__base-visit-type__heading___yDOTa:after{content:"";display:block;width:2rem;padding-top:.188rem;border-bottom:.375rem solid var(--brand-03)}.-esm-outpatient__base-visit-type__tile___9YwF\\+{text-align:center;border:1px solid #e0e0e0}',""]),a.locals={visitTypeOverviewWrapper:"-esm-outpatient__base-visit-type__visitTypeOverviewWrapper___Ejvld",tablet:"-esm-outpatient__base-visit-type__tablet___g7Hry",desktop:"-esm-outpatient__base-visit-type__desktop___3gyma",paginationContainer:"-esm-outpatient__base-visit-type__paginationContainer___M0-cx",radioButtonGroup:"-esm-outpatient__base-visit-type__radioButtonGroup___rqNuL",radioButton:"-esm-outpatient__base-visit-type__radioButton___eV5Nk",content:"-esm-outpatient__base-visit-type__content___K2t5z",desktopHeading:"-esm-outpatient__base-visit-type__desktopHeading___NxESW",tabletHeading:"-esm-outpatient__base-visit-type__tabletHeading___4ZD+w",heading:"-esm-outpatient__base-visit-type__heading___yDOTa",tile:"-esm-outpatient__base-visit-type__tile___9YwF+"};const r=a},2310:(e,t,n)=>{n.d(t,{Z:()=>r});var i=n(2609),a=n.n(i)()((function(e){return e[1]}));a.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-outpatient__visit-form__container___xp88z{margin:1rem 0rem;background-color:#fff}.-esm-outpatient__visit-form__container___xp88z section{margin:.25rem 1rem 0}.-esm-outpatient__visit-form__heading___Nnk2O{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0);margin:1rem}.-esm-outpatient__visit-form__sectionTitle___tN9pC{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);color:#525252;margin-bottom:1rem}.-esm-outpatient__visit-form__dateTimeSection___PUrlP{display:flex}.-esm-outpatient__visit-form__radioButton___p7fFu{margin:1rem 0}.-esm-outpatient__visit-form__headerGridRow___E4viy{border-bottom:.0625rem solid #e0e0e0;margin:0}.-esm-outpatient__visit-form__dataGridRow___FZFLa{display:grid;grid-template-columns:50% 10% 1fr;margin:.5rem 1rem;width:100%}.-esm-outpatient__visit-form__form___Ukebq{background-color:#fff;display:flex;flex-direction:column;justify-content:space-between}.-esm-outpatient__visit-form__button___u2-cp{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-outpatient__visit-form__tablet___BNTJe{padding:1.5rem 1rem;background-color:#fff}.-esm-outpatient__visit-form__desktop___MuBb-{padding:0rem}@media screen and (max-width: 600px){.-esm-outpatient__visit-form__dateTimeSection___PUrlP{flex-direction:column}}.-esm-outpatient__visit-form__backButton___BZ0-t{align-items:center;display:flex;justify-content:flex-start;margin:.5rem 0;padding:0;font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-outpatient__visit-form__backButton___BZ0-t button{display:flex}.-esm-outpatient__visit-form__backButton___BZ0-t button svg{order:1;margin-right:.5rem;margin-left:0rem !important}.-esm-outpatient__visit-form__backButton___BZ0-t button span{order:2}",""]),a.locals={container:"-esm-outpatient__visit-form__container___xp88z",heading:"-esm-outpatient__visit-form__heading___Nnk2O",sectionTitle:"-esm-outpatient__visit-form__sectionTitle___tN9pC",dateTimeSection:"-esm-outpatient__visit-form__dateTimeSection___PUrlP",radioButton:"-esm-outpatient__visit-form__radioButton___p7fFu",headerGridRow:"-esm-outpatient__visit-form__headerGridRow___E4viy",dataGridRow:"-esm-outpatient__visit-form__dataGridRow___FZFLa",form:"-esm-outpatient__visit-form__form___Ukebq",button:"-esm-outpatient__visit-form__button___u2-cp",tablet:"-esm-outpatient__visit-form__tablet___BNTJe",desktop:"-esm-outpatient__visit-form__desktop___MuBb-",backButton:"-esm-outpatient__visit-form__backButton___BZ0-t"};const r=a},8053:(e,t,n)=>{n.d(t,{$z:()=>_,Di:()=>T,KW:()=>g,P4:()=>y,Su:()=>v,W_:()=>f,zI:()=>h});var i=n(5047),a=n.n(i),r=n(8879),o=n.n(r),l=n(9857),s=n(2303),u=n(906),c=n(2228),d=n(7279);function m(e,t,n,i,a,r,o){try{var l=e[r](o),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(i,a)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var r=e.apply(t,n);function o(e){m(r,i,a,o,l,"next",e)}function l(e){m(r,i,a,o,l,"throw",e)}o(void 0)}))}}function v(e){var t,n="/ws/rest/v1/queue?location=".concat(e),i=(0,s.Z)(n,u.openmrsFetch).data;return{services:i?null==i||null===(t=i.data)||void 0===t?void 0:t.results:[]}}function _(){var e,t=(0,u.useConfig)().concepts.statusConceptSetUuid,n="/ws/rest/v1/concept/".concat(t),i=(0,s.Z)(n,u.openmrsFetch),a=i.data,r=i.error;return{statuses:a?null==a||null===(e=a.data)||void 0===e?void 0:e.setMembers:[],isLoading:!a&&!r}}function f(){var e,t=(0,u.useConfig)().concepts.priorityConceptSetUuid,n="/ws/rest/v1/concept/".concat(t),i=(0,s.Z)(n,u.openmrsFetch).data;return{priorities:i?null==i||null===(e=i.data)||void 0===e?void 0:e.setMembers:[]}}function y(){var e,t,n=(0,l.ZP)("/ws/rest/v1/visit-queue-entry?v=full",u.openmrsFetch),i=n.data,a=n.error,r=n.isValidating,s=function(e){var t,n,i;return{diagnoses:e.diagnoses,encounterDatetime:e.encounterDatetime,encounterType:e.encounterType.display,obs:e.obs,provider:null===(t=e.encounterProviders[0])||void 0===t||null===(n=t.provider)||void 0===n||null===(i=n.person)||void 0===i?void 0:i.display,uuid:e.uuid,voided:e.voided}},c=null==i||null===(e=i.data)||void 0===e||null===(t=e.results)||void 0===t?void 0:t.map((function(e){var t,n,i,a,r,l,c,d,m,p,v;return{id:e.queueEntry.uuid,encounters:null===(t=e.visit)||void 0===t||null===(n=t.encounters)||void 0===n?void 0:n.map(s),name:e.queueEntry.display,patientUuid:e.queueEntry.patient.uuid,patientAge:null===(i=e.queueEntry.patient.person)||void 0===i?void 0:i.age,patientSex:"M"===(null===(a=e.queueEntry.patient.person)||void 0===a?void 0:a.gender)?"MALE":"FEMALE",patientDob:(null==e||null===(r=e.queueEntry)||void 0===r||null===(l=r.patient)||void 0===l||null===(c=l.person)||void 0===c?void 0:c.birthdate)?(0,u.formatDate)((0,u.parseDate)(e.queueEntry.patient.person.birthdate),{time:!1}):"--",priority:"Urgent"===e.queueEntry.priority.display?"Priority":e.queueEntry.priority.display,priorityComment:e.queueEntry.priorityComment,priorityUuid:e.queueEntry.priority.uuid,service:e.queueEntry.queue.service.display,status:e.queueEntry.status.display,statusUuid:e.queueEntry.status.uuid,waitTime:e.queueEntry.startedAt?"".concat(o()().diff(o()(e.queueEntry.startedAt),"minutes")):"--",visitStartDateTime:null===(d=e.visit)||void 0===d?void 0:d.visitStartDateTime,visitType:null===(m=e.visit)||void 0===m||null===(p=m.visitType)||void 0===p?void 0:p.display,visitUuid:null===(v=e.visit)||void 0===v?void 0:v.uuid,queueUuid:e.queueEntry.queue.uuid,queueEntryUuid:e.queueEntry.uuid}}));return{visitQueueEntries:c||null,isLoading:!i&&!a,isError:a,isValidating:r}}var g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split("/");return(0,c.Z)(t)};function h(e,t,n,i,a,r,o,l,s){return b.apply(this,arguments)}function b(){return(b=p(a().mark((function e(t,n,i,r,o,l,s,c,m){var p;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p=(0,d.Z)(i)?n:i,e.next=3,Promise.all([E(n,m,r,c)]);case 3:return e.abrupt("return",(0,u.openmrsFetch)("/ws/rest/v1/visit-queue-entry",{method:"POST",headers:{"Content-Type":"application/json"},signal:m.signal,body:{visit:{uuid:t},queueEntry:{status:{uuid:s},priority:{uuid:l},queue:{uuid:p},patient:{uuid:o},startedAt:(0,u.toDateObjectStrict)((0,u.toOmrsIsoString)(new Date))}}}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t,n,i){return S.apply(this,arguments)}function S(){return(S=p(a().mark((function e(t,n,i,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.openmrsFetch)("/ws/rest/v1/queue/".concat(t,"/entry/").concat(i),{method:"POST",headers:{"Content-Type":"application/json"},signal:n.signal,body:{endedAt:r}});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){var t,n,i="/ws/rest/v1/visit-queue-entry?status=waiting&service=".concat(e,"&v=full"),a=(0,l.ZP)(i,u.openmrsFetch),r=a.data,o=a.error,s=a.isValidating,c=null==r||null===(t=r.data)||void 0===t||null===(n=t.results)||void 0===n?void 0:n.map((function(e){var t,n,i,a,r,o,l,s,u,c;return{id:e.queueEntry.uuid,name:e.queueEntry.display,age:e.queueEntry.patient?null==e||null===(t=e.queueEntry)||void 0===t||null===(n=t.patient)||void 0===n||null===(i=n.person)||void 0===i?void 0:i.age:"--",returnDate:null===(a=e.visit)||void 0===a?void 0:a.visitStartDateTime,visitType:null===(r=e.visit)||void 0===r||null===(o=r.visitType)||void 0===o?void 0:o.display,phoneNumber:e.patient?null===(l=e.patient)||void 0===l?void 0:l.phoneNumber:"--",gender:e.queueEntry.patient?null==e||null===(s=e.queueEntry)||void 0===s||null===(u=s.patient)||void 0===u||null===(c=u.person)||void 0===c?void 0:c.gender:"--",patientUuid:e.queueEntry?null==e?void 0:e.queueEntry.uuid:"--"}}));return{serviceQueueEntries:c||null,isLoading:!r&&!o,isError:o,isValidating:s}}},753:(e,t,n)=>{function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}n.d(t,{A:()=>a});var a=function(e,t){var n,a,r=(n=e.split(":"),a=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,r=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return r}}(n,a)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(n,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],l=r[1];return"12"===o&&"AM"===t&&(o="00"),"PM"===t&&(o="12"===o?o:parseInt(o,10)+12),[o,l]}},2836:(e,t,n)=>{n.d(t,{h_:()=>d,Bf:()=>s,xD:()=>c,Su:()=>u});var i=n(9857),a=n(2303),r=n(906),o=n(8879),l=n.n(o);function s(){var e=(0,i.ZP)("/ws/rest/v1/queue?",r.openmrsFetch),t=e.data,n=e.error;return{metrics:{scheduled_appointments:100,average_wait_time:28,patients_waiting_for_service:182},isError:n,isLoading:!t&&!n}}function u(e){var t,n,i="/ws/rest/v1/queue?location=".concat(e),o=(0,a.Z)(i,r.openmrsFetch).data;return{services:o?null==o||null===(t=o.data)||void 0===t||null===(n=t.results)||void 0===n?void 0:n.map((function(e){return e.display})):[],allServices:o?null==o?void 0:o.data.results:[]}}function c(e){var t,n="/ws/rest/v1/queue-entry-metrics?service=".concat(e,"&status=").concat("Waiting"),i=(0,a.Z)(n,r.openmrsFetch).data;return{serviceCount:i?null==i||null===(t=i.data)||void 0===t?void 0:t.count:0}}var d=function(){var e,t,n=l()((new Date).setHours(0,0,0,0)).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),a=l()((new Date).setHours(23,59,59,59)).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),o="/ws/rest/v1/appointment/appointmentSummary?startDate=".concat(n,"&endDate=").concat(a),s=(0,i.ZP)(o,r.openmrsFetch),u=s.data,c=s.error;return s.mutate,{isLoading:!u&&!c,error:c,totalScheduledAppointments:(t=null!==(e=null==u?void 0:u.data)&&void 0!==e?e:[],"allAppointmentsCount",t.map((function(e){return Object.entries(e.appointmentCountMap).flatMap((function(e){return e[1].allAppointmentsCount}))})).flat(1).reduce((function(e,t){return e+t}),0))}}},2621:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(5206);const a=function(e){var t=e.width,n=void 0===t?"61":t,a=e.height,r=void 0===a?"59":a;return i.createElement("svg",{width:n,height:r,viewBox:"0 0 61 59"},i.createElement("title",null,"Empty data illustration"),i.createElement("g",{fill:"none",fillRule:"evenodd"},i.createElement("path",{d:"M38.133 13.186H21.947c-.768.001-1.39.623-1.39 1.391V50.55l-.186.057-3.97 1.216a.743.743 0 01-.927-.493L3.664 12.751a.742.742 0 01.492-.926l6.118-1.874 17.738-5.43 6.119-1.873a.741.741 0 01.926.492L38.076 13l.057.186z",fill:"#E0E0E0"}),i.createElement("path",{d:"M41.664 13L38.026 1.117A1.576 1.576 0 0036.056.07l-8.601 2.633-17.737 5.43-8.603 2.634a1.578 1.578 0 00-1.046 1.97l12.436 40.616a1.58 1.58 0 001.969 1.046l5.897-1.805.185-.057v-.194l-.185.057-5.952 1.822a1.393 1.393 0 01-1.737-.923L.247 12.682a1.39 1.39 0 01.923-1.738L9.772 8.31 27.51 2.881 36.112.247a1.393 1.393 0 011.737.923L41.47 13l.057.186h.193l-.057-.185z",fill:"#8D8D8D"}),i.createElement("path",{d:"M11.378 11.855a.836.836 0 01-.798-.59L9.385 7.361a.835.835 0 01.554-1.042l16.318-4.996a.836.836 0 011.042.554l1.195 3.902a.836.836 0 01-.554 1.043l-16.318 4.995a.831.831 0 01-.244.037z",fill:"#C6C6C6"}),i.createElement("circle",{fill:"#C6C6C6",cx:17.636,cy:2.314,r:1.855}),i.createElement("circle",{fill:"#FFF",fillRule:"nonzero",cx:17.636,cy:2.314,r:1.175}),i.createElement("path",{d:"M55.893 53.995H24.544a.79.79 0 01-.788-.789V15.644a.79.79 0 01.788-.788h31.349a.79.79 0 01.788.788v37.562a.79.79 0 01-.788.789z",fill:"#E0E0E0"}),i.createElement("path",{d:"M41.47 13H21.948a1.579 1.579 0 00-1.576 1.577V52.4l.185-.057V14.577c.001-.768.623-1.39 1.391-1.39h19.581L41.471 13zm17.02 0H21.947a1.579 1.579 0 00-1.576 1.577v42.478c0 .87.706 1.576 1.576 1.577H58.49a1.579 1.579 0 001.576-1.577V14.577a1.579 1.579 0 00-1.576-1.576zm1.39 44.055c0 .768-.622 1.39-1.39 1.392H21.947c-.768-.001-1.39-.624-1.39-1.392V14.577c0-.768.622-1.39 1.39-1.39H58.49c.768 0 1.39.622 1.39 1.39v42.478z",fill:"#8D8D8D"}),i.createElement("path",{d:"M48.751 17.082H31.686a.836.836 0 01-.835-.835v-4.081c0-.46.374-.834.835-.835H48.75c.461 0 .834.374.835.835v4.08c0 .462-.374.835-.835.836z",fill:"#C6C6C6"}),i.createElement("circle",{fill:"#C6C6C6",cx:40.218,cy:9.755,r:1.855}),i.createElement("circle",{fill:"#FFF",fillRule:"nonzero",cx:40.218,cy:9.755,r:1.13})))}},3655:(e,t,n)=>{n.d(t,{L:()=>a});var i=n(906);function a(e,t){return(0,i.openmrsObservableFetch)("/ws/rest/v1/visit-queue-entry",{signal:t.signal,method:"POST",headers:{"Content-type":"application/json"},body:e})}},6711:(e,t,n)=>{n.r(t),n.d(t,{default:()=>K});var i=n(5206),a=n.n(i),r=n(8879),o=n.n(r),l=n(5885),s=n(8648),u=n(6759),c=n(4924),d=n(906),m=n(6062),p=n.n(m),v=n(4036),_=n.n(v),f=n(6793),y=n.n(f),g=n(7892),h=n.n(g),b=n(1173),E=n.n(b),S=n(2464),T=n.n(S),w=n(2310),x={};x.styleTagTransform=T(),x.setAttributes=h(),x.insert=y().bind(null,"head"),x.domAPI=_(),x.insertStyleElement=E(),p()(w.Z,x);const C=w.Z&&w.Z.locals?w.Z.locals:void 0;var k=n(8697),D=n(3914),P=n(7279),O=n(2621),q=n(1472),A={};A.styleTagTransform=T(),A.setAttributes=h(),A.insert=y().bind(null,"head"),A.domAPI=_(),A.insertStyleElement=E(),p()(q.Z,A);const N=q.Z&&q.Z.locals?q.Z.locals:void 0;function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}const M=function(e){var t,n,r=e.onChange,o=e.visitTypes,l=(0,c.useTranslation)().t,u="tablet"===(0,d.useLayoutType)(),m=(t=(0,i.useState)(""),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,r=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return r}}(t,n)||function(e,t){if(e){if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=m[0],v=m[1],_=(0,i.useMemo)((function(){return(0,P.Z)(p)?o:o.filter((function(e){return-1!==e.display.toLowerCase().search(p.toLowerCase())}))}),[p,o]),f=a().useMemo((function(){return(0,D.Z)((function(e){return v(e)}),300)}),[]),y=(0,d.usePagination)(_,5),g=y.results;return y.currentPage,y.goTo,a().createElement("div",{className:"".concat(N.visitTypeOverviewWrapper," ").concat(u?N.tablet:N.desktop)},g.length?a().createElement(a().Fragment,null,u?a().createElement(s.mh4,null,a().createElement(s.olm,{onChange:function(e){return f(e.target.value)},placeholder:l("searchForAVisitType","Search for a visit type"),labelText:""})):a().createElement(s.olm,{onChange:function(e){return f(e.target.value)},placeholder:l("searchForAVisitType","Search for a visit type"),labelText:""}),a().createElement(s.SYO,{className:N.radioButtonGroup,defaultSelected:"default-selected",orientation:"vertical",onChange:r,name:"radio-button-group",valueSelected:"default-selected"},g.map((function(e){var t=e.uuid,n=e.display,i=e.name;return a().createElement(s.EUY,{key:t,className:N.radioButton,id:i,labelText:n,value:t})})))):a().createElement(s.mh4,null,a().createElement(s.n9L,{className:N.tile},a().createElement("div",{className:u?N.tabletHeading:N.desktopHeading},a().createElement("h4",null,l("visitType","Visit type"))),a().createElement(O.Z,null),a().createElement("p",{className:N.content},l("noVisitTypes","There are no visit types to display for this patient")))))};var L=n(753),Z=n(9857);function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var V=function(e){return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){j(e,t,n[t])}))}return e}({},e),n=null!=(n={display:e.name})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n.push.apply(n,i)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t;var t,n},H=function(e){var t,n=e.patientUuid,r=e.patientProgramEnrollment,o=e.onChange,l=e.locationUuid,u=function(e,t,n,a){var r,o=(0,d.useConfig)(),l=o.visitTypeResourceUrl,s=o.showRecommendedVisitTypeTab,u=(0,Z.ZP)(s&&e&&t&&n&&"".concat(l).concat(e,"/program/").concat(n,"/enrollment/").concat(t,"?intendedLocationUuid=").concat(a),d.openmrsFetch),c=u.data,m=u.error,p=(0,i.useMemo)((function(){var e,t;return null!==(r=null==c||null===(e=c.data)||void 0===e||null===(t=e.visitTypes)||void 0===t?void 0:t.allowed.map(V))&&void 0!==r?r:[]}),[c]);return{recommendedVisitTypes:p,error:m,isLoading:!c&&!m}}(n,null==r?void 0:r.uuid,null==r||null===(t=r.program)||void 0===t?void 0:t.uuid,l),m=u.recommendedVisitTypes,p=(u.error,u.isLoading,(0,c.useTranslation)().t),v="tablet"===(0,d.useLayoutType)();return a().createElement("div",{style:{marginTop:"0.625rem"}},m.length>0?a().createElement(M,{onChange:o,visitTypes:m,patientUuid:n}):a().createElement(s.mh4,null,a().createElement(s.n9L,{className:N.tile},a().createElement("div",{className:v?N.tabletHeading:N.desktopHeading},a().createElement("h4",null,p("recommendedVisitType","Recommended Visit type"))),a().createElement(O.Z,null),a().createElement("p",{className:N.content},p("noRecommendedVisitTypes","There are no recommended visit types to display for this patient")))))},z=a().memo(H),B=n(814),I=n(3655),U=n(8053),R=n(2836),W=n(7964),Y=n(12);function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Q(){return Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Q.apply(this,arguments)}function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,r=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const K=function(e){var t,n=e.patientUuid,r=e.toggleSearchType,m=e.closePanel,p=e.mode,v=(0,c.useTranslation)().t,_="tablet"===(0,d.useLayoutType)(),f=(0,d.useLocations)(),y=(0,d.useSession)(),g=$((0,i.useState)(0),2),h=g[0],b=g[1],E=$((0,i.useState)(!1),2),S=E[0],T=E[1],w=$((0,i.useState)(!1),2),x=w[0],D=w[1],P=$((0,i.useState)(""),2),O=P[0],q=P[1],A=$((0,i.useState)((new Date).getHours()>=12?"PM":"AM"),2),N=A[0],F=A[1],j=$((0,i.useState)(new Date),2),V=j[0],H=j[1],G=$((0,i.useState)(o()(new Date).format("hh:mm")),2),K=G[0],X=G[1],J=$((0,i.useState)(null),2),ee=J[0],te=J[1],ne=(0,i.useMemo)((function(){return{patientUuid:n}}),[n]),ie=(0,d.useVisitTypes)(),ae=$((0,i.useState)(!0),2),re=(ae[0],ae[1]),oe=function(e){var t,n=(0,Z.ZP)("/ws/rest/v1/programenrollment?patient=".concat(e,"&v=").concat("custom:(uuid,display,program,dateEnrolled,dateCompleted,location:(uuid,display))"),d.openmrsFetch),a=n.data,r=n.error,o=(0,i.useMemo)((function(){return null!==(t=null==a?void 0:a.data.results.sort((function(e,t){return t.dateEnrolled>e.dateEnrolled?1:-1})).filter((function(e){return null===e.dateCompleted})))&&void 0!==t?t:[]}),[null==a?void 0:a.data.results]);return{activePatientEnrollment:(0,B.Z)(o,(function(e){var t;return null==e||null===(t=e.program)||void 0===t?void 0:t.uuid})),error:r,isLoading:!a&&!r}}(n),le=oe.activePatientEnrollment,se=oe.isLoading,ue=$((0,i.useState)(le[0]),2),ce=ue[0],de=ue[1],me=$((0,i.useState)(""),2),pe=me[0],ve=me[1],_e=(0,U.W_)().priorities,fe=(0,U.$z)().statuses,ye=(0,R.Su)(O).allServices,ge=(0,Z.kY)().mutate,he=$((0,i.useState)(""),2),be=he[0],Ee=he[1],Se=(0,d.useConfig)();(0,i.useEffect)((function(){var e,t;f&&(null==y||null===(e=y.sessionLocation)||void 0===e?void 0:e.uuid)&&q(null==y||null===(t=y.sessionLocation)||void 0===t?void 0:t.uuid)}),[f,y]);var Te=(0,i.useCallback)((function(e){if(e.preventDefault(),ee){D(!0);var t=$((0,L.A)(K,N),2),i=t[0],a=t[1],r={patient:n,startDatetime:(0,d.toDateObjectStrict)((0,d.toOmrsIsoString)(new Date(o()(V).year(),o()(V).month(),o()(V).date(),i,a))),visitType:ee,location:O},s=new AbortController;(0,d.saveVisit)(r,s).pipe((0,l.P)()).subscribe((function(e){if(201===e.status){var t;(0,W.Z)(be)&&Ee(null===(t=(0,Y.Z)(ye))||void 0===t?void 0:t.uuid);var r=fe.find((function(e){return"waiting"===e.display.toLowerCase()})).uuid,o=_e.find((function(e){return"not urgent"===e.display.toLowerCase()})).uuid,u={visit:{uuid:e.data.uuid},queueEntry:{status:{uuid:r},priority:{uuid:pe||o},queue:{uuid:be},patient:{uuid:n},startedAt:(0,d.toDateObjectStrict)((0,d.toOmrsIsoString)(new Date))}};(0,I.L)(u,s).pipe((0,l.P)()).subscribe((function(e){201===e.status&&((0,d.showToast)({kind:"success",title:v("startVisit","Start a visit"),description:v("startVisitQueueSuccessfully","Patient has been added to active visits list and queue.","".concat(i," : ").concat(a))}),m(),ge("/ws/rest/v1/visit-queue-entry?v=full"))}),(function(e){(0,d.showNotification)({title:v("queueEntryError","Error adding patient to the queue"),kind:"error",critical:!0,description:null==e?void 0:e.message})}))}}),(function(e){(0,d.showNotification)({title:v("startVisitError","Error starting visit"),kind:"error",critical:!0,description:null==e?void 0:e.message})}))}else T(!0)}),[ee,K,N,n,V,O,be,fe,pe,ye,_e,v,m,ge]);return a().createElement(s.l09,{className:C.form,onChange:function(){re((function(e){return!e}))}},a().createElement("div",null,_&&a().createElement(s.X2j,{className:C.headerGridRow},a().createElement(d.ExtensionSlot,{extensionSlotName:"visit-form-header-slot",className:C.dataGridRow,state:ne})),a().createElement("div",{className:C.backButton},!0===p?a().createElement(s.zxk,{kind:"ghost",renderIcon:u.Xd,iconDescription:"Back to search results",size:"sm",onClick:function(){return r(k.a.BASIC,n)}},a().createElement("span",null,v("backToSearchResults","Back to search results"))):a().createElement(s.zxk,{kind:"ghost",renderIcon:function(e){return a().createElement(u.Xd,Q({size:24},e))},iconDescription:v("backToScheduledVisits","Back to scheduled visits"),size:"sm",onClick:function(){return r(k.a.SCHEDULED_VISITS,n)}},a().createElement("span",null,v("backToScheduledVisits","Back to scheduled visits")))),a().createElement(s.Kqy,{gap:8,className:C.container},a().createElement("section",{className:C.section},a().createElement("div",{className:C.sectionTitle},v("dateAndTimeOfVisit","Date and time of visit")),a().createElement("div",{className:C.dateTimeSection},_?a().createElement(s.mh4,null,a().createElement(s.Mtg,{dateFormat:"d/m/Y",datePickerType:"single",id:"visitDate",style:{paddingBottom:"1rem"},maxDate:(new Date).toISOString(),onChange:function(e){var t=$(e,1)[0];return H(t)},value:V},a().createElement(s.aj6,{id:"visitStartDateInput",labelText:v("date","Date"),placeholder:"dd/mm/yyyy",style:{width:"100%"}}))):a().createElement(s.Mtg,{dateFormat:"d/m/Y",datePickerType:"single",id:"visitDate",style:{paddingBottom:"1rem"},maxDate:(new Date).toISOString(),onChange:function(e){var t=$(e,1)[0];return H(t)},value:V},a().createElement(s.aj6,{id:"visitStartDateInput",labelText:v("date","Date"),placeholder:"dd/mm/yyyy",style:{width:"100%"}})),_?a().createElement(s.mh4,null,a().createElement(s.jII,{id:"visitStartTime",labelText:v("time","Time"),onChange:function(e){return X(e.target.value)},pattern:"^(1[0-2]|0?[1-9]):([0-5]?[0-9])$",style:{marginLeft:"0.125rem",flex:"none"},value:K},a().createElement(s.M6n,{id:"visitStartTimeSelect",onChange:function(e){return F(e.target.value)},value:N,labelText:v("time","Time"),"aria-label":v("time","Time")},a().createElement(s.QlF,{value:"AM",text:"AM"}),a().createElement(s.QlF,{value:"PM",text:"PM"})))):a().createElement(s.jII,{id:"visitStartTime",labelText:v("time","Time"),onChange:function(e){return X(e.target.value)},pattern:"^(1[0-2]|0?[1-9]):([0-5]?[0-9])$",style:{marginLeft:"0.125rem",flex:"none"},value:K},a().createElement(s.M6n,{id:"visitStartTimeSelect",onChange:function(e){return F(e.target.value)},value:N,labelText:v("time","Time"),"aria-label":v("time","Time")},a().createElement(s.QlF,{value:"AM",text:"AM"}),a().createElement(s.QlF,{value:"PM",text:"PM"}))))),a().createElement("section",{className:C.section},a().createElement("div",{className:C.sectionTitle},v("visitLocation","Visit Location")),_?a().createElement(s.mh4,null,a().createElement(s.PhF,{labelText:v("selectLocation","Select a location"),id:"location",invalidText:"Required",value:O,onChange:function(e){return q(e.target.value)}},(null==f?void 0:f.length)>0&&f.map((function(e){return a().createElement(s.QlF,{key:e.uuid,text:e.display,value:e.uuid},e.display)})))):a().createElement(s.PhF,{labelText:v("selectLocation","Select a location"),id:"location",invalidText:"Required",value:O,onChange:function(e){return q(e.target.value)}},(null==f?void 0:f.length)>0&&f.map((function(e){return a().createElement(s.QlF,{key:e.uuid,text:e.display,value:e.uuid},e.display)})))),Se.showRecommendedVisitTypeTab&&a().createElement("section",null,a().createElement("div",{className:C.sectionTitle},v("program","Program")),a().createElement(s.cwH,{legendText:v("selectProgramType","Select program type")},a().createElement(s.SYO,{defaultSelected:null==ce||null===(t=ce.program)||void 0===t?void 0:t.uuid,orientation:"vertical",onChange:function(e){return de(le.find((function(t){return t.program.uuid===e})))},name:"program-type-radio-group",valueSelected:"default-selected"},le.map((function(e){var t=e.uuid,n=e.display,i=e.program;return a().createElement(s.EUY,{key:t,className:C.radioButton,id:t,labelText:n,value:i.uuid})}))))),a().createElement("section",null,a().createElement("div",{className:C.sectionTitle},v("visitType","Visit Type")),a().createElement(s.GHR,{selectedIndex:h,className:C.contentSwitcher,onChange:function(e){var t=e.index;return b(t)}},a().createElement(s.rsf,{name:"recommended",text:v("recommended","Recommended")}),a().createElement(s.rsf,{name:"all",text:v("all","All")})),0===h&&!se&&a().createElement(z,{onChange:function(e){te(e),T(!1)},patientUuid:n,patientProgramEnrollment:ce,locationUuid:O}),1===h&&a().createElement(M,{onChange:function(e){te(e),T(!1)},visitTypes:ie,patientUuid:n})),S&&a().createElement("section",null,a().createElement(s.K0D,{style:{margin:"0",minWidth:"100%"},kind:"error",lowContrast:!0,title:v("missingVisitType","Missing visit type"),subtitle:v("selectVisitType","Please select a Visit Type")})),a().createElement("section",{className:C.section},a().createElement("div",{className:C.sectionTitle},v("service","Service")),a().createElement(s.PhF,{labelText:v("selectService","Select a service"),id:"service",invalidText:"Required",value:be,onChange:function(e){return Ee(e.target.value)}},be?null:a().createElement(s.QlF,{text:v("chooseService","Select a service"),value:""}),(null==ye?void 0:ye.length)>0&&ye.map((function(e){return a().createElement(s.QlF,{key:e.uuid,text:e.display,value:e.uuid},e.display)})))),a().createElement("section",{className:C.section},a().createElement("div",{className:C.sectionTitle},v("priority","Priority")),a().createElement(s.GHR,{size:"sm",selectionMode:"manual",onChange:function(e){ve(e.name)}},(null==_e?void 0:_e.length)>0?_e.map((function(e){var t=e.uuid,n=e.display;return a().createElement(s.rsf,{name:t,text:n,value:t,index:t})})):a().createElement(s.rsf,{name:v("noPriorityFound","No priority found"),text:v("noPriorityFound","No priority found"),value:null}))))),a().createElement(s.uVA,{className:_?C.tablet:C.desktop},a().createElement(s.zxk,{className:C.button,kind:"secondary",onClick:m},v("discard","Discard")),a().createElement(s.zxk,{onClick:Te,className:C.button,disabled:x,kind:"primary",type:"submit"},v("startVisit","Start visit"))))}},8697:(e,t,n)=>{var i,a;n.d(t,{K:()=>a,a:()=>i}),function(e){e.BASIC="basic",e.ADVANCED="advanced",e.SEARCH_RESULTS="search_results",e.SCHEDULED_VISITS="scheduled-visits",e.VISIT_FORM="visit_form",e.QUEUE_SERVICE_FORM="queue_service_form"}(i||(i={})),function(e){e[e.SHOW=0]="SHOW",e[e.HIDE=1]="HIDE"}(a||(a={}))}}]);