"use strict";(self.webpackChunk_openmrs_esm_outpatient_app=self.webpackChunk_openmrs_esm_outpatient_app||[]).push([[655],{1449:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(2609),r=n.n(i)()((function(e){return e[1]}));r.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-outpatient__change-status-dialog__radioButtonGroup___QfqBM{display:flex;flex-direction:column;align-items:flex-start;margin-top:.5rem;min-height:4rem;width:100%;font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-outpatient__change-status-dialog__radioButton___PgfLT{padding:.25rem .25rem;margin:.5rem 0}section{margin:.5rem}.-esm-outpatient__change-status-dialog__sectionTitle___edrwy{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);color:#525252;margin-bottom:.75rem}.-esm-outpatient__change-status-dialog__modalBody___4DBny{padding-bottom:1rem}",""]),r.locals={radioButtonGroup:"-esm-outpatient__change-status-dialog__radioButtonGroup___QfqBM",radioButton:"-esm-outpatient__change-status-dialog__radioButton___PgfLT",sectionTitle:"-esm-outpatient__change-status-dialog__sectionTitle___edrwy",modalBody:"-esm-outpatient__change-status-dialog__modalBody___4DBny"};const u=r},8053:(e,t,n)=>{n.d(t,{$z:()=>y,Di:()=>q,KW:()=>h,P4:()=>g,Su:()=>m,W_:()=>f,zI:()=>E});var i=n(5047),r=n.n(i),u=n(8879),a=n.n(u),o=n(9857),s=n(2303),l=n(906),d=n(2228),c=n(7279);function p(e,t,n,i,r,u,a){try{var o=e[u](a),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(i,r)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var u=e.apply(t,n);function a(e){p(u,i,r,a,o,"next",e)}function o(e){p(u,i,r,a,o,"throw",e)}a(void 0)}))}}function m(e){var t,n="/ws/rest/v1/queue?location=".concat(e),i=(0,s.Z)(n,l.openmrsFetch).data;return{services:i?null==i||null===(t=i.data)||void 0===t?void 0:t.results:[]}}function y(){var e,t=(0,l.useConfig)().concepts.statusConceptSetUuid,n="/ws/rest/v1/concept/".concat(t),i=(0,s.Z)(n,l.openmrsFetch),r=i.data,u=i.error;return{statuses:r?null==r||null===(e=r.data)||void 0===e?void 0:e.setMembers:[],isLoading:!r&&!u}}function f(){var e,t=(0,l.useConfig)().concepts.priorityConceptSetUuid,n="/ws/rest/v1/concept/".concat(t),i=(0,s.Z)(n,l.openmrsFetch).data;return{priorities:i?null==i||null===(e=i.data)||void 0===e?void 0:e.setMembers:[]}}function g(){var e,t,n=(0,o.ZP)("/ws/rest/v1/visit-queue-entry?v=full",l.openmrsFetch),i=n.data,r=n.error,u=n.isValidating,s=function(e){var t,n,i;return{diagnoses:e.diagnoses,encounterDatetime:e.encounterDatetime,encounterType:e.encounterType.display,obs:e.obs,provider:null===(t=e.encounterProviders[0])||void 0===t||null===(n=t.provider)||void 0===n||null===(i=n.person)||void 0===i?void 0:i.display,uuid:e.uuid,voided:e.voided}},d=null==i||null===(e=i.data)||void 0===e||null===(t=e.results)||void 0===t?void 0:t.map((function(e){var t,n,i,r,u,o,d,c,p,v,m;return{id:e.queueEntry.uuid,encounters:null===(t=e.visit)||void 0===t||null===(n=t.encounters)||void 0===n?void 0:n.map(s),name:e.queueEntry.display,patientUuid:e.queueEntry.patient.uuid,patientAge:null===(i=e.queueEntry.patient.person)||void 0===i?void 0:i.age,patientSex:"M"===(null===(r=e.queueEntry.patient.person)||void 0===r?void 0:r.gender)?"MALE":"FEMALE",patientDob:(null==e||null===(u=e.queueEntry)||void 0===u||null===(o=u.patient)||void 0===o||null===(d=o.person)||void 0===d?void 0:d.birthdate)?(0,l.formatDate)((0,l.parseDate)(e.queueEntry.patient.person.birthdate),{time:!1}):"--",priority:"Urgent"===e.queueEntry.priority.display?"Priority":e.queueEntry.priority.display,priorityComment:e.queueEntry.priorityComment,priorityUuid:e.queueEntry.priority.uuid,service:e.queueEntry.queue.service.display,status:e.queueEntry.status.display,statusUuid:e.queueEntry.status.uuid,waitTime:e.queueEntry.startedAt?"".concat(a()().diff(a()(e.queueEntry.startedAt),"minutes")):"--",visitStartDateTime:null===(c=e.visit)||void 0===c?void 0:c.visitStartDateTime,visitType:null===(p=e.visit)||void 0===p||null===(v=p.visitType)||void 0===v?void 0:v.display,visitUuid:null===(m=e.visit)||void 0===m?void 0:m.uuid,queueUuid:e.queueEntry.queue.uuid,queueEntryUuid:e.queueEntry.uuid}}));return{visitQueueEntries:d||null,isLoading:!i&&!r,isError:r,isValidating:u}}var h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split("/");return(0,d.Z)(t)};function E(e,t,n,i,r,u,a,o,s){return _.apply(this,arguments)}function _(){return(_=v(r().mark((function e(t,n,i,u,a,o,s,d,p){var v;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v=(0,c.Z)(i)?n:i,e.next=3,Promise.all([S(n,p,u,d)]);case 3:return e.abrupt("return",(0,l.openmrsFetch)("/ws/rest/v1/visit-queue-entry",{method:"POST",headers:{"Content-Type":"application/json"},signal:p.signal,body:{visit:{uuid:t},queueEntry:{status:{uuid:s},priority:{uuid:o},queue:{uuid:v},patient:{uuid:a},startedAt:(0,l.toDateObjectStrict)((0,l.toOmrsIsoString)(new Date))}}}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t,n,i){return b.apply(this,arguments)}function b(){return(b=v(r().mark((function e(t,n,i,u){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.openmrsFetch)("/ws/rest/v1/queue/".concat(t,"/entry/").concat(i),{method:"POST",headers:{"Content-Type":"application/json"},signal:n.signal,body:{endedAt:u}});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){var t,n,i="/ws/rest/v1/visit-queue-entry?status=waiting&service=".concat(e,"&v=full"),r=(0,o.ZP)(i,l.openmrsFetch),u=r.data,a=r.error,s=r.isValidating,d=null==u||null===(t=u.data)||void 0===t||null===(n=t.results)||void 0===n?void 0:n.map((function(e){var t,n,i,r,u,a,o,s,l,d;return{id:e.queueEntry.uuid,name:e.queueEntry.display,age:e.queueEntry.patient?null==e||null===(t=e.queueEntry)||void 0===t||null===(n=t.patient)||void 0===n||null===(i=n.person)||void 0===i?void 0:i.age:"--",returnDate:null===(r=e.visit)||void 0===r?void 0:r.visitStartDateTime,visitType:null===(u=e.visit)||void 0===u||null===(a=u.visitType)||void 0===a?void 0:a.display,phoneNumber:e.patient?null===(o=e.patient)||void 0===o?void 0:o.phoneNumber:"--",gender:e.queueEntry.patient?null==e||null===(s=e.queueEntry)||void 0===s||null===(l=s.patient)||void 0===l||null===(d=l.person)||void 0===d?void 0:d.gender:"--",patientUuid:e.queueEntry?null==e?void 0:e.queueEntry.uuid:"--"}}));return{serviceQueueEntries:d||null,isLoading:!u&&!a,isError:a,isValidating:s}}},2655:(e,t,n)=>{n.r(t),n.d(t,{default:()=>U});var i=n(5206),r=n.n(i),u=n(8648),a=n(906),o=n(8053),s=n(4924),l=n(6062),d=n.n(l),c=n(4036),p=n.n(c),v=n(6793),m=n.n(v),y=n(7892),f=n.n(y),g=n(1173),h=n.n(g),E=n(2464),_=n.n(E),S=n(1449),b={};b.styleTagTransform=_(),b.setAttributes=f(),b.insert=m().bind(null,"head"),b.domAPI=p(),b.insertStyleElement=h(),d()(S.Z,b);const q=S.Z&&S.Z.locals?S.Z.locals:void 0;var w=n(9857),T=n(12);function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,u=[],a=!0,o=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(u.push(i.value),!t||u.length!==t);a=!0);}catch(e){o=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(o)throw r}}return u}}(e,t)||C(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){if(e){if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}const U=function(e){var t=e.queueEntry,n=e.closeModal,l=(0,s.useTranslation)().t,d=A((0,i.useState)(t.statusUuid),2),c=d[0],p=d[1],v=A((0,i.useState)(t.priorityUuid),2),m=v[0],y=v[1],f=A((0,i.useState)(t.visitUuid),2),g=f[0],h=(f[1],A((0,i.useState)(t.queueUuid),2)),E=h[0],_=(h[1],A((0,i.useState)(""),2)),S=_[0],b=_[1],U=A((0,i.useState)(t.queueEntryUuid),2),k=U[0],P=(U[1],A((0,i.useState)(t.patientUuid),2)),B=P[0],D=(P[1],A((0,i.useState)(t.name),2)),F=D[0],N=(D[1],A((0,i.useState)(t.patientAge),2)),Z=N[0],L=(N[1],A((0,i.useState)(t.patientDob),2)),z=(L[0],L[1],A((0,i.useState)(t.patientSex),2)),I=z[0],Q=(z[1],(0,o.W_)().priorities),M=(0,o.$z)(),O=M.statuses,j=M.isLoading,G=(0,w.kY)().mutate,V=A((0,i.useState)(""),2),Y=V[0],W=V[1],$=(0,a.useSession)(),H=(0,a.useLocations)(),R=(0,o.Su)(Y).services;(0,i.useEffect)((function(){b(E)}),[E]),(0,i.useEffect)((function(){var e;if(Y||null===(null==$?void 0:$.sessionLocation)){if(!Y&&H){var t;W(null===(t=(0,T.Z)(H))||void 0===t?void 0:t.uuid)}}else W(null==$||null===(e=$.sessionLocation)||void 0===e?void 0:e.uuid)}),[$,H,Y]);var K=(0,i.useCallback)((function(){var e;""===m&&y((e=Q,function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).shift().uuid),""===c&&O.find((function(e){return"waiting"===e.display.toLowerCase()})).uuid;var t=(0,a.toDateObjectStrict)((0,a.toOmrsIsoString)(new Date));(0,o.zI)(g,E,S,k,B,m,c,t,new AbortController).then((function(e){201===e.status&&((0,a.showToast)({critical:!0,title:l("updateEntry","Update entry"),kind:"success",description:l("queueEntryUpdateSuccessfully","Queue Entry Updated Successfully")}),n(),G("/ws/rest/v1/visit-queue-entry?v=full"))}),(function(e){(0,a.showNotification)({title:l("queueEntryUpdateFailed","Error updating queue entry status"),kind:"error",critical:!0,description:null==e?void 0:e.message})}))}),[m,c,g,E,S,k,B,Q,O,l,n,G]);return r().createElement("div",null,r().createElement(u.xBx,{closeModal:n,title:l("changePatientQueueStatus","Change patient queue status?")}),r().createElement(u.fef,null,r().createElement(u.l09,{onSubmit:K},r().createElement("div",{className:q.modalBody},r().createElement("h5",null,F,"   ·  ",I,"   ·  ",Z," ",l("years","Years"))),r().createElement("div",{className:q.sectionTitle},l("queueStatus","Queue status")),r().createElement(u.cwH,{legendText:""},r().createElement(u.SYO,{className:q.radioButtonGroup,valueSelected:c,orientation:"vertical",onChange:function(e){return p(e.toString())},name:"radio-button-group"},j?r().createElement(u.lSo,{role:"progressbar",description:l("loading","Loading...")}):0===(null==O?void 0:O.length)?r().createElement("p",null,l("noStatusAvailable","No Status Available")):O.map((function(e){var t=e.uuid,n=e.display,i=e.name;return r().createElement(u.EUY,{key:t,className:q.radioButton,id:i,labelText:n,value:t})})))),r().createElement("section",{className:q.section},r().createElement("div",{className:q.sectionTitle},l("queueService","Queue service")),r().createElement(u.PhF,{labelText:l("selectService","Select a service"),id:"service",invalidText:"Required",value:S,onChange:function(e){return b(e.target.value)}},S?null:r().createElement(u.QlF,{text:l("chooseService","Select a service"),value:""}),(null==R?void 0:R.length)>0&&R.map((function(e){return r().createElement(u.QlF,{key:e.uuid,text:e.display,value:e.uuid},e.display)})))),r().createElement("section",{className:q.section},r().createElement("div",{className:q.sectionTitle},l("queuePriority","Queue priority")),r().createElement(u.GHR,{size:"sm",selectedIndex:1,onChange:function(e){y(e.name)}},(null==Q?void 0:Q.length)>0?Q.map((function(e){var t=e.uuid,n=e.display;return r().createElement(u.rsf,{name:t,text:n,key:t,value:t})})):r().createElement(u.rsf,{name:l("noPriorityFound","No priority found"),text:l("noPriorityFound","No priority found"),value:null}))))),r().createElement(u.mzw,null,r().createElement(u.zxk,{kind:"secondary",onClick:n},l("cancel","Cancel")),r().createElement(u.zxk,{onClick:K},l("exitAndChangeStatus","Exit and change status"))))}},12:(e,t,n)=>{n.d(t,{Z:()=>i});const i=function(e){return e&&e.length?e[0]:void 0}}}]);