"use strict";(self.webpackChunk_openmrs_esm_outpatient_app=self.webpackChunk_openmrs_esm_outpatient_app||[]).push([[94],{8053:(e,t,n)=>{n.d(t,{$z:()=>m,Di:()=>D,KW:()=>g,P4:()=>h,Su:()=>y,W_:()=>f,zI:()=>E});var i=n(5047),u=n.n(i),r=n(8879),a=n.n(r),o=n(9857),s=n(2303),d=n(906),l=n(2228),p=n(7279);function v(e,t,n,i,u,r,a){try{var o=e[r](a),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(i,u)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(i,u){var r=e.apply(t,n);function a(e){v(r,i,u,a,o,"next",e)}function o(e){v(r,i,u,a,o,"throw",e)}a(void 0)}))}}function y(e){var t,n="/ws/rest/v1/queue?location=".concat(e),i=(0,s.Z)(n,d.openmrsFetch).data;return{services:i?null==i||null===(t=i.data)||void 0===t?void 0:t.results:[]}}function m(){var e,t=(0,d.useConfig)().concepts.statusConceptSetUuid,n="/ws/rest/v1/concept/".concat(t),i=(0,s.Z)(n,d.openmrsFetch),u=i.data,r=i.error;return{statuses:u?null==u||null===(e=u.data)||void 0===e?void 0:e.setMembers:[],isLoading:!u&&!r}}function f(){var e,t=(0,d.useConfig)().concepts.priorityConceptSetUuid,n="/ws/rest/v1/concept/".concat(t),i=(0,s.Z)(n,d.openmrsFetch).data;return{priorities:i?null==i||null===(e=i.data)||void 0===e?void 0:e.setMembers:[]}}function h(){var e,t,n=(0,o.ZP)("/ws/rest/v1/visit-queue-entry?v=full",d.openmrsFetch),i=n.data,u=n.error,r=n.isValidating,s=function(e){var t,n,i;return{diagnoses:e.diagnoses,encounterDatetime:e.encounterDatetime,encounterType:e.encounterType.display,obs:e.obs,provider:null===(t=e.encounterProviders[0])||void 0===t||null===(n=t.provider)||void 0===n||null===(i=n.person)||void 0===i?void 0:i.display,uuid:e.uuid,voided:e.voided}},l=null==i||null===(e=i.data)||void 0===e||null===(t=e.results)||void 0===t?void 0:t.map((function(e){var t,n,i,u,r,o,l,p,v,c,y;return{id:e.queueEntry.uuid,encounters:null===(t=e.visit)||void 0===t||null===(n=t.encounters)||void 0===n?void 0:n.map(s),name:e.queueEntry.display,patientUuid:e.queueEntry.patient.uuid,patientAge:null===(i=e.queueEntry.patient.person)||void 0===i?void 0:i.age,patientSex:"M"===(null===(u=e.queueEntry.patient.person)||void 0===u?void 0:u.gender)?"MALE":"FEMALE",patientDob:(null==e||null===(r=e.queueEntry)||void 0===r||null===(o=r.patient)||void 0===o||null===(l=o.person)||void 0===l?void 0:l.birthdate)?(0,d.formatDate)((0,d.parseDate)(e.queueEntry.patient.person.birthdate),{time:!1}):"--",priority:"Urgent"===e.queueEntry.priority.display?"Priority":e.queueEntry.priority.display,priorityComment:e.queueEntry.priorityComment,priorityUuid:e.queueEntry.priority.uuid,service:e.queueEntry.queue.service.display,status:e.queueEntry.status.display,statusUuid:e.queueEntry.status.uuid,waitTime:e.queueEntry.startedAt?"".concat(a()().diff(a()(e.queueEntry.startedAt),"minutes")):"--",visitStartDateTime:null===(p=e.visit)||void 0===p?void 0:p.visitStartDateTime,visitType:null===(v=e.visit)||void 0===v||null===(c=v.visitType)||void 0===c?void 0:c.display,visitUuid:null===(y=e.visit)||void 0===y?void 0:y.uuid,queueUuid:e.queueEntry.queue.uuid,queueEntryUuid:e.queueEntry.uuid}}));return{visitQueueEntries:l||null,isLoading:!i&&!u,isError:u,isValidating:r}}var g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split("/");return(0,l.Z)(t)};function E(e,t,n,i,u,r,a,o,s){return q.apply(this,arguments)}function q(){return(q=c(u().mark((function e(t,n,i,r,a,o,s,l,v){var c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=(0,p.Z)(i)?n:i,e.next=3,Promise.all([w(n,v,r,l)]);case 3:return e.abrupt("return",(0,d.openmrsFetch)("/ws/rest/v1/visit-queue-entry",{method:"POST",headers:{"Content-Type":"application/json"},signal:v.signal,body:{visit:{uuid:t},queueEntry:{status:{uuid:s},priority:{uuid:o},queue:{uuid:c},patient:{uuid:a},startedAt:(0,d.toDateObjectStrict)((0,d.toOmrsIsoString)(new Date))}}}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t,n,i){return b.apply(this,arguments)}function b(){return(b=c(u().mark((function e(t,n,i,r){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.openmrsFetch)("/ws/rest/v1/queue/".concat(t,"/entry/").concat(i),{method:"POST",headers:{"Content-Type":"application/json"},signal:n.signal,body:{endedAt:r}});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){var t,n,i="/ws/rest/v1/visit-queue-entry?status=waiting&service=".concat(e,"&v=full"),u=(0,o.ZP)(i,d.openmrsFetch),r=u.data,a=u.error,s=u.isValidating,l=null==r||null===(t=r.data)||void 0===t||null===(n=t.results)||void 0===n?void 0:n.map((function(e){var t,n,i,u,r,a,o,s,d,l;return{id:e.queueEntry.uuid,name:e.queueEntry.display,age:e.queueEntry.patient?null==e||null===(t=e.queueEntry)||void 0===t||null===(n=t.patient)||void 0===n||null===(i=n.person)||void 0===i?void 0:i.age:"--",returnDate:null===(u=e.visit)||void 0===u?void 0:u.visitStartDateTime,visitType:null===(r=e.visit)||void 0===r||null===(a=r.visitType)||void 0===a?void 0:a.display,phoneNumber:e.patient?null===(o=e.patient)||void 0===o?void 0:o.phoneNumber:"--",gender:e.queueEntry.patient?null==e||null===(s=e.queueEntry)||void 0===s||null===(d=s.patient)||void 0===d||null===(l=d.person)||void 0===l?void 0:l.gender:"--",patientUuid:e.queueEntry?null==e?void 0:e.queueEntry.uuid:"--"}}));return{serviceQueueEntries:l||null,isLoading:!r&&!a,isError:a,isValidating:s}}},8094:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var i=n(5206),u=n.n(i),r=n(4924),a=n(2650),o=n(906),s=n(8053);const d=function(){var e=(0,r.useTranslation)().t,t=window.location.pathname.split("/")[4],n=(0,s.Di)(t),d=n.serviceQueueEntries,l=n.isLoading,p=(0,i.useMemo)((function(){return[{id:0,header:e("name","Name"),key:"name"},{id:1,header:e("returnDate","Return Date"),key:"returnDate"},{id:2,header:e("gender","Gender"),key:"gender"},{id:3,header:e("age","Age"),key:"age"},{id:4,header:e("visitType","Visit Type"),key:"visitType"},{id:5,header:e("phoneNumber","Phone Number"),key:"phoneNumber"}]}),[e]),v=(0,i.useMemo)((function(){return null==d?void 0:d.map((function(e){return{id:e.id,name:{content:u().createElement(o.ConfigurableLink,{to:"${openmrsSpaBase}/patient/".concat(e.patientUuid,"/chart")},e.name)},returnDate:(0,o.formatDatetime)((0,o.parseDate)(e.returnDate),{mode:"wide"}),gender:e.gender,age:e.age,visitType:e.visitType,phoneNumber:e.phoneNumber}}))}),[d]);return u().createElement("div",null,u().createElement(a.Z,{title:e("alistOfClients","A list of clients waiting for "),headers:p,rows:v,patientData:d,serviceType:t,isLoading:l}))}}}]);