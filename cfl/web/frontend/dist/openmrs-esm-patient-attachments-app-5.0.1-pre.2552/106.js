"use strict";(globalThis.webpackChunk_openmrs_esm_patient_attachments_app=globalThis.webpackChunk_openmrs_esm_patient_attachments_app||[]).push([[106],{7627:(e,t,a)=>{a.d(t,{Z:()=>c});var n=a(272),i=a.n(n),r=a(2609),o=a.n(r)()(i());o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}:root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-attachments__camera-media-uploader__productiveHeading02___SF9v_{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0)}.-esm-patient-attachments__camera-media-uploader__productiveHeading03___kyc2j{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-patient-attachments__camera-media-uploader__bodyLong01___E3SSh{font-size:var(--cds-body-long-01-font-size, 0.875rem);font-weight:var(--cds-body-long-01-font-weight, 400);line-height:var(--cds-body-long-01-line-height, 1.42857);letter-spacing:var(--cds-body-long-01-letter-spacing, 0.16px)}.-esm-patient-attachments__camera-media-uploader__muted___DsrFK{color:#525252}.-esm-patient-attachments__camera-media-uploader__bodyShort01___Fgqqf{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-patient-attachments__camera-media-uploader__text02___zldA6{color:#525252}.-esm-patient-attachments__camera-media-uploader__cameraSection___O1_hE{width:inherit;background-color:#fff}.-esm-patient-attachments__camera-media-uploader__cameraSection___O1_hE .react-html5-camera-photo>img,.-esm-patient-attachments__camera-media-uploader__cameraSection___O1_hE .react-html5-camera-photo>video{max-width:100%;max-height:100%}.-esm-patient-attachments__camera-media-uploader__uploadFile___xPA_w{color:#fff}.-esm-patient-attachments__camera-media-uploader__uploadFile___xPA_w label{max-width:unset}.-esm-patient-attachments__camera-media-uploader__uploadFile___xPA_w label>div{height:25rem;justify-content:center;align-items:center}.-esm-patient-attachments__camera-media-uploader__modalBody___YH4FB{padding:0;margin:0}@media(max-width: 1023px){.-esm-patient-attachments__camera-media-uploader__frameContent___f9Y86{width:65%}}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/root.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss","webpack://./src/camera-media-uploader/camera-media-uploader.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CAHF,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,8ECs0BI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CDl0BJ,8ECk0BI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CD9zBJ,qEC8zBI,qDAAA,CAAA,oDAAA,CAAA,wDAAA,CAAA,6DAAA,CD1zBJ,gEACE,aDZQ,CCeV,sECszBI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CDlzBJ,iEACE,aDpBQ,CGDV,wEACE,aAAA,CACA,qBHLM,CGSN,8MACE,cAAA,CACA,eAAA,CAIJ,qEACE,UHhBM,CGkBN,2EACE,eAAA,CAGF,+EACE,YAAA,CACA,sBAAA,CACA,kBAAA,CAKJ,oEACE,SAAA,CACA,QAAA,CAGF,0BACE,uEACE,SAAA,CAAA",sourceRoot:""}]),o.locals={productiveHeading02:"-esm-patient-attachments__camera-media-uploader__productiveHeading02___SF9v_",productiveHeading03:"-esm-patient-attachments__camera-media-uploader__productiveHeading03___kyc2j",bodyLong01:"-esm-patient-attachments__camera-media-uploader__bodyLong01___E3SSh",muted:"-esm-patient-attachments__camera-media-uploader__muted___DsrFK",bodyShort01:"-esm-patient-attachments__camera-media-uploader__bodyShort01___Fgqqf",text02:"-esm-patient-attachments__camera-media-uploader__text02___zldA6",cameraSection:"-esm-patient-attachments__camera-media-uploader__cameraSection___O1_hE",uploadFile:"-esm-patient-attachments__camera-media-uploader__uploadFile___xPA_w",modalBody:"-esm-patient-attachments__camera-media-uploader__modalBody___YH4FB",frameContent:"-esm-patient-attachments__camera-media-uploader__frameContent___f9Y86"};const c=o},368:(e,t,a)=>{a.d(t,{Z:()=>c});var n=a(272),i=a.n(n),r=a(2609),o=a.n(r)()(i());o.push([e.id,':root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-attachments__file-review__productiveHeading02___vucWQ{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0)}.-esm-patient-attachments__file-review__productiveHeading03___nppG6{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-patient-attachments__file-review__bodyLong01___Jn8EJ{font-size:var(--cds-body-long-01-font-size, 0.875rem);font-weight:var(--cds-body-long-01-font-weight, 400);line-height:var(--cds-body-long-01-line-height, 1.42857);letter-spacing:var(--cds-body-long-01-letter-spacing, 0.16px)}.-esm-patient-attachments__file-review__muted___jgycZ{color:#525252}.-esm-patient-attachments__file-review__bodyShort01___tbQT7{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-patient-attachments__file-review__text02___zvcF2{color:#525252}.-esm-patient-attachments__file-review__filePreviewContainer___uBnMP{background-color:#fff}.-esm-patient-attachments__file-review__overview___BVR7S{display:grid;grid-template-columns:1fr 1fr}.-esm-patient-attachments__file-review__overview___BVR7S img{max-width:100%;max-height:20rem;display:block;align-self:center;justify-self:center}.-esm-patient-attachments__file-review__overview___BVR7S .-esm-patient-attachments__file-review__imageDetails___wd97h{margin-left:1rem}.-esm-patient-attachments__file-review__captionFrame___J0fPF{margin-bottom:.3rem}.-esm-patient-attachments__file-review__buttonSetOverrides___LxmlD{margin:1rem auto 0;display:grid;grid-template-columns:1fr 1fr}.-esm-patient-attachments__file-review__buttonSetOverrides___LxmlD>button{max-width:unset}.-esm-patient-attachments__file-review__filePlaceholder___URPz3{background-color:#c6c6c6;display:flex;justify-content:center;align-items:center;width:50%;margin:0 auto}.-esm-patient-attachments__file-review__filePlaceholder___URPz3::after{content:"";display:block;padding-bottom:100%}',"",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/root.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss","webpack://./src/camera-media-uploader/file-review.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,oECs0BI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CDl0BJ,oECk0BI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CD9zBJ,2DC8zBI,qDAAA,CAAA,oDAAA,CAAA,wDAAA,CAAA,6DAAA,CD1zBJ,sDACE,aDZQ,CCeV,4DCszBI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CDlzBJ,uDACE,aDpBQ,CGFV,qEACE,qBHHM,CGMR,yDACE,YAAA,CACA,6BAAA,CAED,6DACG,cAAA,CACA,gBAAA,CACA,aAAA,CACA,iBAAA,CACA,mBAAA,CAGF,sHACE,gBAAA,CAIJ,6DACE,mBAAA,CAGF,mEACE,kBAAA,CACA,YAAA,CACA,6BAAA,CAEA,0EACE,eAAA,CAIJ,gEACE,wBH/Bc,CGgCd,YAAA,CACA,sBAAA,CACA,kBAAA,CACA,SAAA,CACA,aAAA,CAGF,uEACE,UAAA,CACA,aAAA,CACA,mBAAA",sourceRoot:""}]),o.locals={productiveHeading02:"-esm-patient-attachments__file-review__productiveHeading02___vucWQ",productiveHeading03:"-esm-patient-attachments__file-review__productiveHeading03___nppG6",bodyLong01:"-esm-patient-attachments__file-review__bodyLong01___Jn8EJ",muted:"-esm-patient-attachments__file-review__muted___jgycZ",bodyShort01:"-esm-patient-attachments__file-review__bodyShort01___tbQT7",text02:"-esm-patient-attachments__file-review__text02___zvcF2",filePreviewContainer:"-esm-patient-attachments__file-review__filePreviewContainer___uBnMP",overview:"-esm-patient-attachments__file-review__overview___BVR7S",imageDetails:"-esm-patient-attachments__file-review__imageDetails___wd97h",captionFrame:"-esm-patient-attachments__file-review__captionFrame___J0fPF",buttonSetOverrides:"-esm-patient-attachments__file-review__buttonSetOverrides___LxmlD",filePlaceholder:"-esm-patient-attachments__file-review__filePlaceholder___URPz3"};const c=o},6627:(e,t,a)=>{a.d(t,{Z:()=>c});var n=a(272),i=a.n(n),r=a(2609),o=a.n(r)()(i());o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-attachments__media-uploader__productiveHeading02___LtNE8{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0)}.-esm-patient-attachments__media-uploader__productiveHeading03___bUvPn{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-patient-attachments__media-uploader__bodyLong01___ogOno{font-size:var(--cds-body-long-01-font-size, 0.875rem);font-weight:var(--cds-body-long-01-font-weight, 400);line-height:var(--cds-body-long-01-line-height, 1.42857);letter-spacing:var(--cds-body-long-01-letter-spacing, 0.16px)}.-esm-patient-attachments__media-uploader__muted___HrbR4{color:#525252}.-esm-patient-attachments__media-uploader__bodyShort01___qatTh{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-patient-attachments__media-uploader__text02___hkCGz{color:#525252}.-esm-patient-attachments__media-uploader__uploadFile___gNtZ7{color:#fff}.-esm-patient-attachments__media-uploader__uploadFile___gNtZ7 label{max-width:unset}.-esm-patient-attachments__media-uploader__uploadFile___gNtZ7 label>div{height:25rem;justify-content:center;align-items:center}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/root.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss","webpack://./src/camera-media-uploader/media-uploader.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,uECs0BI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CDl0BJ,uECk0BI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CD9zBJ,8DC8zBI,qDAAA,CAAA,oDAAA,CAAA,wDAAA,CAAA,6DAAA,CD1zBJ,yDACE,aDZQ,CCeV,+DCszBI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CDlzBJ,0DACE,aDpBQ,CGHV,8DACE,UHFM,CGIN,oEACE,eAAA,CAGF,wEACE,YAAA,CACA,sBAAA,CACA,kBAAA",sourceRoot:""}]),o.locals={productiveHeading02:"-esm-patient-attachments__media-uploader__productiveHeading02___LtNE8",productiveHeading03:"-esm-patient-attachments__media-uploader__productiveHeading03___bUvPn",bodyLong01:"-esm-patient-attachments__media-uploader__bodyLong01___ogOno",muted:"-esm-patient-attachments__media-uploader__muted___HrbR4",bodyShort01:"-esm-patient-attachments__media-uploader__bodyShort01___qatTh",text02:"-esm-patient-attachments__media-uploader__text02___hkCGz",uploadFile:"-esm-patient-attachments__media-uploader__uploadFile___gNtZ7"};const c=o},1561:(e,t,a)=>{a.d(t,{Z:()=>c});var n=a(272),i=a.n(n),r=a(2609),o=a.n(r)()(i());o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-attachments__uploading-status__productiveHeading02___zIKih{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0)}.-esm-patient-attachments__uploading-status__productiveHeading03___b4FLX{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-patient-attachments__uploading-status__bodyLong01___ONaKy{font-size:var(--cds-body-long-01-font-size, 0.875rem);font-weight:var(--cds-body-long-01-font-weight, 400);line-height:var(--cds-body-long-01-line-height, 1.42857);letter-spacing:var(--cds-body-long-01-letter-spacing, 0.16px)}.-esm-patient-attachments__uploading-status__muted___XJktn{color:#525252}.-esm-patient-attachments__uploading-status__bodyShort01___mZkNK{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-patient-attachments__uploading-status__text02___lShiU{color:#525252}.-esm-patient-attachments__uploading-status__cameraSection___wCLHG{width:inherit;background-color:#fff}.-esm-patient-attachments__uploading-status__uploadingFilesSection___qhjdo{display:flex;flex-direction:column;justify-content:center;align-items:center;height:25rem;overflow-y:auto;border:1px dashed #8d8d8d}.-esm-patient-attachments__uploading-status__buttonSet___o1fRh{width:100%;display:grid;grid-template-columns:1fr 1fr}.-esm-patient-attachments__uploading-status__buttonSet___o1fRh button{max-width:unset !important}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/root.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss","webpack://./src/camera-media-uploader/uploading-status.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,yECs0BI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CDl0BJ,yECk0BI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CD9zBJ,gEC8zBI,qDAAA,CAAA,oDAAA,CAAA,wDAAA,CAAA,6DAAA,CD1zBJ,2DACE,aDZQ,CCeV,iECszBI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CDlzBJ,4DACE,aDpBQ,CGFV,mEACE,aAAA,CACA,qBHJM,CGOR,2EACE,YAAA,CACA,qBAAA,CACA,sBAAA,CACA,kBAAA,CACA,YAAA,CACA,eAAA,CACA,yBAAA,CAGF,+DACE,UAAA,CACA,YAAA,CACA,6BAAA,CACA,sEACE,0BAAA",sourceRoot:""}]),o.locals={productiveHeading02:"-esm-patient-attachments__uploading-status__productiveHeading02___zIKih",productiveHeading03:"-esm-patient-attachments__uploading-status__productiveHeading03___b4FLX",bodyLong01:"-esm-patient-attachments__uploading-status__bodyLong01___ONaKy",muted:"-esm-patient-attachments__uploading-status__muted___XJktn",bodyShort01:"-esm-patient-attachments__uploading-status__bodyShort01___mZkNK",text02:"-esm-patient-attachments__uploading-status__text02___lShiU",cameraSection:"-esm-patient-attachments__uploading-status__cameraSection___wCLHG",uploadingFilesSection:"-esm-patient-attachments__uploading-status__uploadingFilesSection___qhjdo",buttonSet:"-esm-patient-attachments__uploading-status__buttonSet___o1fRh"};const c=o},2067:(e,t,a)=>{a.d(t,{OE:()=>d,Rs:()=>A,eK:()=>l,ky:()=>_});var n=a(7900),i=a(3255),r=a(2870);function o(e,t,a,n,i,r,o){try{var c=e[r](o),s=c.value}catch(e){return void a(e)}c.done?t(s):Promise.resolve(s).then(n,i)}function c(e){return function(){var t=this,a=arguments;return new Promise((function(n,i){var r=e.apply(t,a);function c(e){o(r,n,i,c,s,"next",e)}function s(e){o(r,n,i,c,s,"throw",e)}c(void 0)}))}}function s(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(r){return function(c){return function(r){if(a)throw new TypeError("Generator is already executing.");for(;o;)try{if(a=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],n=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,c])}}}var l="/ws/rest/v1/attachment";function A(e,t){var a=(0,i.ZP)("".concat(l,"?patient=").concat(e,"&includeEncounterless=").concat(t),r.openmrsFetch),o=a.data,c=a.error,s=a.mutate,A=a.isLoading,d=a.isValidating;return(0,n.useMemo)((function(){var e;return{isLoading:A,data:null!==(e=null==o?void 0:o.data.results)&&void 0!==e?e:[],error:c,mutate:s,isValidating:d}}),[o,c,A,d,s])}function d(e,t){return m.apply(this,arguments)}function m(){return(m=c((function(e,t){var a;return s(this,(function(n){return(a=new FormData).append("fileCaption",t.fileName),a.append("patient",e),t.file?a.append("file",t.file):(a.append("file",new File([""],t.fileName),t.fileName),a.append("base64Content",t.base64Content)),[2,(0,r.openmrsFetch)("".concat(l),{method:"POST",body:a})]}))}))).apply(this,arguments)}function _(e,t){return(0,r.openmrsFetch)("".concat(l,"/").concat(e),{method:"DELETE",signal:t.signal})}},1106:(e,t,a)=>{a.r(t),a.d(t,{default:()=>$});var n=a(7900),i=a.n(n),r=a(2870);const o=(0,n.createContext)({});var c=a(4924),s=a(1569),l=a.n(s);a(4445);const A=function(e){var t=e.mediaStream,a=e.stopCameraStream,r=(0,n.useContext)(o),c=r.handleTakePhoto,s=r.setError;(0,n.useEffect)((function(){return function(){a()}}),[a]);var A=(0,n.useCallback)((function(e){t.current=e}),[t]);return i().createElement(l(),{onTakePhoto:c,onCameraStart:A,onCameraStop:a,onCameraError:s})};var d=a(1354),m=a.n(d),_=a(1583),u=a.n(_),p=a(7378),f=a.n(p),h=a(5993),g=a.n(h),C=a(4154),v=a.n(C),b=a(8141),y=a.n(b),w=a(7627),E={};E.styleTagTransform=y(),E.setAttributes=g(),E.insert=f().bind(null,"head"),E.domAPI=u(),E.insertStyleElement=v(),m()(w.Z,E);const D=w.Z&&w.Z.locals?w.Z.locals:void 0;var S=a(8533),k=a(6627),B={};B.styleTagTransform=y(),B.setAttributes=g(),B.insert=f().bind(null,"head"),B.domAPI=u(),B.insertStyleElement=v(),m()(k.Z,B);const z=k.Z&&k.Z.locals?k.Z.locals:void 0;var x=a(7326);function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}const O=function(){var e=(0,n.useContext)(o),t=e.setFilesToUpload,a=e.allowedExtensions,s=e.multipleFiles,l=(0,c.useTranslation)().t,A=(0,r.useConfig)().fileSize,d=(0,n.useCallback)((function(e){e.forEach((function(e){e.size<=1024*A*1024?(0,x.Z)(e).then((function(a){t((function(t){return(n=t,function(e){if(Array.isArray(e))return F(e)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return F(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?F(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([{base64Content:a,file:e,fileName:e.name,fileType:"image"===e.type.split("/")[0]?"image":"pdf"===e.type.split("/")[1]?"pdf":"other",fileDescription:"",status:"uploading"}]);var n}))})):(0,r.showToast)({title:l("fileSizeLimitExceededText","File size limit exceeded"),description:"".concat(e.name," ").concat(l("fileSizeLimitExceeded","exceeds the file size of")," ").concat(A," MB"),kind:"error"})}))}),[t,A,l]);return i().createElement("div",{className:"cds--file__container"},i().createElement("p",{className:"cds--label-description"},l("fileUploadSizeConstrains","File limit is")," ",A,"MB"),i().createElement("div",{className:z.uploadFile},i().createElement(S.awp,{accept:null!=a?a:"*",labelText:l("fileSizeInstructions","Drag and drop files here or click to upload"),tabIndex:0,multiple:s,onAddFiles:function(e,t){var a=t.addedFiles;d(a)}})))};var P=a(368),T={};T.styleTagTransform=y(),T.setAttributes=g(),T.insert=f().bind(null,"head"),T.domAPI=u(),T.insertStyleElement=v(),m()(P.Z,T);const j=P.Z&&P.Z.locals?P.Z.locals:void 0;var I=a(2525);function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function N(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,r=[],o=!0,c=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(r.push(n.value),!t||r.length!==t);o=!0);}catch(e){c=!0,i=e}finally{try{o||null==a.return||a.return()}finally{if(c)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return H(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?H(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Z=function(e){var t=e.uploadedFile,a=e.collectDescription,o=e.onSaveFile,s=e.clearData,l=M((0,n.useState)(""),2),A=l[0],d=l[1],m=M((0,n.useState)(""),2),_=m[0],u=m[1],p=(0,c.useTranslation)().t,f=M((0,n.useState)(!1),2),h=f[0],g=f[1];(0,n.useEffect)((function(){d(t.fileName),u(t.fileDescription)}),[t]);var C=(0,n.useCallback)((function(e){var a,n;e.preventDefault(),null==o||o((a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){N(e,t,a[t])}))}return e}({},t),n=null!=(n={fileName:A,fileDescription:_})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):function(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a.push.apply(a,n)}return a}(Object(n)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(n,e))})),a))}),[o,A,_,t]),v=(0,n.useCallback)((function(e){e.preventDefault(),null==s||s()}),[s]),b=(0,n.useCallback)((function(e){e.preventDefault(),""===e.target.value?g(!0):h&&g(!1),d(e.target.value)}),[g,d,h]),y=(0,n.useCallback)((function(e){e.preventDefault(),u(e.target.value)}),[u]);return i().createElement("form",{onSubmit:C},i().createElement(S.fef,{className:j.overview},"image"===t.fileType?i().createElement("img",{src:t.base64Content,alt:"placeholder"}):"pdf"===t.fileType?i().createElement("div",{className:j.filePlaceholder},i().createElement(I.Lk,{size:16})):i().createElement("div",{className:j.filePlaceholder},i().createElement(I.Qf,{size:16})),i().createElement("div",{className:j.imageDetails},i().createElement("div",{className:j.captionFrame},i().createElement(S.oil,{id:"caption",labelText:"".concat("image"===t.fileType?p("image","Image"):p("file","File")," ").concat(p("name","name")),autoComplete:"off",placeholder:p("attachmentCaptionInstruction","Enter caption"),onChange:b,required:!0,value:A,invalid:h,autoFocus:!0,invalidText:h&&p("fieldRequired","This field is required")})),a&&i().createElement(S.Kx8,{id:"description",labelText:p("imageDescription","Image description"),autoComplete:"off",placeholder:p("attachmentCaptionInstruction","Enter caption"),value:_,onChange:y}))),i().createElement(S.mzw,null,i().createElement(r.UserHasAccess,{privilege:"Create Attachment"},i().createElement(S.zxk,{kind:"secondary",size:"lg",onClick:v},p("cancel","Cancel")),i().createElement(S.zxk,{type:"submit",size:"lg",onClick:C,disabled:h},p("addAttachment","Add attachment")))))};const L=function(e){var t=e.onCompletion,a=(0,n.useContext)(o),r=a.filesToUpload,s=a.clearData,l=a.setFilesToUpload,A=a.closeModal,d=a.collectDescription,m=(0,c.useTranslation)().t,_=M((0,n.useState)(1),2),u=_[0],p=_[1],f=(0,n.useCallback)((function(){u<r.length?p(u+1):t()}),[p,u,r,t]),h=(0,n.useCallback)((function(e){l((function(t){return t.map((function(t,a){return a===u-1?e:t}))})),f()}),[f,l,u]);return i().createElement("div",{className:j.filePreviewContainer},i().createElement(S.xBx,{closeModal:A,className:j.productiveHeading03},m("addAttachment_title","Add Attachment")," ",r.length>1&&"(".concat(u," of ").concat(r.length,")")),i().createElement(Z,{uploadedFile:r[u-1],clearData:s,onSaveFile:h,moveToNextFile:f,collectDescription:"image"===r[u-1].fileType&&d}))};var J=a(1561),U={};U.styleTagTransform=y(),U.setAttributes=g(),U.insert=f().bind(null,"head"),U.domAPI=u(),U.insertStyleElement=v(),m()(J.Z,U);const G=J.Z&&J.Z.locals?J.Z.locals:void 0;function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function q(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){q(e,t,a[t])}))}return e}function V(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a.push.apply(a,n)}return a}(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})),e}const K=function(){var e,t,a=(0,c.useTranslation)().t,s=(0,n.useContext)(o),l=s.filesToUpload,A=s.saveFile,d=s.closeModal,m=s.clearData,_=s.onCompletion,u=(e=(0,n.useState)([]),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,r=[],o=!0,c=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(r.push(n.value),!t||r.length!==t);o=!0);}catch(e){c=!0,i=e}finally{try{o||null==a.return||a.return()}finally{if(c)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return R(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?R(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=u[0],f=u[1];return(0,n.useEffect)((function(){l&&f(l.map((function(e){return V(Q({},e),{status:"uploading"})})))}),[l,f]),(0,n.useEffect)((function(){Promise.all(l.map((function(e,t){return A(e).then((function(){(0,r.showToast)({title:a("uploadComplete","Upload complete"),description:"".concat(e.fileName," ").concat(a("uploadedSuccessfully","uploaded successfully")),kind:"success"}),f((function(e){return e.map((function(e,a){return a===t?V(Q({},e),{status:"complete"}):e}))}))})).catch((function(t){(0,r.showToast)({title:"".concat(a("uploading","Uploading")," ").concat(e.fileName," ").concat(a("failed","failed")),description:t,kind:"error"})}))}))).then((function(){null==_||_()}))}),[_,A,l,a,f]),i().createElement("div",{className:G.cameraSection},i().createElement(S.xBx,{closeModal:d,className:G.productiveHeading03,title:a("addAttachment_title","Add Attachment")}),i().createElement(S.fef,null,i().createElement("p",{className:"cds--label-description"},a("uploadWillContinueInTheBackground","Files will be uploaded in the background. You can close this modal.")),i().createElement("div",{className:G.uploadingFilesSection},p.map((function(e,t){return i().createElement(S.Py3,{key:t,name:e.fileName,status:e.status,size:"lg"})})))),i().createElement(S.mzw,null,i().createElement(S.uVA,{className:G.buttonSet},i().createElement(S.zxk,{size:"lg",kind:"secondary",onClick:m},a("addMoreAttachments","Add more attachments")),i().createElement(S.zxk,{size:"lg",kind:"primary",onClick:d},a("closeModal","Close")))))};function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,r=[],o=!0,c=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(r.push(n.value),!t||r.length!==t);o=!0);}catch(e){c=!0,i=e}finally{try{o||null==a.return||a.return()}finally{if(c)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Y(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Y(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var X=function(){var e=(0,c.useTranslation)().t,t=W((0,n.useState)("upload"),2),a=t[0],r=t[1],s=(0,n.useContext)(o),l=s.cameraOnly,d=s.closeModal,m=(0,n.useRef)(),_=(0,n.useCallback)((function(){var e;null===(e=m.current)||void 0===e||e.getTracks().forEach((function(e){return e.stop()}))}),[m]);return(0,n.useEffect)((function(){return function(){_()}}),[_]),l?i().createElement(A,{mediaStream:m,stopCameraStream:_}):i().createElement("div",{className:D.cameraSection},i().createElement(S.xBx,{closeModal:d,title:e("addAttachment_title","Add Attachment")}),i().createElement(S.fef,{className:D.modalBody},i().createElement(S.mQc,{className:D.tabs},i().createElement(S.tdY,{"aria-label":"Attachments-upload-section"},i().createElement(S.OK9,{onClick:function(){return r("upload")}},e("uploadMedia","Upload media")),i().createElement(S.OK9,{onClick:function(){return r("camera")}},e("webcam","Webcam"))),i().createElement(S.nPR,null,i().createElement(S.x45,null,i().createElement(O,null)),i().createElement(S.x45,null,"camera"===a&&i().createElement(A,{mediaStream:m,stopCameraStream:_}))))))};const $=function(e){var t=e.cameraOnly,a=e.multipleFiles,s=e.collectDescription,l=e.saveFile,A=e.closeModal,d=e.onCompletion,m=e.allowedExtensions,_=W((0,n.useState)(void 0),2),u=_[0],p=_[1],f=W((0,n.useState)([]),2),h=f[0],g=f[1],C=W((0,n.useState)(!1),2),v=C[0],b=C[1],y=(0,c.useTranslation)().t;(0,n.useEffect)((function(){u&&(0,r.showToast)({description:u.message,kind:"error",title:y("cameraError","Camera Error")})}),[u,y]);var w=(0,n.useCallback)((function(e){g([{base64Content:e,fileName:"Image taken from camera",fileType:"image",fileDescription:"",status:"uploading"}])}),[]),E=(0,n.useCallback)((function(){g([]),b(!1),p(void 0)}),[g,b]),D=(0,n.useCallback)((function(){b(!0)}),[b]),S=(0,n.useMemo)((function(){return v?i().createElement(K,null):h.length?i().createElement(L,{onCompletion:D}):i().createElement(X,null)}),[v,h,D]);return i().createElement(o.Provider,{value:{multipleFiles:a,cameraOnly:t,collectDescription:s,saveFile:l,closeModal:A,onCompletion:d,filesToUpload:h,setFilesToUpload:g,uploadFilesToServer:v,setUploadFilesToServer:b,clearData:E,handleTakePhoto:w,error:u,setError:p,allowedExtensions:m}},S)}},7326:(e,t,a)=>{a.d(t,{H:()=>o,Z:()=>r});var n=a(2067),i=a(2870);function r(e){return new Promise((function(t){if(e){var a=new FileReader;a.addEventListener("load",(function(){"string"==typeof a.result?t(a.result):t("")})),a.addEventListener("error",(function(){t("")})),a.readAsDataURL(e)}else t("")}))}function o(e){return{id:e.uuid,src:"".concat(window.openmrsBase).concat(n.eK,"/").concat(e.uuid,"/bytes"),title:e.comment,description:"",dateTime:(0,i.formatDate)(new Date(e.dateTime),{mode:"wide"}),bytesMimeType:e.bytesMimeType,bytesContentFamily:e.bytesContentFamily}}}}]);