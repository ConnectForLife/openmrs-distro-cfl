"use strict";(self.webpackChunk_openmrs_esm_appointments_app=self.webpackChunk_openmrs_esm_appointments_app||[]).push([[497],{8442:(t,n,e)=>{e.d(n,{Z:()=>i});var r=e(2609),o=e.n(r)()((function(t){return t[1]}));o.push([t.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-appointments__index__checkInTime___jEYQi{display:flex;align-items:center}.-esm-appointments__index__checkInLabel___0-1jw{margin-right:.5rem;font-weight:bold}",""]),o.locals={checkInTime:"-esm-appointments__index__checkInTime___jEYQi",checkInLabel:"-esm-appointments__index__checkInLabel___0-1jw"};const i=o},8965:(t,n,e)=>{e.d(n,{es:()=>d.es,A8:()=>d.A8,g9:()=>u,Ey:()=>p,bf:()=>a,vN:()=>c,bP:()=>s,zF:()=>d.zF});var r=e(906);function o(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function i(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return o(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?o(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var a=function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=null==n?void 0:n.map((function(t){var n=t.countMap;return{serviceName:t.serviceName,count:n.reduce((function(t,n){return t+n.allAppointmentsCount}),0)}}));return e.find((function(n){return n.count===(t=Math).max.apply(t,i(e.map((function(t){return t.count}))))}))},u=function(t){return t.flatMap((function(t){return{serviceName:t.appointmentService.name,countMap:Object.entries(t.appointmentCountMap).flatMap((function(t){return t[1]}))}}))},c=function(t,n){return t.map((function(t){return Object.entries(t.appointmentCountMap).flatMap((function(t){return t[1][n]}))})).flat(1).reduce((function(t,n){return t+n}),0)};function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=n-t,r=Math.floor(e/6e4);return r+"min"}var s=function(t,n){var e,o,i,a,u,c,s,p,d,m,f,v,h,y,b;return{id:null==t?void 0:t.uuid,name:null===(e=t.patient)||void 0===e?void 0:e.name,age:null===(o=t.patient)||void 0===o?void 0:o.birthDate,gender:null===(i=t.patient)||void 0===i?void 0:i.gender,phoneNumber:null===(a=t.patient)||void 0===a?void 0:a.contact,dob:(0,r.formatDate)((0,r.parseDate)(null===(u=t.patient)||void 0===u?void 0:u.birthDate),{mode:"wide"}),patientUuid:null===(c=t.patient)||void 0===c?void 0:c.uuid,dateTime:(v=(0,r.parseDate)(t.startDateTime),h=v.getHours(),y=v.getMinutes(),b=h>=12?"PM":"AM",(h=(h%=12)||12)+":"+(y=y<10?"0"+y:y)+" "+b),serviceType:t.service?t.service.name:"--",serviceColor:(null===(s=t.service)||void 0===s?void 0:s.color)?t.service.color:"__",serviceUuid:t.service?t.service.uuid:null,appointmentKind:t.appointmentKind?t.appointmentKind:"--",status:t.status,provider:t.provider?null===(p=t.provider.person)||void 0===p?void 0:p.display:"--",location:t.location?t.location.name:"--",comments:t.comments?t.comments:"--",appointmentNumber:t.appointmentNumber,color:t.service.color,identifier:null===(d=t.patient)||void 0===d?void 0:d.identifier,duration:(null===(m=t.service)||void 0===m?void 0:m.durationMins)?(null==t||null===(f=t.service)||void 0===f?void 0:f.durationMins)+n("minutes","min"):l(t.startDateTime,t.endDateTime),recurring:t.recurring}},p=function(t){var n,e,o,i,a,u,c,l;return{id:t.uuid,name:null===(n=t.patient)||void 0===n?void 0:n.name,age:null===(e=t.patient)||void 0===e?void 0:e.birthDate,gender:null===(o=t.patient)||void 0===o?void 0:o.gender,phoneNumber:null===(i=t.patient)||void 0===i?void 0:i.contact,dob:(0,r.formatDate)((0,r.parseDate)(null===(a=t.patient)||void 0===a?void 0:a.birthDate),{mode:"wide"}),patientUuid:null===(u=t.patient)||void 0===u?void 0:u.uuid,dateTime:t.startDateTime,serviceType:t.service?t.service.name:"--",serviceUuid:t.service?t.service.uuid:null,appointmentKind:t.appointmentKind?t.appointmentKind:"--",status:t.status,provider:t.provider?null===(c=t.provider.person)||void 0===c?void 0:c.display:"--",location:t.location?null===(l=t.location)||void 0===l?void 0:l.name:"--",comments:t.comments?t.comments:"--",appointmentNumber:t.appointmentNumber}},d=e(4105)},4105:(t,n,e)=>{e.d(n,{A8:()=>s,es:()=>m,zF:()=>f});var r=e(906),o=e(8879),i=e.n(o),a=e(268),u=e(8179);function c(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function l(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(i.push(r.value),!n||i.length!==n);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw o}}return i}}(t,n)||function(t,n){if(t){if("string"==typeof t)return c(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?c(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=function(t,n){var e=l(null==t?void 0:t.split(":"),2),r=e[0],o=e[1];return"12"===r&&"AM"===n&&(r="00"),"PM"===n&&(r="12"===r?r:parseInt(r,10)+12),[r,o]},p={appointmentDate:i()((new Date).setHours(0,0,0,0)).format(u.J$)};function d(){return(0,r.getGlobalStore)("appointmentStartDate",p)}function m(t){d().setState({appointmentDate:i()(new Date(t).setHours(0,0,0,0)).format(u.J$)})}var f=function(){var t=l((0,a.useState)(p.appointmentDate),2),n=t[0],e=t[1];return(0,a.useEffect)((function(){d().subscribe((function(t){var n=t.appointmentDate;return e(n.toString())}))}),[]),n}},4690:(t,n,e)=>{e.d(n,{E0:()=>b,LW:()=>y,f6:()=>v});var r=e(5047),o=e.n(r),i=e(9857),a=e(8879),u=e.n(a),c=e(4924),l=e(906),s=e(268),p=e(8965),d=e(8179);function m(t,n,e,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?n(c):Promise.resolve(c).then(r,o)}function f(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function a(t){m(i,r,o,a,u,"next",t)}function u(t){m(i,r,o,a,u,"throw",t)}a(void 0)}))}}function v(){var t,n,e=(0,c.useTranslation)().t,r=(0,p.zF)(),o="/ws/rest/v1/appointment/all?forDate=".concat(r),a=(0,i.ZP)(o,l.openmrsFetch),u=a.data,d=a.error,m=a.isValidating,f=a.mutate,v=null!==(n=null==u||null===(t=u.data)||void 0===t?void 0:t.map((function(t){return(0,p.bP)(t,e)})))&&void 0!==n?n:[];return(0,s.useMemo)((function(){return{appointments:v,isLoading:!u&&!d,isError:d,isValidating:m,mutate:f}}),[u,d,m,f,v.length])}var h,y=(h=f(o().mark((function t(n,e,r){var i,a,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=Intl.DateTimeFormat().resolvedOptions().timeZone,a=u()(new Date).format(d.J$),c="/ws/rest/v1/appointments/".concat(e,"/status-change"),t.next=5,(0,l.openmrsFetch)(c,{body:{toStatus:n,onDate:a,timeZone:i},method:"POST",headers:{"Content-Type":"application/json"}});case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)}))),function(t,n,e){return h.apply(this,arguments)}),b=function(){var t=f(o().mark((function t(n,e){var r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="/ws/rest/v1/appointment/undoStatusChange/".concat(n),t.next=3,(0,l.openmrsFetch)(r,{method:"POST",headers:{"Content-Type":"application/json"}});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}()},7497:(t,n,e)=>{e.r(n),e.d(n,{default:()=>O});var r=e(5047),o=e.n(r),i=e(268),a=e.n(i),u=e(8879),c=e.n(u),l=e(3771),s=e(906),p=e(4924),d=e(4690),m=e(1163),f=e(2649),v=e(9857),h=e(6062),y=e.n(h),b=e(4036),w=e.n(b),g=e(6793),k=e.n(g),A=e(7892),S=e.n(A),C=e(1173),_=e.n(C),I=e(2464),E=e.n(I),M=e(8442),x={};x.styleTagTransform=E(),x.setAttributes=S(),x.insert=k().bind(null,"head"),x.domAPI=w(),x.insertStyleElement=_(),y()(M.Z,x);const T=M.Z&&M.Z.locals?M.Z.locals:void 0;function D(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function N(t,n,e,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?n(c):Promise.resolve(c).then(r,o)}function j(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(i.push(r.value),!n||i.length!==n);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw o}}return i}}(t,n)||function(t,n){if(t){if("string"==typeof t)return D(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?D(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const O=function(t){var n,e,r=t.closeCheckInModal,u=t.appointmentUuid,h=(0,p.useTranslation)().t,y=j((0,i.useState)(c()(new Date).format("hh:mm")),2),b=y[0],w=y[1],g=(0,v.kY)().mutate,k=j((0,i.useState)(!1),2),A=k[0],S=k[1],C=(n=o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new AbortController,S(!0),t.next=4,(0,d.LW)("CheckedIn",u,n);case 4:200===t.sent.status?(r(),(0,m.fu)({critical:!0,kind:"success",actionButtonLabel:"Undo",onActionButtonClick:function(){return(0,f.NL)(u,g)},subtitle:h("appointmentSuccessfullyCheckedIn","It has been checked-in successfully"),title:h("appointmentCheckedIn","Appointment Checked-in")}),g("/ws/rest/v1/appointment/appointment/all")):((0,s.showNotification)({title:h("appointmentCheckInError","Error checking in appointment"),kind:"error",critical:!0,description:h("errorMessage","Error checking in the appointment")}),S(!1));case 6:case"end":return t.stop()}}),t)})),e=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){N(i,r,o,a,u,"next",t)}function u(t){N(i,r,o,a,u,"throw",t)}a(void 0)}))},function(){return e.apply(this,arguments)});return a().createElement("div",null,a().createElement(l.xBx,{closeModal:r,title:h("checkInAppointment","Are you sure, you want to mark appointment as Checked-in?")}),a().createElement(l.fef,null,a().createElement("div",{className:T.checkInTime},a().createElement("span",{className:T.checkInLabel},h("checkinTime","Check-in time"),":"),a().createElement(l.jII,{required:!0,light:!0,className:T.timePickerInput,pattern:"([\\d]+:[\\d]{2})",onChange:function(t){return w(t.target.value)},value:b,id:"end-time-picker"}))),a().createElement(l.mzw,null,a().createElement(l.zxk,{kind:"secondary",onClick:r},h("no","No")),a().createElement(l.zxk,{onClick:C,disabled:A},h("yes","Yes"))))}},2649:(t,n,e)=>{e.d(n,{NL:()=>d,O4:()=>p,bO:()=>f,tf:()=>m});var r=e(5047),o=e.n(r),i=e(906),a=e(4690),u=e(1163);function c(t,n,e,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?n(c):Promise.resolve(c).then(r,o)}function l(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function a(t){c(i,r,o,a,u,"next",t)}function u(t){c(i,r,o,a,u,"throw",t)}a(void 0)}))}}var s,p=function(t){var n=(0,i.showModal)("check-in-appointment-modal",{closeCheckInModal:function(){return n()},appointmentUuid:t})},d=(s=l(o().mark((function t(n,e){var r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(0,u.hR)(),r=new AbortController,t.next=4,(0,a.E0)(n,r);case 4:200===t.sent.status?((0,u.bJ)(),e("/ws/rest/v1/appointment/appointment/all")):((0,u.bJ)(),(0,i.showNotification)({title:"Error Undoing",kind:"error",critical:!0,description:"Error reverting status"}));case 6:case"end":return t.stop()}}),t)}))),function(t,n){return s.apply(this,arguments)}),m=function(){var t=l(o().mark((function t(n,e,r,c,l,s,p){var m;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return m=new AbortController,t.next=3,(0,a.LW)(n,e,m);case 3:200===t.sent.status?((0,u.fu)({critical:!0,kind:"success",subtitle:r,title:l,actionButtonLabel:"Undo",onActionButtonClick:function(){return d(e,p)}}),p("/ws/rest/v1/appointment/appointment/all")):(0,i.showNotification)({title:s,kind:"error",critical:!0,description:c});case 5:case"end":return t.stop()}}),t)})));return function(n,e,r,o,i,a,u){return t.apply(this,arguments)}}(),f=function(t,n,e){var r=e("appointmentMarkedAsCompleted","It has been successfully marked as Completed"),o=e("appointmentCompleted","Appointment Completed"),i=e("appointmentCompleted","Appointment Completed"),a=e("appointmentCompletedError","Error marking appointment as Completed");return m("Completed",t,r,i,o,a,n)}},1163:(t,n,e)=>{e.d(n,{bJ:()=>s,ft:()=>p,fu:()=>c,hR:()=>l});var r=e(906),o=e(268);function i(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var a={showNotification:!1,notification:{}},u=function(){return(0,r.getGlobalStore)("home-appointment-store",a)},c=function(t){u().setState({showNotification:!0,notification:t})},l=function(){u().setState({showNotification:!0,notification:{kind:"success",title:"Undoing status...",critical:!0}})},s=function(){u().setState({notification:{},showNotification:!1})},p=function(){var t,n,e=(t=(0,o.useState)(),n=2,function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(i.push(r.value),!n||i.length!==n);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw o}}return i}}(t,n)||function(t,n){if(t){if("string"==typeof t)return i(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?i(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=e[0],a=e[1];return(0,o.useEffect)((function(){var t=function(t){a(t)};t(u().getState()),u().subscribe(t)}),[]),{showNotification:null==r?void 0:r.showNotification,notification:null==r?void 0:r.notification}}}}]);