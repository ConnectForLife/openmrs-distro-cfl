"use strict";(self.webpackChunk_openmrs_esm_appointments_app=self.webpackChunk_openmrs_esm_appointments_app||[]).push([[183],{6546:(t,e,n)=>{n.d(e,{Z:()=>i});var r=n(2609),a=n.n(r)()((function(t){return t[1]}));a.push([t.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-appointments__change-appointment-status__radioButtonGroup___Ag6W1{display:flex;flex-direction:column;align-items:flex-start;margin-top:.5rem;min-height:4rem;width:100%;font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-appointments__change-appointment-status__radioButton___4i256{padding:.25rem .25rem;margin:.5rem 0}section{margin:.5rem}.-esm-appointments__change-appointment-status__sectionTitle___JiL68{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);color:#525252;margin-bottom:.75rem}",""]),a.locals={radioButtonGroup:"-esm-appointments__change-appointment-status__radioButtonGroup___Ag6W1",radioButton:"-esm-appointments__change-appointment-status__radioButton___4i256",sectionTitle:"-esm-appointments__change-appointment-status__sectionTitle___JiL68"};const i=a},9696:(t,e,n)=>{n.d(e,{q:()=>u});var r=n(906),a=n(8879),i=n.n(a),o=n(8179),u=function(t,e,n){var a=Intl.DateTimeFormat().resolvedOptions().timeZone,u=i()(new Date).format(o.J$),l="/ws/rest/v1/appointments/".concat(e,"/status-change");return(0,r.openmrsFetch)(l,{body:{toStatus:t,onDate:u,timeZone:a},method:"POST",headers:{"Content-Type":"application/json"}})}},5183:(t,e,n)=>{n.r(e),n.d(e,{default:()=>M});var r=n(268),a=n.n(r),i=n(3771),o=n(4924),u=n(6062),l=n.n(u),c=n(4036),s=n.n(c),p=n(6793),m=n.n(p),d=n(7892),v=n.n(d),f=n(1173),h=n.n(f),g=n(2464),y=n.n(g),b=n(6546),_={};_.styleTagTransform=y(),_.setAttributes=v(),_.insert=m().bind(null,"head"),_.domAPI=s(),_.insertStyleElement=h(),l()(b.Z,_);const S=b.Z&&b.Z.locals?b.Z.locals:void 0;var A=n(9696),w=n(906),T=n(9857),C=n(8965);function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const M=function(t){var e,n,u=t.appointment,l=t.closeModal,c=(0,o.useTranslation)().t,s=(0,T.kY)().mutate,p=u.name,m=u.id,d=u.dateTime,v=u.serviceType,f=u.status,h=(e=(0,r.useState)(f),n=2,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i=[],o=!0,u=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);o=!0);}catch(t){u=!0,a=t}finally{try{o||null==n.return||n.return()}finally{if(u)throw a}}return i}}(e,n)||function(t,e){if(t){if("string"==typeof t)return D(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),g=h[0],y=h[1],b=(0,C.zF)(),_=[{display:c("checkIn","Check In"),value:"CheckedIn"},{display:c("missed","Missed"),value:"Missed"},{display:c("completed","Completed"),value:"Completed"}];return a().createElement("div",null,a().createElement(i.xBx,{closeModal:l,title:c("changeAppointmentStatus","Change appointment status")}),a().createElement(i.fef,null,a().createElement("div",{className:S.modalBody},a().createElement("h4",null,c("patientName","Patient name")," ",p),a().createElement("h5",null,c("serviceType","Service type")," ",v),a().createElement("h6",null,c("startTime","Start time")," ",d)),a().createElement(i.l09,{onSubmit:function(){}},a().createElement(i.cwH,{legendText:""},a().createElement(i.SYO,{className:S.radioButtonGroup,valueSelected:g,orientation:"vertical",onChange:function(t){return y(t)},name:"radio-button-group"},_.map((function(t){var e=t.value,n=t.display;return a().createElement(i.EUY,{key:e,className:S.radioButton,id:e,labelText:n,value:e})})))))),a().createElement(i.mzw,null,a().createElement(i.zxk,{kind:"secondary",onClick:l},c("cancel","Cancel")),a().createElement(i.zxk,{onClick:function(){var t=new AbortController;(0,A.q)(g,m,t).then((function(t){200===t.status&&((0,w.showToast)({critical:!0,kind:"success",description:c("appointmentStatusChange","Appointment status has been successfully changed to ".concat(g)),title:c("appointmentStatusTitleMessage","Appointment status")}),"CheckedIn"===g&&(0,w.navigate)({to:"${openmrsSpaBase}/outpatient"}),s("/ws/rest/v1/appointment/appointmentStatus?forDate=".concat(b,"&status=Scheduled")),l())})).catch((function(t){(0,w.showNotification)({title:c("appointmentFormError","Error updating appointment status"),kind:"error",critical:!0,description:null==t?void 0:t.message})}))}},c("exitAndChangeStatus","Change status"))))}},8965:(t,e,n)=>{n.d(e,{es:()=>m.es,A8:()=>m.A8,g9:()=>u,Ey:()=>p,bf:()=>o,vN:()=>l,bP:()=>s,zF:()=>m.zF});var r=n(906);function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var o=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=null==e?void 0:e.map((function(t){var e=t.countMap;return{serviceName:t.serviceName,count:e.reduce((function(t,e){return t+e.allAppointmentsCount}),0)}}));return n.find((function(e){return e.count===(t=Math).max.apply(t,i(n.map((function(t){return t.count}))))}))},u=function(t){return t.flatMap((function(t){return{serviceName:t.appointmentService.name,countMap:Object.entries(t.appointmentCountMap).flatMap((function(t){return t[1]}))}}))},l=function(t,e){return t.map((function(t){return Object.entries(t.appointmentCountMap).flatMap((function(t){return t[1][e]}))})).flat(1).reduce((function(t,e){return t+e}),0)};function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e-t,r=Math.floor(n/6e4);return r+"min"}var s=function(t,e){var n,a,i,o,u,l,s,p,m,d,v,f,h,g,y;return{id:null==t?void 0:t.uuid,name:null===(n=t.patient)||void 0===n?void 0:n.name,age:null===(a=t.patient)||void 0===a?void 0:a.birthDate,gender:null===(i=t.patient)||void 0===i?void 0:i.gender,phoneNumber:null===(o=t.patient)||void 0===o?void 0:o.contact,dob:(0,r.formatDate)((0,r.parseDate)(null===(u=t.patient)||void 0===u?void 0:u.birthDate),{mode:"wide"}),patientUuid:null===(l=t.patient)||void 0===l?void 0:l.uuid,dateTime:(f=(0,r.parseDate)(t.startDateTime),h=f.getHours(),g=f.getMinutes(),y=h>=12?"PM":"AM",(h=(h%=12)||12)+":"+(g=g<10?"0"+g:g)+" "+y),serviceType:t.service?t.service.name:"--",serviceColor:(null===(s=t.service)||void 0===s?void 0:s.color)?t.service.color:"__",serviceUuid:t.service?t.service.uuid:null,appointmentKind:t.appointmentKind?t.appointmentKind:"--",status:t.status,provider:t.provider?null===(p=t.provider.person)||void 0===p?void 0:p.display:"--",location:t.location?t.location.name:"--",comments:t.comments?t.comments:"--",appointmentNumber:t.appointmentNumber,color:t.service.color,identifier:null===(m=t.patient)||void 0===m?void 0:m.identifier,duration:(null===(d=t.service)||void 0===d?void 0:d.durationMins)?(null==t||null===(v=t.service)||void 0===v?void 0:v.durationMins)+e("minutes","min"):c(t.startDateTime,t.endDateTime),recurring:t.recurring}},p=function(t){var e,n,a,i,o,u,l,c;return{id:t.uuid,name:null===(e=t.patient)||void 0===e?void 0:e.name,age:null===(n=t.patient)||void 0===n?void 0:n.birthDate,gender:null===(a=t.patient)||void 0===a?void 0:a.gender,phoneNumber:null===(i=t.patient)||void 0===i?void 0:i.contact,dob:(0,r.formatDate)((0,r.parseDate)(null===(o=t.patient)||void 0===o?void 0:o.birthDate),{mode:"wide"}),patientUuid:null===(u=t.patient)||void 0===u?void 0:u.uuid,dateTime:t.startDateTime,serviceType:t.service?t.service.name:"--",serviceUuid:t.service?t.service.uuid:null,appointmentKind:t.appointmentKind?t.appointmentKind:"--",status:t.status,provider:t.provider?null===(l=t.provider.person)||void 0===l?void 0:l.display:"--",location:t.location?null===(c=t.location)||void 0===c?void 0:c.name:"--",comments:t.comments?t.comments:"--",appointmentNumber:t.appointmentNumber}},m=n(4105)},4105:(t,e,n)=>{n.d(e,{A8:()=>s,es:()=>d,zF:()=>v});var r=n(906),a=n(8879),i=n.n(a),o=n(268),u=n(8179);function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i=[],o=!0,u=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);o=!0);}catch(t){u=!0,a=t}finally{try{o||null==n.return||n.return()}finally{if(u)throw a}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=function(t,e){var n=c(null==t?void 0:t.split(":"),2),r=n[0],a=n[1];return"12"===r&&"AM"===e&&(r="00"),"PM"===e&&(r="12"===r?r:parseInt(r,10)+12),[r,a]},p={appointmentDate:i()((new Date).setHours(0,0,0,0)).format(u.J$)};function m(){return(0,r.getGlobalStore)("appointmentStartDate",p)}function d(t){m().setState({appointmentDate:i()(new Date(t).setHours(0,0,0,0)).format(u.J$)})}var v=function(){var t=c((0,o.useState)(p.appointmentDate),2),e=t[0],n=t[1];return(0,o.useEffect)((function(){m().subscribe((function(t){var e=t.appointmentDate;return n(e.toString())}))}),[]),e}}}]);