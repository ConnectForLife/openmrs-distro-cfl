"use strict";(self.webpackChunk_openmrs_esm_patient_test_results_app=self.webpackChunk_openmrs_esm_patient_test_results_app||[]).push([[894],{1827:(t,r,e)=>{e.d(r,{E6:()=>j,HZ:()=>O,Kk:()=>g,OA:()=>_,cF:()=>b,rS:()=>C,s4:()=>m,wA:()=>S});var n=e(5047),o=e.n(n);function a(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function u(t,r,e,n,o,a,u){try{var i=t[a](u),c=i.value}catch(t){return void e(t)}i.done?r(c):Promise.resolve(c).then(n,o)}function i(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var a=t.apply(r,e);function i(t){u(a,n,o,i,c,"next",t)}function c(t){u(a,n,o,i,c,"throw",t)}i(void 0)}))}}function c(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,a=[],u=!0,i=!1;try{for(e=e.call(t);!(u=(n=e.next()).done)&&(a.push(n.value),!r||a.length!==r);u=!0);}catch(t){i=!0,o=t}finally{try{u||null==e.return||e.return()}finally{if(i)throw o}}return a}}(t,r)||s(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,r){if(t){if("string"==typeof t)return a(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?a(t,r):void 0}}var f=o().mark(h),p=function(t,r){var e=t[Symbol.iterator]();return Array.from({length:r},(function(){return e.next().value}))},y={};function m(t,r,e){y[t]=[r,Date.now(),e];var n=Object.entries(y);n.length>5&&(n.sort((function(t,r){var e=c(t,2),n=c(e[1],2)[1],o=c(r,2);return c(o[1],2)[1]-n})),y=Object.fromEntries(n.slice(0,5)))}function v(t){return d.apply(this,arguments)}function d(){return(d=i(o().mark((function t(r){var e,n,a,u,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=h({patient:r,category:"laboratory",_sort:"-_date",_summary:"data",_format:"json",_count:"1"}),t.next=4,u.next().value;case 4:return i=t.sent,t.abrupt("return",null==i||null===(e=i.entry)||void 0===e||null===(n=e[0])||void 0===n||null===(a=n.resource)||void 0===a?void 0:a.id);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function b(t){var r=c(y[t]||[],1)[0];return[r,r?v(t).then((function(r){var e;return r!==(null==y||null===(e=y[t])||void 0===e?void 0:e[2])})):Promise.resolve(!0)]}function h(t){var r,e,n,a;return o().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:r="".concat(window.openmrsBase,"/ws/fhir2/R4/Observation"),e=r+"?"+Object.entries(t).map((function(t){var r=c(t,2);return r[0]+"="+r[1]})).join("&"),n=function(t){return e+"&_getpagesoffset="+300*t},a=0;case 4:return o.next=7,fetch(n(a++)).then((function(t){return t.json()}));case 7:o.next=4;break;case 9:case"end":return o.stop()}}),f)}var w,O=(w=i(o().mark((function t(r){var e,n,a,u;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=h({patient:r,category:"laboratory",_sort:"-_date",_summary:"data",_format:"json",_count:"300"}),t.next=3,Promise.all(p(e,1));case 3:if(n=t.sent,!((a=n[0].total)>300)){t.next=14;break}return u=Math.ceil(a/300)-1,t.t0=l(n),t.t1=l,t.next=11,Promise.all(p(e,u));case 11:t.t2=t.sent,t.t3=(0,t.t1)(t.t2),n=t.t0.concat.call(t.t0,t.t3);case 14:return t.abrupt("return",n.slice(0,Math.ceil(a/300)).flatMap((function(t){return t.entry.map((function(t){return t.resource}))})));case 15:case"end":return t.stop()}}),t)}))),function(t){return w.apply(this,arguments)}),g=function(t){return t.code.coding[0].code},A={};function j(t){return Promise.all(l(new Set(t.map(g))).map((function(t){return A[t]||(A[t]=fetch("".concat(window.openmrsBase,"/ws/rest/v1/concept/").concat(t,"?v=full")).then((function(t){return t.json()})))})))}function C(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var n=!0,o=!1,a=void 0;try{for(var u,i=r[Symbol.iterator]();!(n=(u=i.next()).done);n=!0){var c=u.value;if(null==c)return!1}}catch(t){o=!0,a=t}finally{try{n||null==i.return||i.return()}finally{if(o)throw a}}return!0}var S=function(t){return function(r){return C(t.hiAbsolute)&&r>t.hiAbsolute?"OFF_SCALE_HIGH":C(t.hiCritical)&&r>t.hiCritical?"CRITICALLY_HIGH":C(t.hiNormal)&&r>t.hiNormal?"HIGH":C(t.lowAbsolute)&&r<t.lowAbsolute?"OFF_SCALE_LOW":C(t.lowCritical)&&r<t.lowCritical?"CRITICALLY_LOW":C(t.lowNormal)&&r<t.lowNormal?"LOW":"NORMAL"}};function _(t){return Object.fromEntries(t.map((function(t){var r=t.uuid,e=t.hiAbsolute,n=t.hiCritical,o=t.hiNormal,a=t.lowAbsolute,u=t.lowCritical,i=t.lowNormal,c={hiAbsolute:e,hiCritical:n,hiNormal:o,lowAbsolute:a,lowCritical:u,lowNormal:i,units:t.units,datatype:t.datatype.display};return C(o,i)&&(c.range="".concat(i," â€“ ").concat(o)),c.assessValue=S(c),[r,c]})))}},9894:(t,r,e)=>{e.d(r,{Z:()=>O});var n=e(9902),o=e.n(n),a=e(5047),u=e.n(a),i=e(1827),c=e(0);function l(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function s(t,r,e,n,o,a,u){try{var i=t[a](u),c=i.value}catch(t){return void e(t)}i.done?r(c):Promise.resolve(c).then(n,o)}function f(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var a=t.apply(r,e);function u(t){s(a,n,o,u,i,"next",t)}function i(t){s(a,n,o,u,i,"throw",t)}u(void 0)}))}}function p(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function y(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{},n=Object.keys(e);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(e).filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})))),n.forEach((function(r){p(t,r,e[r])}))}return t}function m(t,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):function(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e.push.apply(e,n)}return e}(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})),t}function v(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,a=[],u=!0,i=!1;try{for(e=e.call(t);!(u=(n=e.next()).done)&&(a.push(n.value),!r||a.length!==r);u=!0);}catch(t){i=!0,o=t}finally{try{u||null==e.return||e.return()}finally{if(i)throw o}}return a}}(t,r)||function(t,r){if(t){if("string"==typeof t)return l(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?l(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,r,e){return function(n){n.conceptClass=(0,i.Kk)(n),n.hasMember?(n.members=new Array(n.hasMember.length),n.hasMember.forEach((function(t,e){r[t.reference.split("/")[1]]=[n.members,e]}))):n.meta=e[n.conceptClass],n.valueQuantity&&(n.value=n.valueQuantity.value,delete n.valueQuantity),n.valueCodeableConcept&&(n.value=null==n?void 0:n.valueCodeableConcept.coding[0].display,delete n.valueCodeableConcept),n.name=t[n.conceptClass]}}function b(){return(b=f(u().mark((function t(r){var e,n,o,a,l,s,f,p,b,h,w;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,i.HZ)(r);case 2:return e=t.sent,t.next=5,(0,i.E6)(e);case 5:return n=t.sent,o=n.filter((function(t){return"Test"===t.conceptClass.name||"LabSet"===t.conceptClass.name})),a=o.map((function(t){return t.uuid})),l=Object.fromEntries(o.map((function(t){return[t.uuid,t.display]}))),s=Object.fromEntries(a.map((function(t){return[t,[]]}))),f=(0,i.OA)(o),p=[],h=d(l,b={},f),e.forEach((function(t){a.includes((0,i.Kk)(t))&&(h(t),t.members?s[t.conceptClass].push(t):p.push(t))})),p.forEach((function(t){var r=t.id,e=b[r];e&&(e[0][e[1]]=t),s[t.conceptClass]&&s[t.conceptClass].push(t)})),Object.values(s).filter((function(t){return t.some((function(t){return t.members}))})).forEach((function(t){var r=t.flatMap((function(t){return t.members})),e=(0,c.Z)(r.map((function(t){return t.conceptClass}))),n=!0,o=!1,a=void 0;try{for(var u,i=function(e,n){var o=n.value,a=p.filter((function(t){return t.conceptClass===o&&!r.some((function(r){return r.id===t.id}))})),u=!0,i=!1,c=void 0;try{for(var l,s=a[Symbol.iterator]();!(u=(l=s.next()).done);u=!0){var f=l.value;t.push(m(y({},f),{members:[f]}))}}catch(t){i=!0,c=t}finally{try{u||null==s.return||s.return()}finally{if(i)throw c}}},l=e[Symbol.iterator]();!(n=(u=l.next()).done);n=!0)i(0,u)}catch(t){o=!0,a=t}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}})),w=Object.fromEntries(Object.entries(s).filter((function(t){return t[1].length})).map((function(t){var r=v(t,2),e=r[0],n=r[1],a=o.find((function(t){return t.uuid===e})),u=a.display,i=a.conceptClass.display;return[u,{entries:n.sort((function(t,r){return Date.parse(r.effectiveDateTime)-Date.parse(t.effectiveDateTime)})),type:i,uuid:e}]}))),e.length>0&&(0,i.s4)(r,w,e[0].id),t.abrupt("return",w);case 20:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function h(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function w(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,a=[],u=!0,i=!1;try{for(e=e.call(t);!(u=(n=e.next()).done)&&(a.push(n.value),!r||a.length!==r);u=!0);}catch(t){i=!0,o=t}finally{try{u||null==e.return||e.return()}finally{if(i)throw o}}return a}}(t,r)||function(t,r){if(t){if("string"==typeof t)return h(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?h(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const O=function(t){var r=w(o().useState({sortedObs:{},loaded:!1,error:void 0}),2),e=r[0],n=r[1];return o().useEffect((function(){var r=!1;if(t){var e=w(function(t){var r=v((0,i.cF)(t),2),e=r[0],n=r[1];return[e,n.then((function(r){return r?function(t){return b.apply(this,arguments)}(t):e}))]}(t),2),o=e[0],a=e[1];o&&n({sortedObs:o,loaded:!0,error:void 0}),a.then((function(t){t===o||r||n({sortedObs:t,loaded:!0,error:void 0})}))}return function(){r=!0}}),[t]),e}}}]);