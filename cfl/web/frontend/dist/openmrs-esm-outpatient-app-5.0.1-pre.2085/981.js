"use strict";(globalThis.webpackChunk_openmrs_esm_outpatient_app=globalThis.webpackChunk_openmrs_esm_outpatient_app||[]).push([[981],{6362:(e,t,i)=>{i.d(t,{Z:()=>u});var n=i(272),a=i.n(n),o=i(2609),l=i.n(o)()(a());l.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-outpatient__add-patient-toqueue-dialog__radioButtonGroup___qPnUZ{display:flex;flex-direction:column;align-items:flex-start;margin-top:.5rem;min-height:4rem;width:100%;font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-outpatient__add-patient-toqueue-dialog__radioButton___V6cji{padding:.25rem .25rem;margin:.5rem 0}section{margin:.5rem}.-esm-outpatient__add-patient-toqueue-dialog__sectionTitle___MAD5_{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);color:#525252;margin-bottom:.75rem}.-esm-outpatient__add-patient-toqueue-dialog__modalBody___uxg8z{padding-bottom:1rem}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/add-patient-toqueue/add-patient-toqueue-dialog.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,uEACE,YAAA,CACA,qBAAA,CACA,sBAAA,CACA,gBCaW,CDZX,eC+CW,CD9CX,UAAA,CEg0BE,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CF5zBJ,kEACE,qBAAA,CACA,cAAA,CAGF,QACE,YCCW,CDEb,mEEmzBI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CFjzBF,aDpBQ,CCqBR,oBAAA,CAGF,gEACE,mBCCW",sourceRoot:""}]),l.locals={radioButtonGroup:"-esm-outpatient__add-patient-toqueue-dialog__radioButtonGroup___qPnUZ",radioButton:"-esm-outpatient__add-patient-toqueue-dialog__radioButton___V6cji",sectionTitle:"-esm-outpatient__add-patient-toqueue-dialog__sectionTitle___MAD5_",modalBody:"-esm-outpatient__add-patient-toqueue-dialog__modalBody___uxg8z"};const u=l},1981:(e,t,i)=>{i.r(t),i.d(t,{default:()=>T});var n=i(5206),a=i.n(n),o=i(4924),l=i(2155),u=i(2870),r=i(8053),s=i(1354),d=i.n(s),c=i(1583),m=i.n(c),p=i(7378),v=i.n(p),A=i(5993),g=i.n(A),f=i(4154),_=i.n(f),y=i(8141),C=i.n(y),h=i(6362),E={};E.styleTagTransform=C(),E.setAttributes=g(),E.insert=v().bind(null,"head"),E.domAPI=m(),E.insertStyleElement=_(),d()(h.Z,E);const b=h.Z&&h.Z.locals?h.Z.locals:void 0;var S=i(4676),q=i(1995);function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,a,o=[],l=!0,u=!1;try{for(i=i.call(e);!(l=(n=i.next()).done)&&(o.push(n.value),!t||o.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{l||null==i.return||i.return()}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return B(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?B(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const T=function(e){var t=e.visitDetails,i=e.closeModal,s=(0,o.useTranslation)().t,d=null==t?void 0:t.visitUuid,c=D((0,n.useState)(""),2),m=c[0],p=c[1],v=null==t?void 0:t.patientUuid,A=null==t?void 0:t.name,g=null==t?void 0:t.age,f=null==t?void 0:t.gender,_=(0,r.W_)().priorities,y=(0,r.$z)(),C=(y.statuses,y.isLoading,D((0,n.useState)(""),2)),h=C[0],E=C[1],B=(0,r.Su)(h).services,T=(0,q.J)().queueLocations,w=D((0,n.useState)(!1),2),k=w[0],x=w[1],P=D((0,n.useState)(!1),2),Q=P[0],U=P[1],F=(0,u.useConfig)(),z=(0,r.P4)("",h).mutate,N=D((0,n.useState)(F.concepts.defaultPriorityConceptUuid),2),Z=N[0],Y=N[1],M=(0,S.g)().mutateQueueEntries,V=(0,n.useCallback)((function(){if(m)if(U(!1),Z){x(!1);var e=F.concepts.emergencyPriorityConceptUuid,t=Z===e?1:0,n=F.concepts.defaultStatusConceptUuid,a=F.concepts.visitQueueNumberAttributeUuid;(0,r.U8)(d,m,v,Z,n,t,h,a).then((function(e){201===e.status&&((0,u.showToast)({critical:!0,title:s("addEntry","Add entry"),kind:"success",description:s("queueEntryAddedSuccessfully","Queue Entry Added Successfully")}),i(),z(),M())}),(function(e){(0,u.showNotification)({title:s("queueEntryAddFailed","Error adding queue entry status"),kind:"error",critical:!0,description:null==e?void 0:e.message})}))}else x(!0);else U(!0)}),[m,Z,F.concepts.emergencyPriorityConceptUuid,F.concepts.defaultStatusConceptUuid,F.concepts.visitQueueNumberAttributeUuid,d,v,h,s,i,z]);return a().createElement("div",null,a().createElement(l.xBx,{closeModal:i,title:s("addVisitToQueue","Add Visit To Queue?")}),a().createElement(l.fef,null,a().createElement(l.l09,{onSubmit:V},a().createElement("div",{className:b.modalBody},a().createElement("h5",null,A,"   ·  ",f,"   ·  ",g," ",s("years","Years"))),a().createElement("section",null,a().createElement(l.PhF,{labelText:s("selectQueueLocation","Select a queue location"),id:"location",invalidText:"Required",value:h,onChange:function(e){return E(e.target.value)}},h?null:a().createElement(l.QlF,{text:s("selectQueueLocation","Select a queue location"),value:""}),(null==T?void 0:T.length)>0&&T.map((function(e){return a().createElement(l.QlF,{key:e.id,text:e.name,value:e.id},e.name)})))),a().createElement("section",{className:b.section},a().createElement("div",{className:b.sectionTitle},s("queueService","Queue service")),a().createElement(l.PhF,{labelText:s("selectService","Select a service"),id:"service",invalidText:"Required",value:m,onChange:function(e){return p(e.target.value)}},m?null:a().createElement(l.QlF,{text:s("chooseService","Select a service"),value:""}),(null==B?void 0:B.length)>0&&B.map((function(e){return a().createElement(l.QlF,{key:e.uuid,text:e.display,value:e.uuid},e.display)})))),Q&&a().createElement("section",null,a().createElement(l.K0D,{style:{margin:"0",minWidth:"100%"},kind:"error",lowContrast:!0,title:s("missingService","Please select a service")})),a().createElement("section",{className:b.section},a().createElement("div",{className:b.sectionTitle},s("queueStatus","Queue status")),(null==_?void 0:_.length)?a().createElement(l.SYO,{className:b.radioButtonWrapper,name:"priority",defaultSelected:Z,onChange:function(e){Y(e)}},(null==_?void 0:_.length)>0&&_.map((function(e){var t=e.uuid,i=e.display;return a().createElement(l.EUY,{key:t,labelText:i,value:t})}))):a().createElement(l.K0D,{className:b.inlineNotification,kind:"error",lowContrast:!0,subtitle:s("configurePriorities","Please configure priorities to continue."),title:s("noPriorityFound","No priority found")})),k&&a().createElement("section",null,a().createElement(l.K0D,{style:{margin:"0",minWidth:"100%"},kind:"error",lowContrast:!0,title:s("missingPriority","Please select a priority")})))),a().createElement(l.mzw,null,a().createElement(l.zxk,{kind:"secondary",onClick:i},s("cancel","Cancel")),a().createElement(l.zxk,{onClick:V},s("save","Save"))))}},4676:(e,t,i)=>{i.d(t,{g:()=>s});var n=i(3255),a=i(8879),o=i.n(a),l=i(6824),u=i.n(l),r=i(2870);function s(){var e,t,i,a,l=(0,r.useSession)(),u=o()().format("YYYY-MM-DD"),s=null==l||null===(e=l.sessionLocation)||void 0===e?void 0:e.uuid,d="/ws/rest/v1/visit?includeInactive=false&v=".concat("custom:(uuid,patient:(uuid,identifiers:(identifier,uuid),person:(age,display,gender,uuid)),visitType:(uuid,name,display),location:(uuid,name,display),startDatetime,stopDatetime)&fromStartDate="+u+"&location="+s),c=(0,n.ZP)(s?d:null,r.openmrsFetch),m=c.data,p=c.error,v=c.isValidating,A=(0,n.ZP)("/ws/rest/v1/visit-queue-entry",r.openmrsFetch),g=A.data,f=A.error,_=(A.isValidating,A.mutate),y={};null==g||null===(t=g.data)||void 0===t||t.results.forEach((function(e){var t,i;(null===(t=null==e?void 0:e.queueEntry.patient)||void 0===t?void 0:t.uuid)&&(y[null===(i=null==e?void 0:e.queueEntry.patient)||void 0===i?void 0:i.uuid]=!0)}));var C=null==m||null===(i=m.data)||void 0===i||null===(a=i.results)||void 0===a?void 0:a.filter((function(e){var t;return!y[null==e||null===(t=e.patient)||void 0===t?void 0:t.uuid]})),h=(null==C?void 0:C.length)?C.map((function(e){var t,i,n,a,o,l,u,r,s,d,c;return{age:null==e||null===(t=e.patient)||void 0===t||null===(i=t.person)||void 0===i?void 0:i.age,id:e.uuid,idNumber:null===(a=null==e||null===(n=e.patient)||void 0===n?void 0:n.identifiers[0])||void 0===a?void 0:a.identifier,gender:null==e||null===(o=e.patient)||void 0===o||null===(l=o.person)||void 0===l?void 0:l.gender,location:null==e||null===(u=e.location)||void 0===u?void 0:u.uuid,name:null==e||null===(r=e.patient)||void 0===r||null===(s=r.person)||void 0===s?void 0:s.display,patientUuid:null==e||null===(d=e.patient)||void 0===d?void 0:d.uuid,visitStartTime:null==e?void 0:e.startDatetime,visitType:null==e||null===(c=e.visitType)||void 0===c?void 0:c.display,visitUuid:e.uuid}})).filter((function(e){var t=e.visitStartTime;return o()(t).isToday()})):[];return{activeVisits:h,isLoading:!C&&!p&&!f,isError:!p&&!f,visitsIsValidating:v,mutateQueueEntries:_}}o().extend(u())}}]);