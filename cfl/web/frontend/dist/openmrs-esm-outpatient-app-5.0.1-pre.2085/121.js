"use strict";(globalThis.webpackChunk_openmrs_esm_outpatient_app=globalThis.webpackChunk_openmrs_esm_outpatient_app||[]).push([[121],{8179:(e,t,n)=>{n.d(t,{EQ:()=>l,J$:()=>i,JB:()=>o,b7:()=>u});var r=n(8879),a=n.n(r),o=(window.getOpenmrsSpaBase,"".concat(window.spaBase,"/home")),i="YYYY-MM-DDTHH:mm:ss.SSSZZ",u=a()((new Date).setUTCHours(0,0,0,0)).format(i),l=Intl.DateTimeFormat().resolvedOptions().timeZone},3670:(e,t,n)=>{n.d(t,{By:()=>C,Cb:()=>k,Hp:()=>Z,SY:()=>D,T4:()=>w,_j:()=>T,fn:()=>A,u_:()=>E,vM:()=>P,wE:()=>L,wJ:()=>I,yk:()=>S,yl:()=>N});var r=n(5206),a=n(2870);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var u={serviceName:localStorage.getItem("queueServiceName")},l={serviceUuid:localStorage.getItem("queueServiceUuid")},s={status:""},c={queueLocationName:localStorage.getItem("queueLocationName")},m={queueLocationUuid:localStorage.getItem("queueLocationUuid")},d={providerQueueRoomTimestamp:new Date},f={isPermanentProviderQueueRoom:localStorage.getItem("isPermanentProviderQueueRoom")};function p(){return(0,a.getGlobalStore)("queueSelectedServiceName",u)}function v(){return(0,a.getGlobalStore)("queueSelectedServiceUuid",l)}function h(){return(0,a.getGlobalStore)("appointmentSelectedStatus",s)}function g(){return(0,a.getGlobalStore)("queueLocationNameSelected",c)}function b(){return(0,a.getGlobalStore)("queueLocationUuidSelected",m)}function y(){return(0,a.getGlobalStore)("isPermanentProviderQueueRoom",f)}var S=function(e){p().setState({serviceName:e})},E=function(e){v().setState({serviceUuid:e})},w=function(e){h().setState({status:e})},N=function(e){g().setState({queueLocationName:e})},T=function(e){b().setState({queueLocationUuid:e})},C=function(e){(0,a.getGlobalStore)("queueProviderRoomTimestamp",d).setState({providerQueueRoomTimestamp:e})},L=function(e){y().setState({isPermanentProviderQueueRoom:e})},A=function(){var e,t=i((0,r.useState)(null!==(e=u.serviceName)&&void 0!==e?e:""),2),n=t[0],a=t[1];return(0,r.useEffect)((function(){p().subscribe((function(e){var t=e.serviceName;return a(t)}))}),[]),n},P=function(){var e=i((0,r.useState)(l.serviceUuid),2),t=e[0],n=e[1];return(0,r.useEffect)((function(){v().subscribe((function(e){var t=e.serviceUuid;return n(t)}))}),[]),t},k=function(){var e=i((0,r.useState)(s.status),2),t=e[0],n=e[1];return(0,r.useEffect)((function(){h().subscribe((function(e){var t=e.status;return n(t)}))}),[]),t},I=function(){var e=i((0,r.useState)(c.queueLocationName),2),t=e[0],n=e[1];return(0,r.useEffect)((function(){g().subscribe((function(e){var t=e.queueLocationName;return n(t)}))}),[]),t},D=function(){var e=i((0,r.useState)(m.queueLocationUuid),2),t=e[0],n=e[1];return(0,r.useEffect)((function(){b().subscribe((function(e){var t=e.queueLocationUuid;return n(t)}))}),[]),t},Z=function(){var e=i((0,r.useState)(f.isPermanentProviderQueueRoom),2),t=e[0],n=e[1];return(0,r.useEffect)((function(){y().subscribe((function(e){var t=e.isPermanentProviderQueueRoom;return n(t)}))}),[]),t}},3069:(e,t,n)=>{n.d(t,{Wi:()=>s,zt:()=>l});var r=n(3255),a=n(2870),o=n(8179),i=n(8879),u=n.n(i);function l(){var e="/ws/rest/v1/appointment/all?forDate=".concat(o.b7),t=(0,r.ZP)(e,a.openmrsFetch),n=t.data,i=t.error,u=t.isLoading,l=t.isValidating;return{appointmentQueueEntries:n?null==n?void 0:n.data:[],isLoading:u,isError:i,isValidating:l}}function s(e,t){var n,o,i,l=new AbortController,s="/ws/rest/v1/appointments/search",c=(0,r.ZP)(s,(function(){return(0,a.openmrsFetch)(s,{method:"POST",signal:l.signal,headers:{"Content-Type":"application/json"},body:{patientUuid:e,startDate:t}})})),m=c.data,d=c.error,f=c.isLoading,p=c.isValidating,v=(null==m||null===(n=m.data)||void 0===n?void 0:n.length)?m.data:[],h=null===(i=null===(o=null==v?void 0:v.sort((function(e,t){return e.startDateTime>t.startDateTime?1:-1})))||void 0===o?void 0:o.filter((function(e){return"Cancelled"!==e.status})))||void 0===i?void 0:i.filter((function(e){var t=e.startDateTime;return u()(new Date(t).toISOString()).isAfter(new Date)}));return{upcomingAppointment:h?null==h?void 0:h[0]:null,isError:d,isLoading:f,isValidating:p}}},1121:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var r=n(5206),a=n.n(r),o=n(4924),i=n(2155),u=n(8043),l=n(7631),s=n(2870),c=n(8407),m=n(9744),d=n(3670),f=n(3069),p=n(5326);function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(){return h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}const S=function(){var e=(0,o.useTranslation)().t,t=g((0,r.useState)(!1),2),n=t[0],v=t[1],y=(0,s.useConfig)().appointmentStatuses,S=(0,d.Cb)(),E=(0,f.zt)(),w=E.appointmentQueueEntries,N=E.isLoading,T=g((0,r.useState)(w),2),C=T[0],L=T[1],A=(0,s.usePagination)(null!=C?C:[],20),P=A.results,k=A.currentPage,I=A.goTo;(0,r.useEffect)((function(){S!=e("all","All")&&""!==S?L(null==w?void 0:w.filter((function(e){return e.status===S}))):L(w)}),[e,S,P,w]);var D,Z=(0,r.useMemo)((function(){return[{id:0,header:e("name","Name"),key:"name"},{id:1,header:e("returnDate","Return Date"),key:"returnDate"},{id:2,header:e("gender","Gender"),key:"gender"},{id:3,header:e("age","Age"),key:"age"},{id:4,header:e("visitType","Visit Type"),key:"visitType"},{id:5,header:e("status","Status"),key:"status"},{id:6,header:e("phoneNumber","Phone Number"),key:"phoneNumber"}]}),[e]),q=(0,r.useMemo)((function(){return null==P?void 0:P.map((function(t){var n,r;return{id:t.uuid,name:{content:a().createElement(s.ConfigurableLink,{to:"${openmrsSpaBase}/patient/".concat(t.patient.uuid,"/chart")},t.patient.name)},returnDate:(0,s.formatDate)(new Date(t.startDateTime),{mode:"wide"}),gender:(0,p.IF)(null===(n=t.patient)||void 0===n?void 0:n.gender,e),age:t.patient.age,visitType:t.appointmentKind,status:t.status,phoneNumber:null===(r=t.patient)||void 0===r?void 0:r.phoneNumber}}))}),[P,e]),U=function(e){var t=e.selectedItem;(0,d.T4)(t)},j=(0,r.useMemo)((function(){var e=Math.ceil((null==w?void 0:w.length)/100);return b(Array(e).keys()).map((function(e){return 100*(e+1)}))}),[w]);return N?a().createElement(i.gqd,{role:"progressbar"}):a().createElement("div",{className:c.Z.container},a().createElement(s.ExtensionSlot,{name:"breadcrumbs-slot"}),a().createElement("div",{className:c.Z.headerContainer},a().createElement("div",null,a().createElement("p",{className:c.Z.title},e("scheduledAppointmentsList","Scheduled appointments patient list")),a().createElement("p",{className:c.Z.subTitle},null==w?void 0:w.length," Â· Last Updated: ",(0,s.formatDatetime)(new Date,{mode:"standard"}))),a().createElement(i.zxk,{kind:"ghost",size:"sm",renderIcon:function(e){return a().createElement(u.r4,h({size:16},e))}},e("actions","Actions"))),a().createElement(i.mh4,null,a().createElement(i.n9L,{className:c.Z.filterTile},a().createElement(i.Vp9,{size:"md",title:"Clear Filter",type:"blue"},e("today","Today")),a().createElement("div",{className:c.Z.actionsBtn},a().createElement(i.zxk,{kind:"ghost",renderIcon:function(e){return a().createElement(l.wn,h({size:16},e))},iconDescription:e("filter","Filter (1)"),onClick:function(){return v(!0)},size:"sm"},e("filter","Filter (1)"))))),a().createElement(i.wQF,{"data-floating-menu-container":!0,filterRows:function(e){var t=e.rowIds,n=e.headers,r=e.cellsById,a=e.inputValue,o=e.getCellId;return t.filter((function(e){return n.some((function(t){var n=t.key,i=o(e,n),u=r[i].value,l=a.toLowerCase();return"boolean"!=typeof u&&(u.hasOwnProperty("content")?Array.isArray(u.content.props.children)?(""+u.content.props.children[1].props.children).toLowerCase().includes(l):"object"==typeof u.content.props.children?(""+u.content.props.children.props.children.props.children).toLowerCase().includes(l):(""+u.content.props.children).toLowerCase().includes(l):(""+u).toLowerCase().includes(l))}))}))},headers:Z,overflowMenuOnHover:!1,rows:q,size:"md",useZebraStyles:!0},(function(t){var n=t.rows,r=t.headers,o=t.getHeaderProps,u=t.getTableProps,l=t.getRowProps,s=t.onInputChange;return a().createElement(i.xJi,{className:c.Z.tableContainer},a().createElement(i.fjU,{style:{position:"static",height:"3rem",overflow:"visible",backgroundColor:"color"}},a().createElement(i.Vj0,{className:c.Z.toolbarContent},a().createElement("div",{className:c.Z.filterContainer},a().createElement(i.Ltx,{id:"serviceFilter",initialSelectedItem:"All",label:S,titleText:e("status","Status")+":",type:"inline",items:["All"].concat(b(y)),onChange:U,size:"sm"})),a().createElement(i.Ys1,{className:c.Z.search,expanded:!0,onChange:s,placeholder:e("searchThisList","Search this list"),size:"sm"}))),a().createElement(i.iA_,h({},u(),{className:c.Z.queueTable}),a().createElement(i.ssF,null,a().createElement(i.SCH,null,r.map((function(e){return a().createElement(i.xDH,h({},o({header:e})),e.header)})))),a().createElement(i.RMI,null,n.map((function(e,t){var n;return a().createElement(a().Fragment,{key:e.id},a().createElement(i.SCH,h({},l({row:e})),e.cells.map((function(e){var t;return a().createElement(i.pj1,{key:e.id},null!==(n=null===(t=e.value)||void 0===t?void 0:t.content)&&void 0!==n?n:e.value)}))))})))),0===n.length?a().createElement("div",{className:c.Z.tileContainer},a().createElement(i.mh4,null,a().createElement(i.n9L,{className:c.Z.tile},a().createElement("div",{className:c.Z.tileContent},a().createElement("p",{className:c.Z.content},e("noPatientsToDisplay","No patients to display")),a().createElement("p",{className:c.Z.helper},e("checkFilters","Check the filters above")))))):null)})),a().createElement(i.tlE,{backwardText:"Previous page",forwardText:"Next page",page:k,pageNumberText:"Page Number",pageSize:100,onChange:function(e){var t=e.page;return I(t)},pageSizes:(null==j?void 0:j.length)>0?j:[100],totalItems:null!==(D=null==w?void 0:w.length)&&void 0!==D?D:0}),n&&a().createElement(m.Z,{closePanel:function(){return v(!1)}}))}}}]);