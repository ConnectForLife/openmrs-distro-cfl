"use strict";(globalThis.webpackChunk_openmrs_esm_outpatient_app=globalThis.webpackChunk_openmrs_esm_outpatient_app||[]).push([[616],{3223:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(272),r=o.n(n),a=o(2609),u=o.n(a)()(r());u.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}section{margin:.5rem}.-esm-outpatient__add-provider-queue-room__sectionTitle___ArcWQ{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);color:#525252;margin-bottom:.75rem}.-esm-outpatient__add-provider-queue-room__checkbox___VEBx1{padding-top:.75rem}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/add-provider-queue-room/add-provider-queue-room.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,QACE,YCgBW,CDbb,gEEk0BI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CFh0BF,aDLQ,CCMR,oBCeW,CDZb,4DACE,kBCWW",sourceRoot:""}]),u.locals={sectionTitle:"-esm-outpatient__add-provider-queue-room__sectionTitle___ArcWQ",checkbox:"-esm-outpatient__add-provider-queue-room__checkbox___VEBx1"};const i=u},6616:(e,t,o)=>{o.r(t),o.d(t,{default:()=>T});var n=o(5206),r=o.n(n),a=o(4924),u=o(2155),i=o(2870),c=o(8053),l=o(1995),s=o(9672),d=o(3670),m=o(1354),v=o.n(m),f=o(1583),p=o.n(f),g=o(7378),S=o.n(g),b=o(5993),h=o.n(b),y=o(4154),A=o.n(y),q=o(8141),_=o.n(q),E=o(3223),C={};C.styleTagTransform=_(),C.setAttributes=h(),C.insert=S().bind(null,"head"),C.domAPI=p(),C.insertStyleElement=A(),v()(E.Z,C);const w=E.Z&&E.Z.locals?E.Z.locals:void 0;function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,a=[],u=!0,i=!1;try{for(o=o.call(e);!(u=(n=o.next()).done)&&(a.push(n.value),!t||a.length!==t);u=!0);}catch(e){i=!0,r=e}finally{try{u||null==o.return||o.return()}finally{if(i)throw r}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return R(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(o):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?R(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const T=function(e){var t=e.providerUuid,o=e.closeModal,m=(0,a.useTranslation)().t,v=(0,d.fn)(),f=(0,d.SY)(),p=(0,d.vM)(),g=(0,d.fn)(),S=(0,d.Hp)(),b=(0,s.ej)(t),h=b.providerRoom,y=(b.isLoading,k((0,n.useState)(""),2)),A=y[0],q=y[1],_=k((0,n.useState)(""),2),E=_[0],C=_[1];(0,n.useEffect)((function(){var e;(null==h?void 0:h.length)>0&&(q(null===(e=null==h?void 0:h[0].queueRoom)||void 0===e?void 0:e.uuid),C(null==h?void 0:h[0].uuid))}),[h]);var R=(0,s.ej)(t).mutate,T=(0,c.Su)(f).services,L=(0,s.dF)(f,p).rooms,N=(0,l.J)().queueLocations,Q=k((0,n.useState)(!1),2),I=Q[0],P=Q[1],U=(0,n.useCallback)((function(){A?(P(!1),(null==h?void 0:h.length)>0?(0,s.av)(E,A,t).then((function(e){200===e.status&&((0,i.showToast)({critical:!0,title:m("updateRoom","Update room"),kind:"success",description:m("queueRoomUpdatedSuccessfully","Queue room updated successfully")}),o(),localStorage.setItem("lastUpdatedQueueRoomTimestamp",(new Date).toString()),(0,d.By)(new Date),R())}),(function(e){(0,i.showNotification)({title:m("queueRoomAddFailed","Error adding queue room"),kind:"error",critical:!0,description:null==e?void 0:e.message}),o()})):(0,s._5)(A,t).then((function(e){201===e.status&&((0,i.showToast)({critical:!0,title:m("addRoom","Add room"),kind:"success",description:m("queueRoomAddedSuccessfully","Queue room added successfully")}),o(),localStorage.setItem("lastUpdatedQueueRoomTimestamp",(new Date).toString()),(0,d.By)(new Date),R())}),(function(e){(0,i.showNotification)({title:m("queueRoomAddFailed","Error adding queue room"),kind:"error",critical:!0,description:null==e?void 0:e.message})}))):P(!0)}),[A,null==h?void 0:h.length,E,t,m,o,R]);return r().createElement("div",null,r().createElement(u.xBx,{closeModal:o,title:m("addProviderQueueRoom","Add provider queue room?")}),r().createElement(u.fef,null,r().createElement(u.l09,{onSubmit:U},r().createElement("section",{className:w.section},r().createElement("div",{className:w.sectionTitle},m("queueLocation","Queue location")),r().createElement(u.Ltx,{id:"queueLocation",label:m("selectQueueLocation","Select a queue location"),type:"default",items:N,itemToString:function(e){return e?e.name:""},onChange:function(e){var t=e.selectedItem;localStorage.setItem("queueLocationUuid",t.id),localStorage.setItem("queueLocationName",t.name),(0,d.yl)(t.name),(0,d._j)(t.id)},size:"md",initialSelectedItem:{uuid:f,name:v}})),r().createElement("section",{className:w.section},r().createElement("div",{className:w.sectionTitle},m("queueService","Queue service")),r().createElement(u.Ltx,{id:"service",label:m("selectService","Select a service"),type:"default",items:T,itemToString:function(e){return e?e.display:""},onChange:function(e){var t=e.selectedItem;localStorage.setItem("queueServiceName",t.name),localStorage.setItem("queueServiceUuid",t.uuid),(0,d.yk)(t.name),(0,d.u_)(t.uuid)},size:"md",initialSelectedItem:{uuid:p,display:g}})),r().createElement("section",{className:w.section},r().createElement("div",{className:w.sectionTitle},m("queueRoom","Queue room")),r().createElement("div",{className:w.filterContainer},r().createElement(u.PhF,{labelText:m("selectRoom","Select a room"),id:"service",invalidText:"Required",value:A,defaultValue:A,onChange:function(e){q(e.target.value),localStorage.setItem("lastUpdatedQueueRoomTimestamp",(new Date).toString())}},A?null:r().createElement(u.QlF,{text:m("chooseRoom","Select a room"),value:""}),(null==L?void 0:L.length)>0&&L.map((function(e){return r().createElement(u.QlF,{key:e.uuid,text:e.display,value:e.uuid},e.display)}))))),I&&r().createElement("section",null,r().createElement(u.K0D,{style:{margin:"0",minWidth:"100%"},kind:"error",lowContrast:!0,title:m("missingQueueRoom","Please select a queue room")})),r().createElement("section",{className:w.section},r().createElement(u.XZJ,{onChange:function(e){localStorage.setItem("isPermanentProviderQueueRoom",JSON.parse(e.target.checked)),(0,d.wE)(JSON.parse(e.target.checked))},checked:S,labelText:m("retainLocation","Retain location"),id:"retianLocation",className:w.checkbox})))),r().createElement(u.mzw,null,r().createElement(u.zxk,{kind:"secondary",onClick:o},m("cancel","Cancel")),r().createElement(u.zxk,{onClick:U},m("save","Save"))))}},9672:(e,t,o)=>{o.d(t,{_5:()=>u,av:()=>i,dF:()=>a,ej:()=>c});var n=o(2870),r=o(3255);function a(e,t){var o,a=t?"/ws/rest/v1/queueroom?location=".concat(e,"&queue=").concat(t):"/ws/rest/v1/queueroom?location=".concat(e),u=(0,r.ZP)(e?a:null,n.openmrsFetch),i=u.data,c=u.error,l=u.isLoading;return{rooms:i?null==i||null===(o=i.data)||void 0===o?void 0:o.results:[],isError:c,isLoading:l}}function u(e,t){var o=new AbortController;return(0,n.openmrsFetch)("/ws/rest/v1/roomprovidermap",{method:"POST",headers:{"Content-Type":"application/json"},signal:o.signal,body:{queueRoom:{uuid:e},provider:{uuid:t}}})}function i(e,t,o){var r=new AbortController;return(0,n.openmrsFetch)("/ws/rest/v1/roomprovidermap/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"},signal:r.signal,body:{queueRoom:{uuid:t},provider:{uuid:o}}})}function c(e){var t,o="/ws/rest/v1/roomprovidermap?provider=".concat(e),a=(0,r.ZP)(e?o:null,n.openmrsFetch),u=a.data,i=a.error,c=a.isLoading,l=a.mutate;return{providerRoom:u?null==u||null===(t=u.data)||void 0===t?void 0:t.results:[],isError:i,isLoading:c,mutate:l}}},3670:(e,t,o)=>{o.d(t,{By:()=>C,Cb:()=>T,Hp:()=>Q,SY:()=>N,T4:()=>q,_j:()=>E,fn:()=>R,u_:()=>A,vM:()=>k,wE:()=>w,wJ:()=>L,yk:()=>y,yl:()=>_});var n=o(5206),r=o(2870);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,a=[],u=!0,i=!1;try{for(o=o.call(e);!(u=(n=o.next()).done)&&(a.push(n.value),!t||a.length!==t);u=!0);}catch(e){i=!0,r=e}finally{try{u||null==o.return||o.return()}finally{if(i)throw r}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(o):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var i={serviceName:localStorage.getItem("queueServiceName")},c={serviceUuid:localStorage.getItem("queueServiceUuid")},l={status:""},s={queueLocationName:localStorage.getItem("queueLocationName")},d={queueLocationUuid:localStorage.getItem("queueLocationUuid")},m={providerQueueRoomTimestamp:new Date},v={isPermanentProviderQueueRoom:localStorage.getItem("isPermanentProviderQueueRoom")};function f(){return(0,r.getGlobalStore)("queueSelectedServiceName",i)}function p(){return(0,r.getGlobalStore)("queueSelectedServiceUuid",c)}function g(){return(0,r.getGlobalStore)("appointmentSelectedStatus",l)}function S(){return(0,r.getGlobalStore)("queueLocationNameSelected",s)}function b(){return(0,r.getGlobalStore)("queueLocationUuidSelected",d)}function h(){return(0,r.getGlobalStore)("isPermanentProviderQueueRoom",v)}var y=function(e){f().setState({serviceName:e})},A=function(e){p().setState({serviceUuid:e})},q=function(e){g().setState({status:e})},_=function(e){S().setState({queueLocationName:e})},E=function(e){b().setState({queueLocationUuid:e})},C=function(e){(0,r.getGlobalStore)("queueProviderRoomTimestamp",m).setState({providerQueueRoomTimestamp:e})},w=function(e){h().setState({isPermanentProviderQueueRoom:e})},R=function(){var e,t=u((0,n.useState)(null!==(e=i.serviceName)&&void 0!==e?e:""),2),o=t[0],r=t[1];return(0,n.useEffect)((function(){f().subscribe((function(e){var t=e.serviceName;return r(t)}))}),[]),o},k=function(){var e=u((0,n.useState)(c.serviceUuid),2),t=e[0],o=e[1];return(0,n.useEffect)((function(){p().subscribe((function(e){var t=e.serviceUuid;return o(t)}))}),[]),t},T=function(){var e=u((0,n.useState)(l.status),2),t=e[0],o=e[1];return(0,n.useEffect)((function(){g().subscribe((function(e){var t=e.status;return o(t)}))}),[]),t},L=function(){var e=u((0,n.useState)(s.queueLocationName),2),t=e[0],o=e[1];return(0,n.useEffect)((function(){S().subscribe((function(e){var t=e.queueLocationName;return o(t)}))}),[]),t},N=function(){var e=u((0,n.useState)(d.queueLocationUuid),2),t=e[0],o=e[1];return(0,n.useEffect)((function(){b().subscribe((function(e){var t=e.queueLocationUuid;return o(t)}))}),[]),t},Q=function(){var e=u((0,n.useState)(v.isPermanentProviderQueueRoom),2),t=e[0],o=e[1];return(0,n.useEffect)((function(){h().subscribe((function(e){var t=e.isPermanentProviderQueueRoom;return o(t)}))}),[]),t}}}]);