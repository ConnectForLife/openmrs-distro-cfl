"use strict";(self.webpackChunk_openmrs_esm_patient_list_app=self.webpackChunk_openmrs_esm_patient_list_app||[]).push([[733],{7156:(t,e,n)=>{n.d(e,{Z:()=>i});var r=n(2609),a=n.n(r)()((function(t){return t[1]}));a.push([t.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-list__add-patient__productiveHeading02___pqPL2{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0)}.-esm-patient-list__add-patient__productiveHeading03___tEmC1{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-patient-list__add-patient__productiveHeading04___UU262{font-size:var(--cds-heading-04-font-size, 1.75rem);font-weight:var(--cds-heading-04-font-weight, 400);line-height:var(--cds-heading-04-line-height, 1.28572);letter-spacing:var(--cds-heading-04-letter-spacing, 0)}.-esm-patient-list__add-patient__bodyLong01___lHVdb{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}.-esm-patient-list__add-patient__bodyShort01___U\\+zw6{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-patient-list__add-patient__bodyShort02___9tG7c{font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0)}.-esm-patient-list__add-patient__text02___mcxkW{color:#525252}.-esm-patient-list__add-patient__label01___g4Hyx{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px)}.-esm-patient-list__add-patient__modal___Q2\\+K8{position:fixed;width:100vw;height:100vh;display:grid;background-color:rgba(0,0,0,.5);z-index:9000;justify-items:center;align-items:center}.-esm-patient-list__add-patient__modalContent___LO\\+sA{width:100%;background-color:#f4f4f4}.-esm-patient-list__add-patient__modalHeader___fqvlA{margin:1rem}.-esm-patient-list__add-patient__patientListList___Z12QR{padding:0 1rem}.-esm-patient-list__add-patient__largeButtons___Hs4Fz{padding-bottom:2rem}.-esm-patient-list__add-patient__checkbox___73-sG{padding-bottom:.875rem}.-esm-patient-list__add-patient__pagination___P\\+zJC{width:100%;overflow:hidden}.-esm-patient-list__add-patient__paginationContainer___-XK-g{display:flex;justify-content:space-between;align-items:center;position:relative}.-esm-patient-list__add-patient__itemsCountDisplay___dlKde{position:absolute;top:0;left:1rem;height:3rem;display:flex;align-items:center;color:#525252}.-esm-patient-list__add-patient__pagination___P\\+zJC>div:first-child{visibility:hidden;width:0}.-esm-patient-list__add-patient__buttonSet___ybKNb{display:flex;justify-content:space-between;align-items:flex-start}",""]),a.locals={productiveHeading02:"-esm-patient-list__add-patient__productiveHeading02___pqPL2",productiveHeading03:"-esm-patient-list__add-patient__productiveHeading03___tEmC1",productiveHeading04:"-esm-patient-list__add-patient__productiveHeading04___UU262",bodyLong01:"-esm-patient-list__add-patient__bodyLong01___lHVdb",bodyShort01:"-esm-patient-list__add-patient__bodyShort01___U+zw6",bodyShort02:"-esm-patient-list__add-patient__bodyShort02___9tG7c",text02:"-esm-patient-list__add-patient__text02___mcxkW",label01:"-esm-patient-list__add-patient__label01___g4Hyx",modal:"-esm-patient-list__add-patient__modal___Q2+K8",modalContent:"-esm-patient-list__add-patient__modalContent___LO+sA",modalHeader:"-esm-patient-list__add-patient__modalHeader___fqvlA",patientListList:"-esm-patient-list__add-patient__patientListList___Z12QR",largeButtons:"-esm-patient-list__add-patient__largeButtons___Hs4Fz",checkbox:"-esm-patient-list__add-patient__checkbox___73-sG",pagination:"-esm-patient-list__add-patient__pagination___P+zJC",paginationContainer:"-esm-patient-list__add-patient__paginationContainer___-XK-g",itemsCountDisplay:"-esm-patient-list__add-patient__itemsCountDisplay___dlKde",buttonSet:"-esm-patient-list__add-patient__buttonSet___ybKNb"};const i=a},733:(t,e,n)=>{n.r(e),n.d(e,{default:()=>U,useAddablePatientLists:()=>N});var r=n(5047),a=n.n(r),i=n(268),o=n.n(i),s=n(4924),c=n(9857),l=n(906),d=n(4626),u=n(2565),p=n(6062),_=n.n(p),f=n(4036),m=n.n(f),h=n(6793),g=n.n(h),y=n(7892),v=n.n(y),b=n(1173),w=n.n(b),x=n(2464),k=n.n(x),C=n(7156),S={};S.styleTagTransform=k(),S.setAttributes=v(),S.insert=g().bind(null,"head"),S.domAPI=m(),S.insertStyleElement=w(),_()(C.Z,S);const P=C.Z&&C.Z.locals?C.Z.locals:void 0;function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function E(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function O(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(t){E(i,r,a,o,s,"next",t)}function s(t){E(i,r,a,o,s,"throw",t)}o(void 0)}))}}function L(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);o=!0);}catch(t){s=!0,a=t}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(t,e)||j(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(t){return function(t){if(Array.isArray(t))return A(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||j(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(t,e){if(t){if("string"==typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(t,e):void 0}}function N(t){var e=(0,s.useTranslation)().t;return(0,c.ZP)(["addablePatientLists",t],O(a().mark((function n(){var r,i,o;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=L,n.next=3,Promise.allSettled([H(t,e),T(t)]);case 3:return n.t1=n.sent,r=(0,n.t0)(n.t1,2),i=r[0],o=r[1],n.abrupt("return",z("fulfilled"===i.status?i.value:[]).concat(z("fulfilled"===o.status?o.value:[])));case 8:case"end":return n.stop()}}),n)}))))}function T(t){return D.apply(this,arguments)}function D(){return(D=O(a().mark((function t(e){var n,r,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=L,t.next=3,Promise.all([(0,u.SA)(),(0,u.U6)(e)]);case 3:return t.t1=t.sent,n=(0,t.t0)(t.t1,2),r=n[0],i=n[1],t.abrupt("return",r.filter((function(t){return!i.includes(t.id)})).map((function(t){return{id:t.id,displayName:t.display,addPatient:function(){return O(a().mark((function n(){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,u.xj)({cohort:t.id,patient:e,startDate:(0,l.toOmrsIsoString)(new Date)});case 2:case"end":return n.stop()}}),n)})))()}}})));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function H(t,e){return I.apply(this,arguments)}function I(){return(I=O(a().mark((function t(e,n){var r,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,l.getDynamicOfflineDataEntries)("patient");case 2:return r=t.sent,i=r.some((function(t){return t.identifier===e})),t.abrupt("return",i?[]:[{id:"fake-offline-patient-list",displayName:n("offlinePatients","Offline patients"),addPatient:function(){return O(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,l.putDynamicOfflineData)("patient",e);case 2:return t.next=4,(0,l.syncDynamicOfflineData)("patient",e);case 4:case"end":return t.stop()}}),t)})))()}}]);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}const U=function(t){var e=t.closeModal,n=t.patientUuid,r=(0,s.useTranslation)().t,a=L((0,i.useState)(""),2),c=a[0],u=a[1],p=L((0,i.useState)([]),2),_=p[0],f=p[1],m=N(n),h=m.data,g=m.isValidating,y=(0,i.useCallback)((function(t,e){f(e?function(e){return z(e).concat([t])}:function(e){return e.filter((function(e){return e!==t}))})}),[]),v=(0,i.useCallback)((function(){var t=!0,n=!1,a=void 0;try{for(var i,o=function(){var t=i.value,e=h.find((function(e){return e.id===t}));if(!e)return"continue";e.addPatient().then((function(){return(0,l.showToast)({title:r("successfullyAdded","Successfully added"),kind:"success",description:"".concat(r("successAddPatientToList","Patient added to list"),": ").concat(e.displayName)})})).catch((function(){return(0,l.showToast)({title:r("error","Error"),kind:"error",description:"".concat(r("errorAddPatientToList","Patient not added to list"),": ").concat(e.displayName)})}))},s=_[Symbol.iterator]();!(t=(i=s.next()).done);t=!0)o()}catch(t){n=!0,a=t}finally{try{t||null==s.return||s.return()}finally{if(n)throw a}}e()}),[h,_,e,r]),b=(0,i.useMemo)((function(){if(!h)return[];if((null==c?void 0:c.trim().length)>0){var t=c.toLowerCase();return h.filter((function(e){return e.displayName.toLowerCase().includes(t)}))}return h}),[c,h]),w=(0,l.usePagination)(b,5),x=w.results,k=w.goTo,C=w.currentPage,S=w.paginated;return(0,i.useEffect)((function(){1!==C&&k(1)}),[c]),o().createElement("div",{className:P.modalContent},o().createElement("div",{className:P.modalHeader},o().createElement("h1",{className:P.productiveHeading03},r("addPatientToList","Add patient to list")),o().createElement("h3",{className:P.bodyLong01,style:{margin:"1rem 0"}},r("searchForAListToAddThisPatientTo","Search for a list to add this patient to."))),o().createElement("div",{style:{marginBottom:"0.875rem"}},o().createElement(d.olm,{style:{backgroundColor:"white",borderBottom:"1px solid #e0e0e0"},labelText:r("searchForList","Search for a list"),placeholder:"Filter list",onChange:function(t){var e=t.target;u(e.value)},value:c})),o().createElement("div",{className:P.patientListList},o().createElement("fieldset",{className:"cds--fieldset"},o().createElement("p",{className:"cds--label"},"Patient Lists"),!g&&x?x.length>0?x.map((function(t){return o().createElement("div",{key:t.id,className:P.checkbox},o().createElement(d.XZJ,{key:t.id,onChange:function(e){return y(t.id,e)},checked:_.some((function(e){return e===t.id})),labelText:t.displayName,id:t.id}))})):o().createElement("p",{className:P.bodyLong01},r("noPatientListFound","No patient list found")):o().createElement(d.N2B,null))),S&&o().createElement("div",{className:P.paginationContainer},o().createElement("span",{className:"".concat(P.itemsCountDisplay," ").concat(P.bodyLong01)},x.length*C," / ",b.length," ",r("items","items")),o().createElement(d.tlE,{className:P.pagination,forwardText:"",backwardText:"",page:C,pageSize:5,pageSizes:[5],totalItems:b.length,onChange:function(t){var e=t.page;return k(e)}})),o().createElement("div",{className:P.buttonSet},o().createElement(d.zxk,{kind:"ghost"},r("createNewPatientList","Create new patient list")),o().createElement("div",null,o().createElement(d.zxk,{kind:"secondary",className:P.largeButtons,onClick:e},r("cancel","Cancel")),o().createElement(d.zxk,{onClick:v,className:P.largeButtons},r("addToList","Add to list")))))}},2565:(t,e,n)=>{n.d(e,{D_:()=>S,SA:()=>y,U6:()=>w,kN:()=>A,n_:()=>O,w5:()=>b,xj:()=>k,yn:()=>_});var r=n(5047),a=n.n(r),i=n(906);function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(t){s(i,r,a,o,c,"next",t)}function c(t){s(i,r,a,o,c,"throw",t)}o(void 0)}))}}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){l(t,e,n[e])}))}return t}function u(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n.push.apply(n,r)}return n}(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})),t}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);o=!0);}catch(t){s=!0,a=t}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var _="/ws/rest/v1/cohortm";function f(t){return m.apply(this,arguments)}function m(){return m=c(a().mark((function t(e){var n,r,o,s=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=s.length>2&&void 0!==s[2]?s[2]:new AbortController,t.next=3,(0,i.openmrsFetch)(e,{signal:r.signal,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 3:return o=t.sent,t.abrupt("return",o.data);case 5:case"end":return t.stop()}}),t)}))),m.apply(this,arguments)}function h(t){return g.apply(this,arguments)}function g(){return g=c(a().mark((function t(e){var n,r,o,s=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=s.length>2&&void 0!==s[2]?s[2]:new AbortController,t.next=3,(0,i.openmrsFetch)(e,{signal:r.signal,method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 3:return o=t.sent,t.abrupt("return",o.data);case 5:case"end":return t.stop()}}),t)}))),g.apply(this,arguments)}function y(){return v.apply(this,arguments)}function v(){return v=c(a().mark((function t(){var e,n,r,o,s,c,l,d,u=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=u.length>0&&void 0!==u[0]?u[0]:{},n=u.length>1&&void 0!==u[1]?u[1]:new AbortController,r=[["v","custom:(uuid,name,description,display,size,attributes)"]],void 0!==e.name&&""!==e.name&&r.push(["q",e.name]),void 0!==e.isStarred&&r.push(["attribute","starred:".concat(e.isStarred)]),o=r.map((function(t){var e=p(t,2),n=e[0],r=e[1];return"".concat(n,"=").concat(encodeURIComponent(r))})).join("&"),t.next=8,(0,i.openmrsFetch)("".concat(_,"/cohort?").concat(o),{signal:n.signal});case 8:if(s=t.sent,c=s.data,l=c.results,!(d=c.error)){t.next=14;break}throw d;case 14:return t.abrupt("return",l.map((function(t){var e;return{id:t.uuid,display:t.name,description:t.description,type:null===(e=t.attributes.find((function(t){var e;return"Patient List Type"===(null==t||null===(e=t.cohortAttributeType)||void 0===e?void 0:e.name)})))||void 0===e?void 0:e.value,size:t.size,isStarred:!1}})));case 15:case"end":return t.stop()}}),t)}))),v.apply(this,arguments)}function b(t,e){return Promise.resolve()}function w(t){return x.apply(this,arguments)}function x(){return x=c(a().mark((function t(e){var n,r,o,s,c,l=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:new AbortController,t.next=3,(0,i.openmrsFetch)("".concat(_,"/cohortmember?patient=").concat(e,"&v=default"),{signal:n.signal});case 3:if(r=t.sent,o=r.data,s=o.results,!(c=o.error)){t.next=9;break}throw c;case 9:return t.abrupt("return",s.map((function(t){return t.cohort.uuid})));case 10:case"end":return t.stop()}}),t)}))),x.apply(this,arguments)}function k(t){return C.apply(this,arguments)}function C(){return C=c(a().mark((function t(e){var n,r=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:new AbortController,t.abrupt("return",f("".concat(_,"/cohortmember"),e,n));case 2:case"end":return t.stop()}}),t)}))),C.apply(this,arguments)}function S(t){return P.apply(this,arguments)}function P(){return P=c(a().mark((function t(e){var n,r=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:new AbortController,t.abrupt("return",f("".concat(_,"/cohort/"),u(d({},e),{startDate:new Date,groupCohort:!1,definitionHandlerClassname:"org.openmrs.module.cohort.definition.handler.DefaultCohortDefinitionHandler"}),n));case 2:case"end":return t.stop()}}),t)}))),P.apply(this,arguments)}function A(t,e){return E.apply(this,arguments)}function E(){return E=c(a().mark((function t(e,n){var r,i=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:new AbortController,t.abrupt("return",f("".concat(_,"/cohort/").concat(e),n,r));case 2:case"end":return t.stop()}}),t)}))),E.apply(this,arguments)}function O(t){return L.apply(this,arguments)}function L(){return L=c(a().mark((function t(e){var n,r=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:new AbortController,t.abrupt("return",h("".concat(_,"/cohort/").concat(e),{voidReason:""},n));case 2:case"end":return t.stop()}}),t)}))),L.apply(this,arguments)}}}]);