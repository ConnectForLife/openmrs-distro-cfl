"use strict";(globalThis.webpackChunk_openmrs_esm_patient_allergies_app=globalThis.webpackChunk_openmrs_esm_patient_allergies_app||[]).push([[660],{2435:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(272),r=n.n(a),l=n(2609),i=n.n(l)()(r());i.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}:root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-allergies__allergy-form__productiveHeading01___jVHlb{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px)}.-esm-patient-allergies__allergy-form__productiveHeading02___AqkSP{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__productiveHeading03___Dz8TI{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__productiveHeading04___O3iLB{font-size:var(--cds-heading-04-font-size, 1.75rem);font-weight:var(--cds-heading-04-font-weight, 400);line-height:var(--cds-heading-04-line-height, 1.28572);letter-spacing:var(--cds-heading-04-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__productiveHeading05___HYHD4{font-size:var(--cds-heading-05-font-size, 2rem);font-weight:var(--cds-heading-05-font-weight, 400);line-height:var(--cds-heading-05-line-height, 1.25);letter-spacing:var(--cds-heading-05-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__productiveHeading06___EpNh_{font-size:var(--cds-heading-06-font-size, 2.625rem);font-weight:var(--cds-heading-06-font-weight, 300);line-height:var(--cds-heading-06-line-height, 1.199);letter-spacing:var(--cds-heading-06-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__bodyShort01___b4MZO{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-patient-allergies__allergy-form__bodyShort02___GvHHe{font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__bodyLong01___g6fq0{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}.-esm-patient-allergies__allergy-form__bodyLong02___Rzjzc{font-size:var(--cds-body-02-font-size, 1rem);font-weight:var(--cds-body-02-font-weight, 400);line-height:var(--cds-body-02-line-height, 1.5);letter-spacing:var(--cds-body-02-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__label01___KyOYB{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px)}.-esm-patient-allergies__allergy-form__header___QZLSQ{border-bottom:.0625rem solid #e0e0e0;margin:0}.-esm-patient-allergies__allergy-form__content___BiJ1K{display:grid;grid-template-columns:50% 10% 1fr;margin:.5rem 1rem}.-esm-patient-allergies__allergy-form__container___azun6{border:solid 1px #e0e0e0;margin:0rem 1rem 1rem}.-esm-patient-allergies__allergy-form__container___azun6:first-of-type{margin-bottom:2rem}.-esm-patient-allergies__allergy-form__container___azun6:last-of-type{margin-top:2.5rem}.-esm-patient-allergies__allergy-form__heading___Y2mIr{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0);margin:1rem 1rem .5rem}.-esm-patient-allergies__allergy-form__section___cQIuG:not(:first-of-type){margin-bottom:2rem}.-esm-patient-allergies__allergy-form__wrapperContainer___sEcVG fieldset{display:grid;grid-template-columns:1fr 1fr;width:100%}.-esm-patient-allergies__allergy-form__wrapperContainer___sEcVG .cds--radio-button__label{justify-content:flex-start}.-esm-patient-allergies__allergy-form__tablist___JWVw1 .cds--tab--list{justify-content:center;width:100%}.-esm-patient-allergies__allergy-form__tab___XwK7G{flex-grow:1}.-esm-patient-allergies__allergy-form__sectionHeading___pzf6h{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);margin:1rem 1rem .5rem}.-esm-patient-allergies__allergy-form__midSectionHeading___Fb7nc{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);margin:0rem 1rem .5rem}.-esm-patient-allergies__allergy-form__radio___cCJp1{margin:1rem 0rem}.-esm-patient-allergies__allergy-form__radio___cCJp1 label{justify-content:flex-start}.-esm-patient-allergies__allergy-form__checkbox___A9usx:not(:first-child){margin:.3rem 0rem}.-esm-patient-allergies__allergy-form__input___RQrII{margin:0rem 1rem 1rem}.-esm-patient-allergies__allergy-form__checkboxContainer___EHQjt{display:grid;grid-template-columns:1fr 1fr}.-esm-patient-allergies__allergy-form__wrapper___BZ3jn{margin:1rem}.-esm-patient-allergies__allergy-form__wrapper___BZ3jn:last-of-type{margin-top:1.5rem}.-esm-patient-allergies__allergy-form__button___WnjB1{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-patient-allergies__allergy-form__tablet___p6TGp{padding:0rem}.-esm-patient-allergies__allergy-form__desktopButtons___Xmt1r{margin-top:2rem}.-esm-patient-allergies__allergy-form__tabletButtons___rIW7a{margin-top:2rem;padding:1.5rem 1rem;background-color:#fff}.-esm-patient-allergies__allergy-form__desktop___bF4ok{padding:0rem}.-esm-patient-allergies__allergy-form__form___ri4Rk{display:flex;flex-direction:column;justify-content:space-between}.-esm-patient-allergies__allergy-form__desktopContainer___PiWdJ{background-color:#f4f4f4}.-esm-patient-allergies__allergy-form__tabletContainer___oQ07C{background-color:#fff}.omrs-breakpoint-gt-tablet .-esm-patient-allergies__allergy-form__form___ri4Rk{height:calc(100vh - 6rem)}.omrs-breakpoint-gt-tablet .-esm-patient-allergies__allergy-form__section___cQIuG:last-of-type{margin-top:2rem}.omrs-breakpoint-lt-desktop .-esm-patient-allergies__allergy-form__form___ri4Rk{height:calc(100vh - 9rem)}.omrs-breakpoint-lt-desktop .-esm-patient-allergies__allergy-form__section___cQIuG:last-of-type{margin-top:0rem}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/root.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss","webpack://./src/allergies/allergies-form/allergy-form.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CAHF,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,mECs0BI,2DAAA,CAAA,0DAAA,CAAA,8DAAA,CAAA,mEAAA,CDl0BJ,mECk0BI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CD9zBJ,mEC8zBI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CD1zBJ,mEC0zBI,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CAAA,sDAAA,CDtzBJ,mECszBI,+CAAA,CAAA,kDAAA,CAAA,mDAAA,CAAA,sDAAA,CDlzBJ,mECkzBI,mDAAA,CAAA,kDAAA,CAAA,oDAAA,CAAA,sDAAA,CD9yBJ,2DC8yBI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CD1yBJ,2DC0yBI,oDAAA,CAAA,uDAAA,CAAA,yDAAA,CAAA,2DAAA,CDtyBJ,0DCsyBI,gDAAA,CAAA,+CAAA,CAAA,mDAAA,CAAA,wDAAA,CDlyBJ,0DCkyBI,4CAAA,CAAA,+CAAA,CAAA,+CAAA,CAAA,mDAAA,CD9xBJ,uDC8xBI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CCr0BJ,sDACE,oCAAA,CACA,QAAA,CAGF,uDACE,YAAA,CACA,iCAAA,CACA,iBAAA,CAGF,yDACE,wBAAA,CACA,qBAAA,CAEA,uEACE,kBAAA,CAGF,sEACE,iBAAA,CAIJ,uDD6yBI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CC3yBF,sBAAA,CAIA,2EACE,kBAAA,CAIJ,yEACE,YAAA,CACA,6BAAA,CACA,UAAA,CAGF,0FACE,0BAAA,CAIA,uEACE,sBAAA,CACA,UAAA,CAIJ,mDACE,WAAA,CAGF,8DD6wBI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CC3wBF,sBAAA,CAGF,iEDwwBI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CCtwBF,sBAAA,CAGF,qDACE,gBAAA,CAEA,2DACE,0BAAA,CAKF,0EACE,iBAAA,CAIJ,qDACE,qBAAA,CAGF,iEACE,YAAA,CACA,6BAAA,CAGF,uDACE,WAAA,CAEA,oEACE,iBAAA,CAIJ,sDACE,WAAA,CACA,YAAA,CACA,wBAAA,CACA,oBAAA,CACA,aAAA,CAGF,sDACE,YAAA,CAGF,8DACE,eAAA,CAGF,6DACE,eAAA,CACA,mBAAA,CACA,qBHxHM,CG2HR,uDACE,YAAA,CAGF,oDACE,YAAA,CACA,qBAAA,CACA,6BAAA,CAGF,gEACE,wBHvIM,CG0IR,+DACE,qBAAA,CAKA,+EACE,yBAAA,CAIA,+FACE,eAAA,CAOJ,gFACE,yBAAA,CAIA,gGACE,eAAA",sourceRoot:""}]),i.locals={productiveHeading01:"-esm-patient-allergies__allergy-form__productiveHeading01___jVHlb",productiveHeading02:"-esm-patient-allergies__allergy-form__productiveHeading02___AqkSP",productiveHeading03:"-esm-patient-allergies__allergy-form__productiveHeading03___Dz8TI",productiveHeading04:"-esm-patient-allergies__allergy-form__productiveHeading04___O3iLB",productiveHeading05:"-esm-patient-allergies__allergy-form__productiveHeading05___HYHD4",productiveHeading06:"-esm-patient-allergies__allergy-form__productiveHeading06___EpNh_",bodyShort01:"-esm-patient-allergies__allergy-form__bodyShort01___b4MZO",bodyShort02:"-esm-patient-allergies__allergy-form__bodyShort02___GvHHe",bodyLong01:"-esm-patient-allergies__allergy-form__bodyLong01___g6fq0",bodyLong02:"-esm-patient-allergies__allergy-form__bodyLong02___Rzjzc",label01:"-esm-patient-allergies__allergy-form__label01___KyOYB",header:"-esm-patient-allergies__allergy-form__header___QZLSQ",content:"-esm-patient-allergies__allergy-form__content___BiJ1K",container:"-esm-patient-allergies__allergy-form__container___azun6",heading:"-esm-patient-allergies__allergy-form__heading___Y2mIr",section:"-esm-patient-allergies__allergy-form__section___cQIuG",wrapperContainer:"-esm-patient-allergies__allergy-form__wrapperContainer___sEcVG",tablist:"-esm-patient-allergies__allergy-form__tablist___JWVw1",tab:"-esm-patient-allergies__allergy-form__tab___XwK7G",sectionHeading:"-esm-patient-allergies__allergy-form__sectionHeading___pzf6h",midSectionHeading:"-esm-patient-allergies__allergy-form__midSectionHeading___Fb7nc",radio:"-esm-patient-allergies__allergy-form__radio___cCJp1",checkbox:"-esm-patient-allergies__allergy-form__checkbox___A9usx",input:"-esm-patient-allergies__allergy-form__input___RQrII",checkboxContainer:"-esm-patient-allergies__allergy-form__checkboxContainer___EHQjt",wrapper:"-esm-patient-allergies__allergy-form__wrapper___BZ3jn",button:"-esm-patient-allergies__allergy-form__button___WnjB1",tablet:"-esm-patient-allergies__allergy-form__tablet___p6TGp",desktopButtons:"-esm-patient-allergies__allergy-form__desktopButtons___Xmt1r",tabletButtons:"-esm-patient-allergies__allergy-form__tabletButtons___rIW7a",desktop:"-esm-patient-allergies__allergy-form__desktop___bF4ok",form:"-esm-patient-allergies__allergy-form__form___ri4Rk",desktopContainer:"-esm-patient-allergies__allergy-form__desktopContainer___PiWdJ",tabletContainer:"-esm-patient-allergies__allergy-form__tabletContainer___oQ07C"};const o=i},660:(e,t,n)=>{n.r(t),n.d(t,{default:()=>F});var a=n(7900),r=n.n(a),l=n(4924),i=n(3520),o=n(195),s=n(8883),c=n(3955),A=n(2870),_=n(2303),d=n(6705),g=n(1354),m=n.n(g),u=n(1583),p=n.n(u),f=n(7378),C=n.n(f),h=n(5993),y=n.n(h),v=n(4154),b=n.n(v),E=n(8141),D=n.n(E),B=n(2435),w={};w.styleTagTransform=D(),w.setAttributes=y(),w.insert=C().bind(null,"head"),w.domAPI=p(),w.insertStyleElement=b(),m()(B.Z,w);const k=B.Z&&B.Z.locals?B.Z.locals:void 0;function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,l=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(l.push(a.value),!t||l.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var S=o.z.object({selectedAllergen:o.z.string(),nonCodedAllergenType:o.z.string().optional(),allergicReactions:o.z.array(o.z.string().optional()),nonCodedAllergicReaction:o.z.string().optional(),severityOfWorstReaction:o.z.string(),comment:o.z.string().optional()});function R(e){var t=e.children;return e.isTablet?r().createElement(i.mh4,null,t," "):r().createElement(r().Fragment,null,t)}function H(e){var t=e.allergensAndAllergicReactions,n=e.methods,l=n.control,o=n.setValue,s=(0,a.useCallback)((function(e,t,n,a){e(n),o("allergicReactions.".concat(a),t?n:"",{shouldValidate:!0})}),[o]),A=t.allergicReactions.map((function(e,t){return r().createElement(c.Qr,{key:e.uuid,name:"allergicReactions.".concat(t),control:l,defaultValue:"",render:function(n){var a=n.field,l=a.onBlur,o=a.onChange,c=a.value;return r().createElement(i.XZJ,{className:k.checkbox,labelText:e.display,id:e.uuid,onChange:function(e,n){var a=n.checked,r=n.id;s(o,a,r,t)},checked:Boolean(c),onBlur:l})}})}));return r().createElement(r().Fragment,null,A)}const F=function(e){var t,n,o,g,m,u,p,f,C,h,y,v,b,E=e.closeWorkspace,D=e.patientUuid,B=(0,l.useTranslation)().t,w=(0,A.useConfig)().concepts,z="tablet"===(0,A.useLayoutType)(),F=[B("drug","Drug"),B("food","Food"),B("environmental","Environmental")],N=[B("mild","Mild"),B("moderate","Moderate"),B("severe","Severe")],x=(0,a.useMemo)((function(){return{patientUuid:D}}),[D]),T=(0,a.useMemo)((function(){return w}),[w]),G=T.mildReactionUuid,J=T.severeReactionUuid,O=T.moderateReactionUuid,Q=T.otherConceptUuid,U=(n=(t=(0,A.useConfig)().concepts).drugAllergenUuid,o=t.environmentalAllergenUuid,g=t.foodAllergenUuid,m=t.allergyReactionUuid,u=(0,_.Z)("/ws/rest/v1/concept/".concat(n,"?v=full"),A.openmrsFetch).data,p=(0,_.Z)("/ws/rest/v1/concept/".concat(o,"?v=full"),A.openmrsFetch).data,f=(0,_.Z)("/ws/rest/v1/concept/".concat(g,"?v=full"),A.openmrsFetch).data,C=(0,_.Z)("/ws/rest/v1/concept/".concat(m,"?v=full"),A.openmrsFetch).data,y=(h=function(e){var t,n;return null==e||null===(n=e.data)||void 0===n||null===(t=n.setMembers)||void 0===t?void 0:t.map((function(e){return{uuid:e.uuid,display:e.display}}))})(u),v=h(p),b=h(f),{isLoading:!(u&&p&&f&&C),allergensAndAllergicReactions:{allergicReactions:h(C),drugAllergens:y,environmentalAllergens:v,foodAllergens:b}}),j=U.allergensAndAllergicReactions,L=U.isLoading,V=I((0,a.useState)(null),2),Z=V[0],W=V[1],Y=I((0,a.useState)(!0),2),M=Y[0],P=Y[1],q=I((0,a.useState)("DRUG"),2),K=q[0],X=q[1],$=(0,d.PI)(D).mutate,ee=(0,c.cI)({mode:"all",resolver:(0,s.F)(S),defaultValues:{allergicReactions:[]}}),te=ee.control,ne=ee.handleSubmit,ae=ee.watch,re=(ee.getValues,ee.setValue),le=ae("allergicReactions"),ie=ae("selectedAllergen"),oe=ae("allergicReactions"),se=ae("severityOfWorstReaction"),ce=ae("nonCodedAllergenType"),Ae=ae("nonCodedAllergicReaction");(0,a.useEffect)((function(){var e=null==oe?void 0:oe.some((function(e){return""!==e}));P(!(ie&&e&&se))}),[oe,ae,ie,se,Q,ce]);var _e=(0,a.useCallback)((function(e){var t=e.comment,n=e.selectedAllergen,a=e.nonCodedAllergenType,r=e.nonCodedAllergicReaction,l=e.allergicReactions,i=e.severityOfWorstReaction,o=l.filter((function(e){return""!==e})),s={allergen:n===Q?{allergenType:K,codedAllergen:{uuid:n},nonCodedAllergen:a}:{allergenType:K,codedAllergen:{uuid:n}},severity:{uuid:i},comment:t,reactions:null==o?void 0:o.map((function(e){return e===Q?{reaction:{uuid:e},reactionNonCoded:r}:{reaction:{uuid:e}}}))},c=new AbortController;(function(e,t,n){return(0,A.openmrsFetch)("/ws/rest/v1/patient/".concat(t,"/allergy"),{headers:{"Content-Type":"application/json"},method:"POST",body:e,signal:n.signal})})(s,D,c).then((function(e){201===e.status&&($(),E(),(0,A.showToast)({critical:!0,kind:"success",title:B("allergySaved","Allergy saved"),description:B("allergyNowVisible","It is now visible on the Allergies page")}))}),(function(e){W(e),(0,A.showNotification)({title:B("allergySaveError","Error saving allergy"),kind:"error",critical:!0,description:null==e?void 0:e.message})})).finally((function(){return c.abort()}))}),[K,Q,D,E,B,$]);return r().createElement(i.l09,null,z?r().createElement(i.X2j,{className:k.header},r().createElement(A.ExtensionSlot,{className:k.content,name:"patient-details-header-slot",state:x})):null,r().createElement("div",{className:"".concat(k.form," ").concat(z?k.tablet:k.desktop)},r().createElement("div",null,r().createElement("h1",{className:k.heading},B("allergensAndReactions","Allergens and reactions")),Z?r().createElement(i.K0D,{style:{margin:"0rem",minWidth:"100%"},kind:"error",lowContrast:!0,title:B("errorFetchingData","Error fetching allergens and reactions"),subtitle:B("tryReopeningTheForm","Please try launching the form again")}):null,r().createElement("div",{className:"".concat(k.container," ").concat(z?k.tabletContainer:k.desktopContainer)},r().createElement("section",{className:k.section},r().createElement("h2",{className:k.sectionHeading},B("selectAllergens","Select the allergens")),r().createElement(i.mQc,{onSelectionChange:function(e){switch(e){case 0:X("DRUG");break;case 1:X("FOOD");break;case 2:X("ENVIRONMENT")}}},r().createElement(i.tdY,{"aria-label":"Allergen tabs",className:k.tablist},F.map((function(e,t){return r().createElement(i.OK9,{className:k.tab,id:"tab-".concat(t+1),key:"allergen-tab-".concat(t)},e)}))),r().createElement(i.nPR,null,L?r().createElement(i.lSo,{style:{margin:"1rem"},description:"".concat(B("loading","Loading")," ...")}):F.map((function(e,t){var n=e.toLowerCase()+"Allergens";return r().createElement(i.x45,{key:"allergen-tab-panel-".concat(t)},r().createElement("div",{className:z?k.wrapperContainer:void 0},r().createElement(c.Qr,{name:"selectedAllergen",control:te,render:function(e){var a,l=e.field,o=l.onBlur,s=l.onChange,c=l.value;return r().createElement(i.SYO,{name:"allergen-type-".concat(t+1),key:n,orientation:"vertical",onChange:function(e){return s(e.toString())},valueSelected:c,onBlur:o},null==j||null===(a=j[n])||void 0===a?void 0:a.map((function(e,t){return r().createElement(i.EUY,{key:"allergen-".concat(t),className:k.radio,id:e.display,labelText:e.display,value:e.uuid})})))}})))})))),ie===Q?r().createElement("div",{className:k.input},r().createElement(R,{isTablet:z},r().createElement(c.Qr,{name:"nonCodedAllergenType",control:te,rules:{required:ae("selectedAllergen")===Q},render:function(e){var t=e.field,n=t.onBlur,a=t.onChange,l=t.value,o=t.ref;return r().createElement(i.oil,{id:"nonCodedAllergenType",labelText:B("otherNonCodedAllergen","Other non-coded allergen"),onChange:a,onBlur:n,placeholder:B("typeAllergenName","Please type in the name of the allergen"),value:l,ref:o})}}))):null),r().createElement("section",{className:k.section},r().createElement("h2",{className:k.midSectionHeading},B("selectReactions","Select the reactions")),r().createElement("div",{className:z?k.checkboxContainer:void 0,style:{margin:"1rem"}},L?r().createElement(i.lSo,{description:"".concat(B("loading","Loading")," ...")}):r().createElement(H,{allergensAndAllergicReactions:j,methods:{setValue:re,control:te}})),(null==le?void 0:le.includes(Q))?r().createElement("div",{className:k.input},r().createElement(R,{isTablet:z},r().createElement(c.Qr,{name:"nonCodedAllergicReaction",control:te,render:function(e){var t=e.field,n=t.onBlur,a=t.onChange,l=t.value;return r().createElement(i.oil,{id:"nonCodedAllergicReaction",labelText:B("otherNonCodedAllergicReaction","Other non-coded allergic reaction"),onChange:a,onBlur:n,value:l,placeholder:B("typeAllergicReactionName","Please type in the name of the allergic reaction")})}}))):null)),r().createElement("h1",{className:k.heading},B("severityAndOnsetDate","Severity and date of onset")),r().createElement("div",{className:"".concat(k.container," ").concat(z?k.tabletContainer:k.desktopContainer)},r().createElement("section",{className:k.section},r().createElement("h2",{className:k.sectionHeading},B("severityOfWorstReaction","Severity of worst reaction")),r().createElement("div",{className:k.wrapper},r().createElement(c.Qr,{name:"severityOfWorstReaction",control:te,render:function(e){var t=e.field,n=t.onBlur,a=t.onChange,l=t.value;return r().createElement(i.SYO,{name:"severity-of-worst-reaction",onChange:function(e){return a(e.toString())},valueSelected:l,onBlur:n},N.map((function(e,t){return r().createElement(i.EUY,{id:e.toLowerCase()+"Severity",key:"severity-".concat(t),labelText:e,value:function(){switch(e.toLowerCase()){case"mild":return G;case"moderate":return O;case"severe":return J;default:return""}}()})})))}}))),r().createElement("section",{className:k.section},r().createElement("h2",{className:k.sectionHeading},B("onsetDateAndComments","Onset date and comments")),r().createElement("div",{className:k.wrapper},r().createElement(R,{isTablet:z},r().createElement(c.Qr,{name:"comment",control:te,render:function(e){var t=e.field,n=t.onBlur,a=t.onChange,l=t.value;return r().createElement(i.Kx8,{cols:20,id:"comments",invalidText:B("invalidComment","Invalid comment, try again"),labelText:B("dateOfOnsetAndComments","Date of onset and comments"),onChange:a,placeholder:B("typeAdditionalComments","Type any additional comments here"),onBlur:n,value:l,rows:4})}})))))),r().createElement(i.uVA,{className:z?k.tabletButtons:k.desktopButtons},r().createElement(i.zxk,{className:k.button,onClick:E,kind:"secondary"},B("discard","Discard")),r().createElement(i.zxk,{className:k.button,disabled:M||ie===Q&&!ce||(null==oe?void 0:oe.includes(Q))&&!Ae,onClick:ne(_e),kind:"primary"},B("saveAndClose","Save and close")))))}},6705:(e,t,n)=>{n.d(t,{PI:()=>i});var a=n(3255),r=n(3315),l=n(2870);function i(e){var t,n="".concat(l.fhirBaseUrl,"/AllergyIntolerance?patient=").concat(e),r=(0,a.ZP)(e?n:null,l.openmrsFetch),i=r.data,s=r.error,c=r.isLoading,A=r.isValidating,_=r.mutate,d=(null==i||null===(t=i.data)||void 0===t?void 0:t.total)>0?null==i?void 0:i.data.entry.map((function(e){var t;return null!==(t=e.resource)&&void 0!==t?t:[]})).map(o).sort((function(e,t){return t.lastUpdated>e.lastUpdated?1:-1})):null;return{allergies:i?d:null,isError:s,isLoading:c,isValidating:A,mutate:_}}function o(e){var t,n,a,l,i,o,s,c,A,_,d,g,m,u,p,f=null==e||null===(n=e.reaction[0])||void 0===n||null===(t=n.manifestation)||void 0===t?void 0:t.map((function(e){var t;return null===(t=e.coding[0])||void 0===t?void 0:t.display}));return{id:null==e?void 0:e.id,clinicalStatus:null==e||null===(l=e.clinicalStatus)||void 0===l||null===(a=l.coding[0])||void 0===a?void 0:a.display,criticality:null==e?void 0:e.criticality,display:null==e||null===(o=e.code)||void 0===o||null===(i=o.coding[0])||void 0===i?void 0:i.display,recordedDate:null==e?void 0:e.recordedDate,recordedBy:null==e||null===(s=e.recorder)||void 0===s?void 0:s.display,recorderType:null==e||null===(c=e.recorder)||void 0===c?void 0:c.type,note:null==e||null===(_=e.note)||void 0===_||null===(A=_[0])||void 0===A?void 0:A.text,reactionToSubstance:null==e||null===(m=e.reaction[0])||void 0===m||null===(g=m.substance)||void 0===g||null===(d=g.coding[1])||void 0===d?void 0:d.display,reactionManifestations:f,reactionSeverity:(0,r.Z)(null==e||null===(u=e.reaction[0])||void 0===u?void 0:u.severity),lastUpdated:null==e||null===(p=e.meta)||void 0===p?void 0:p.lastUpdated}}}}]);