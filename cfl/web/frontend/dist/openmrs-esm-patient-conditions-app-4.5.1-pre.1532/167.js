"use strict";(globalThis.webpackChunk_openmrs_esm_patient_conditions_app=globalThis.webpackChunk_openmrs_esm_patient_conditions_app||[]).push([[167],{3922:(e,t,n)=>{n.d(t,{B6:()=>h,CL:()=>p,l4:()=>s,r4:()=>v,sA:()=>u});var r=n(5047),o=n.n(r),i=n(3255),a=n(906);function c(e,t,n,r,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,l,"next",e)}function l(e){c(i,r,o,a,l,"throw",e)}a(void 0)}))}}function s(e){var t,n,r,o="".concat(a.fhirBaseUrl,"/Condition?patient=").concat(e,"&_count=100"),c=(0,i.ZP)(e?o:null,a.openmrsFetch),l=c.data,s=c.error,u=c.isLoading,p=c.isValidating,f=c.mutate,v=(null==l||null===(t=l.data)||void 0===t?void 0:t.total)>0?null==l||null===(n=l.data)||void 0===n?void 0:n.entry.map((function(e){return null!==(r=e.resource)&&void 0!==r?r:[]})).map(d).sort((function(e,t){return t.onsetDateTime>e.onsetDateTime?1:-1})):null;return{conditions:l?v:null,isError:s,isLoading:u,isValidating:p,mutate:f}}function u(e){var t,n,r=(0,a.useConfig)(),o=null==r?void 0:r.conditionConceptClassUuid,c="/ws/rest/v1/conceptsearch?conceptClasses=".concat(o,"&q=").concat(e),l=(0,i.ZP)(e?c:null,a.openmrsFetch),s=l.data,u=l.error,d=l.isLoading;return{searchResults:null!==(n=null==s||null===(t=s.data)||void 0===t?void 0:t.results)&&void 0!==n?n:[],error:u,isSearching:d}}function d(e){var t,n,r,o,i,a,c=null===(n=null==e||null===(t=e.clinicalStatus)||void 0===t?void 0:t.coding[0])||void 0===n?void 0:n.code;return{clinicalStatus:c?c.charAt(0).toUpperCase()+c.slice(1).toLowerCase():"",conceptId:null===(o=null==e||null===(r=e.code)||void 0===r?void 0:r.coding[0])||void 0===o?void 0:o.code,display:null===(a=null==e||null===(i=e.code)||void 0===i?void 0:i.coding[0])||void 0===a?void 0:a.display,onsetDateTime:null==e?void 0:e.onsetDateTime,recordedDate:null==e?void 0:e.recordedDate,id:null==e?void 0:e.id}}function p(e){return f.apply(this,arguments)}function f(){return(f=l(o().mark((function e(t){var n,r,i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new AbortController,r="".concat(a.fhirBaseUrl,"/Condition"),i={clinicalStatus:{coding:[{system:"http://terminology.hl7.org/CodeSystem/condition-clinical",code:t.clinicalStatus}]},code:{coding:[{code:t.conceptId,display:t.display}]},endDate:t.endDate,onsetDateTime:t.onsetDateTime,recorder:{reference:"Practitioner/".concat(t.userId)},recordedDate:(new Date).toISOString(),resourceType:"Condition",subject:{reference:"Patient/".concat(t.patientId)}},e.next=5,(0,a.openmrsFetch)(r,{headers:{"Content-Type":"application/json"},method:"POST",body:i,signal:n.signal});case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t){return m.apply(this,arguments)}function m(){return(m=l(o().mark((function e(t,n){var r,i,c,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new AbortController,i="".concat(a.fhirBaseUrl,"/Condition/").concat(t),c={clinicalStatus:{coding:[{system:"http://terminology.hl7.org/CodeSystem/condition-clinical",code:n.clinicalStatus}]},code:{coding:[{code:n.conceptId,display:n.display}]},endDate:n.endDate,id:t,onsetDateTime:n.onsetDateTime,recorder:{reference:"Practitioner/".concat(n.userId)},recordedDate:(new Date).toISOString(),resourceType:"Condition",subject:{reference:"Patient/".concat(n.patientId)}},e.next=5,(0,a.openmrsFetch)(i,{headers:{"Content-Type":"application/json"},method:"PUT",body:c,signal:r.signal});case 5:return l=e.sent,e.abrupt("return",l);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return y.apply(this,arguments)}function y(){return(y=l(o().mark((function e(t){var n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new AbortController,r="".concat(a.fhirBaseUrl,"/Condition/").concat(t),e.next=4,(0,a.openmrsFetch)(r,{method:"DELETE",signal:n.signal});case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},6167:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var r=n(5047),o=n.n(r),i=n(268),a=n.n(i),c=n(4924),l=n(4179),s=n(906),u=n(3922);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t,n,r,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}const f=function(e){var t,n,r,f=e.closeDeleteModal,v=e.conditionId,m=e.patientUuid,h=(0,c.useTranslation)().t,y=(0,u.l4)(m).mutate,g=(n=(0,i.useState)(!1),r=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),C=g[0],w=g[1],D=(0,i.useCallback)((t=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(!0),e.prev=1,e.next=4,(0,u.B6)(v);case 4:200===e.sent.status&&(y(),f(),(0,s.showToast)({critical:!0,kind:"success",description:h("conditionDeletedSuccessfully","Condition deleted successfully"),title:h("conditionDeleted","Condition Deleted")})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("Error deleting condition: ",e.t0),(0,s.showNotification)({title:h("errorDeletingCondition","Error deleting condition"),kind:"error",critical:!0,description:null===e.t0||void 0===e.t0?void 0:e.t0.message});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){p(i,r,o,a,c,"next",e)}function c(e){p(i,r,o,a,c,"throw",e)}a(void 0)}))}),[f,v,y,h]);return a().createElement("div",null,a().createElement(l.xBx,{closeModal:f,title:h("deleteCondition","Delete condition")}),a().createElement(l.fef,null,a().createElement("p",null,h("deleteModalConfirmationText","Are you sure you want to delete this condition?"))),a().createElement(l.mzw,null,a().createElement(l.zxk,{kind:"secondary",onClick:f},h("cancel","Cancel")),a().createElement(l.zxk,{kind:"danger",onClick:D,disabled:C},C?a().createElement(l.lSo,{description:h("deleting","Deleting")+"..."}):a().createElement("span",null,h("delete","Delete")))))}}}]);