"use strict";(globalThis.webpackChunk_openmrs_esm_appointments_app=globalThis.webpackChunk_openmrs_esm_appointments_app||[]).push([[80],{7889:(t,e,n)=>{n.d(e,{Z:()=>u});var r=n(272),o=n.n(r),i=n(2609),a=n.n(i)()(o());a.push([t.id,".-esm-appointments__check-in-modal__checkInTime___fyJ3a{display:flex;align-items:center}.-esm-appointments__check-in-modal__checkInLabel___xWceD{margin-right:.5rem;font-weight:bold}","",{version:3,sources:["webpack://./src/home-appointments/check-in-modal/check-in-modal.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss"],names:[],mappings:"AAGA,wDACE,YAAA,CACA,kBAAA,CAGF,yDACE,kBCYW,CDXX,gBAAA",sourceRoot:""}]),a.locals={checkInTime:"-esm-appointments__check-in-modal__checkInTime___fyJ3a",checkInLabel:"-esm-appointments__check-in-modal__checkInLabel___xWceD"};const u=a},5326:(t,e,n)=>{n.d(e,{Ey:()=>d,Gd:()=>b,IF:()=>v,Nz:()=>y,aN:()=>f,bf:()=>u,c1:()=>h,df:()=>p,g9:()=>l,vN:()=>c,xj:()=>m});var r=n(2870),o=n(8879),i=n.n(o);function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var u=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=null==e?void 0:e.map((function(t){var e=t.countMap;return{serviceName:t.serviceName,count:e.reduce((function(t,e){return t+e.allAppointmentsCount}),0)}}));return n.find((function(e){return e.count===(t=Math).max.apply(t,function(t){if(Array.isArray(t))return a(t)}(r=n.map((function(t){return t.count})))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var r}))},l=function(t){return t.flatMap((function(t){return{serviceName:t.appointmentService.name,countMap:Object.entries(t.appointmentCountMap).flatMap((function(t){return t[1]}))}}))},c=function(t,e){return t.map((function(t){return Object.entries(t.appointmentCountMap).flatMap((function(t){return t[1][e]}))})).flat(1).reduce((function(t,e){return t+e}),0)};function s(){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)-(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0);return Math.floor(t/6e4)+"min"}var p=function(t,e){var n,o,i,a,u,l,c,p,d,m,f,v,h,b,y,g,w;return{id:null==t?void 0:t.uuid,name:null===(n=t.patient)||void 0===n?void 0:n.name,age:null===(o=t.patient)||void 0===o?void 0:o.birthDate,gender:null===(i=t.patient)||void 0===i?void 0:i.gender,phoneNumber:null===(a=t.patient)||void 0===a?void 0:a.phoneNumber,dob:(0,r.formatDate)((0,r.parseDate)(null===(u=t.patient)||void 0===u?void 0:u.birthDate),{mode:"wide"}),patientUuid:null===(l=t.patient)||void 0===l?void 0:l.uuid,dateTime:(b=(0,r.parseDate)(t.startDateTime),y=b.getHours(),g=b.getMinutes(),w=y>=12?"PM":"AM",(y=(y%=12)||12)+":"+(g=g<10?"0"+g:g)+" "+w),serviceType:t.service?t.service.name:"--",serviceColor:(null===(c=t.service)||void 0===c?void 0:c.color)?t.service.color:"__",serviceUuid:t.service?t.service.uuid:null,appointmentKind:t.appointmentKind?t.appointmentKind:"--",status:t.status,provider:t.provider?null===(p=t.provider.person)||void 0===p?void 0:p.display:"--",location:t.location?t.location.name:"--",comments:t.comments?t.comments:"--",appointmentNumber:t.appointmentNumber,color:null!==(h=null==t||null===(d=t.service)||void 0===d?void 0:d.color)&&void 0!==h?h:"",identifier:null===(m=t.patient)||void 0===m?void 0:m.identifier,duration:(null===(f=t.service)||void 0===f?void 0:f.durationMins)?(null==t||null===(v=t.service)||void 0===v?void 0:v.durationMins)+e("minutes","min"):s(t.startDateTime,t.endDateTime),recurring:t.recurring}},d=function(t){var e,n,o,i,a,u,l,c;return{id:t.uuid,name:null===(e=t.patient)||void 0===e?void 0:e.name,age:null===(n=t.patient)||void 0===n?void 0:n.birthDate,gender:null===(o=t.patient)||void 0===o?void 0:o.gender,phoneNumber:null===(i=t.patient)||void 0===i?void 0:i.phoneNumber,dob:(0,r.formatDate)((0,r.parseDate)(null===(a=t.patient)||void 0===a?void 0:a.birthDate),{mode:"wide"}),patientUuid:null===(u=t.patient)||void 0===u?void 0:u.uuid,dateTime:t.startDateTime,serviceType:t.service?t.service.name:"--",serviceUuid:t.service?t.service.uuid:null,appointmentKind:t.appointmentKind?t.appointmentKind:"--",status:t.status,provider:t.providers?null===(l=null==t?void 0:t.providers[0])||void 0===l?void 0:l.name:"--",location:t.location?null===(c=t.location)||void 0===c?void 0:c.name:"--",comments:t.comments?t.comments:"--",appointmentNumber:t.appointmentNumber,providers:t.providers,identifier:t.patient.identifier}},m=function(t,e){return t.isSame(e,"month")},f=function(t){for(var e=i()(t).startOf("month"),n=i()(t).endOf("month"),r=i()(t).daysInMonth(),o=i()(t).subtract(1,"month"),a=i()(t).add(1,"month"),u=[],l=o.daysInMonth()-e.day();l<o.daysInMonth();l++)u.push(t.date(l).month(o.month()));for(var c=1;c<=r;c++)u.push(t.date(c));for(var s=u.length>30?7:14,p=1;p<s-n.day();p++)u.push(t.date(p).month(a.month()));return u},v=function(t,e){switch(t){case"M":return e("male","Male");case"F":return e("female","Female");case"O":return e("other","Other");case"U":return e("unknown","Unknown");default:return t}},h=function(t){for(var e=[],n=0;n<1;n++)for(var r=0;r<8;r++)e.push(i()(t).day(0===r?0:r-1).hour(n));return e},b=function(t){for(var e=[],n=0;n<24;n++)for(var r=0;r<8;r++)e.push(i()(t).day(0===r?0:r-1).hour(n));return e},y=function(t){for(var e=[],n=0;n<24;n++)e.push(i()(t).hour(n));return e}},1027:(t,e,n)=>{n.d(e,{es:()=>f,A8:()=>p,Nz:()=>r.Nz,g9:()=>r.g9,Ey:()=>r.Ey,IF:()=>r.IF,bf:()=>r.bf,vN:()=>r.vN,xj:()=>r.xj,df:()=>r.df,zF:()=>v,Gd:()=>r.Gd,c1:()=>r.c1});var r=n(5326),o=n(2870),i=n(8879),a=n.n(i),u=n(268),l=n(8179);function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var p=function(t,e){var n=s(null==t?void 0:t.split(":"),2),r=n[0],o=n[1];return"12"===r&&"AM"===e&&(r="00"),"PM"===e&&(r="12"===r?r:parseInt(r,10)+12),[r,o]},d={appointmentDate:a()((new Date).setHours(0,0,0,0)).format(l.J$)};function m(){return(0,o.getGlobalStore)("appointmentStartDate",d)}function f(t){m().setState({appointmentDate:a()(new Date(t).setHours(0,0,0,0)).format(l.J$)})}var v=function(){var t=s((0,u.useState)(d.appointmentDate),2),e=t[0],n=t[1];return(0,u.useEffect)((function(){m().subscribe((function(t){var e=t.appointmentDate;return n(e.toString())}))}),[]),{currentAppointmentDate:e,setCurrentAppointmentDate:n}}},4690:(t,e,n)=>{n.d(e,{E0:()=>b,LW:()=>h,WN:()=>f});var r=n(268),o=n(3255),i=n(8879),a=n.n(i),u=n(4924),l=n(2870),c=n(1027),s=n(8179);function p(t,e,n,r,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void n(t)}u.done?e(l):Promise.resolve(l).then(r,o)}function d(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){p(i,r,o,a,u,"next",t)}function u(t){p(i,r,o,a,u,"throw",t)}a(void 0)}))}}var m=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};function f(){var t=(0,u.useTranslation)().t,e=(0,c.zF)().currentAppointmentDate,n="/ws/rest/v1/appointment/all?forDate=".concat(e),i=(0,o.ZP)(e?n:null,l.openmrsFetch),a=i.data,s=i.error,p=i.isLoading,d=i.isValidating,m=i.mutate,f=(0,r.useMemo)((function(){var e,n;return{appointments:null!==(n=null==a||null===(e=a.data)||void 0===e?void 0:e.map((function(e){return(0,c.df)(e,t)})))&&void 0!==n?n:[],isLoading:p,isError:s,isValidating:d,mutate:m}}),[null==a?void 0:a.data,s,p,d,m,t]);return f}var v,h=(v=d((function(t,e){var n,r,o,i;return m(this,(function(u){switch(u.label){case 0:return n=new AbortController,r=Intl.DateTimeFormat().resolvedOptions().timeZone,o=a()(new Date).format(s.J$),i="/ws/rest/v1/appointments/".concat(e,"/status-change"),[4,(0,l.openmrsFetch)(i,{body:{toStatus:t,onDate:o,timeZone:r},method:"POST",headers:{"Content-Type":"application/json"},signal:n.signal})];case 1:return[2,u.sent()]}}))})),function(t,e){return v.apply(this,arguments)}),b=function(){var t=d((function(t){var e,n;return m(this,(function(r){switch(r.label){case 0:return e=new AbortController,n="/ws/rest/v1/appointment/undoStatusChange/".concat(t),[4,(0,l.openmrsFetch)(n,{method:"POST",headers:{"Content-Type":"application/json"},signal:e.signal})];case 1:return[2,r.sent()]}}))}));return function(e){return t.apply(this,arguments)}}()},3080:(t,e,n)=>{n.r(e),n.d(e,{default:()=>T});var r=n(268),o=n.n(r),i=n(8879),a=n.n(i),u=n(3504),l=n(3255),c=n(4924),s=n(2870),p=n(4690),d=n(2649),m=n(1354),f=n.n(m),v=n(1583),h=n.n(v),b=n(7378),y=n.n(b),g=n(5993),w=n.n(g),k=n(4154),A=n.n(k),C=n(8141),_=n.n(C),I=n(7889),S={};S.styleTagTransform=_(),S.setAttributes=w(),S.insert=y().bind(null,"head"),S.domAPI=h(),S.insertStyleElement=A(),f()(I.Z,S);const D=I.Z&&I.Z.locals?I.Z.locals:void 0;function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function M(t,e,n,r,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void n(t)}u.done?e(l):Promise.resolve(l).then(r,o)}function N(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return E(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const T=function(t){var e,n,i=t.closeCheckInModal,m=t.appointmentUuid,f=(0,c.useTranslation)().t,v=(0,l.kY)().mutate,h=N((0,r.useState)(a()(new Date).format("hh:mm")),2),b=h[0],y=h[1],g=N((0,r.useState)(!1),2),w=g[0],k=g[1],A=(e=function(){return function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}(this,(function(t){switch(t.label){case 0:return k(!0),[4,(0,p.LW)("CheckedIn",m)];case 1:return 200===t.sent().status?(i(),(0,s.showActionableNotification)({critical:!0,kind:"success",actionButtonLabel:f("undo","Undo"),progressActionLabel:f("revertingAppointmentStatus","Reverting appointment status"),onActionButtonClick:function(){return(0,d.NL)(m,v)},subtitle:f("appointmentSuccessfullyCheckedIn","It has been checked-in successfully"),title:f("appointmentCheckedIn","Appointment Checked-in")}),v("/ws/rest/v1/appointment/appointment/all")):((0,s.showNotification)({title:f("appointmentCheckInError","Error checking in appointment"),kind:"error",critical:!0,description:f("errorMessage","Error checking in the appointment")}),k(!1)),[2]}}))},n=function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(t){M(i,r,o,a,u,"next",t)}function u(t){M(i,r,o,a,u,"throw",t)}a(void 0)}))},function(){return n.apply(this,arguments)});return o().createElement("div",null,o().createElement(u.xBx,{closeModal:i,title:f("checkInAppointment","Are you sure you want to mark appointment as Checked-in?")}),o().createElement(u.fef,null,o().createElement("div",{className:D.checkInTime},o().createElement("span",{className:D.checkInLabel},f("checkinTime","Check-in time"),":"),o().createElement(u.mh4,null,o().createElement(u.jII,{required:!0,className:D.timePickerInput,pattern:"([\\d]+:[\\d]{2})",onChange:function(t){return y(t.target.value)},value:b,id:"end-time-picker"})))),o().createElement(u.mzw,null,o().createElement(u.zxk,{kind:"secondary",onClick:i},f("no","No")),o().createElement(u.zxk,{onClick:A,disabled:w},f("yes","Yes"))))}},2649:(t,e,n)=>{n.d(e,{NL:()=>s,O4:()=>c,bO:()=>d,tf:()=>p});var r=n(2870),o=n(4690);function i(t,e,n,r,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void n(t)}u.done?e(l):Promise.resolve(l).then(r,o)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function u(t){i(a,r,o,u,l,"next",t)}function l(t){i(a,r,o,u,l,"throw",t)}u(void 0)}))}}var u,l=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},c=function(t){var e=(0,r.showModal)("check-in-appointment-modal",{closeCheckInModal:function(){return e()},appointmentUuid:t})},s=(u=a((function(t,e){return l(this,(function(n){switch(n.label){case 0:return new AbortController,[4,(0,o.E0)(t)];case 1:return 200===n.sent().status?e("/ws/rest/v1/appointment/appointment/all"):(0,r.showNotification)({title:"Error Undoing",kind:"error",critical:!0,description:"Error reverting status"}),[2]}}))})),function(t,e){return u.apply(this,arguments)}),p=function(){var t=a((function(t,e,n,i,a,u,c,p){return l(this,(function(l){switch(l.label){case 0:return new AbortController,[4,(0,o.LW)(t,e)];case 1:return 200===l.sent().status?((0,r.showActionableNotification)({critical:!0,kind:"success",subtitle:n,title:a,actionButtonLabel:p("undo","Undo"),progressActionLabel:p("revertingAppointmentStatus","Reverting appointment status"),onActionButtonClick:function(){return s(e,c)}}),c("/ws/rest/v1/appointment/appointment/all")):(0,r.showNotification)({title:u,kind:"error",critical:!0,description:i}),[2]}}))}));return function(e,n,r,o,i,a,u,l){return t.apply(this,arguments)}}(),d=function(t,e,n){var r=n("appointmentMarkedAsCompleted","It has been successfully marked as Completed"),o=n("appointmentCompleted","Appointment Completed"),i=n("appointmentCompleted","Appointment Completed"),a=n("appointmentCompletedError","Error marking appointment as Completed");return p("Completed",t,r,i,o,a,e,n)}}}]);